<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE LambdaCase #-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">TM2SM</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-4"></span><span>
</span><span id="line-5"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="SMType.html"><span class="hs-identifier">SMType</span></a></span><span>
</span><span id="line-6"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-7"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="TMType.html"><span class="hs-identifier">TMType</span></a></span><span>
</span><span id="line-8"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="TM2SMHelpers.html"><span class="hs-identifier">TM2SMHelpers</span></a></span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">transpose</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">groupBy</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">sortBy</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">length</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">zip4</span></span><span class="hs-special">)</span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fromJust</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">mapMaybe</span></span><span class="hs-special">)</span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Helpers.html"><span class="hs-identifier">Helpers</span></a></span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Arrow</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(***)</span></span><span class="hs-special">)</span><span>
</span><span id="line-13"></span><span>
</span><span id="line-14"></span><span class="annot"><a href="TM2SM.html#splitPosNegCmds"><span class="hs-identifier hs-type">splitPosNegCmds</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="TMType.html#TapeCommand"><span class="hs-identifier hs-type">TMType.TapeCommand</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="TMType.html#TapeCommand"><span class="hs-identifier hs-type">TMType.TapeCommand</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="TMType.html#TapeCommand"><span class="hs-identifier hs-type">TMType.TapeCommand</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="TMType.html#TapeCommand"><span class="hs-identifier hs-type">TMType.TapeCommand</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="TMType.html#TapeCommand"><span class="hs-identifier hs-type">TMType.TapeCommand</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-15"></span><span id="splitPosNegCmds"><span class="annot"><span class="annottext">splitPosNegCmds :: [[TapeCommand]]
-&gt; ([[TapeCommand]], [[TapeCommand]], [[TapeCommand]],
    [[TapeCommand]])
</span><a href="TM2SM.html#splitPosNegCmds"><span class="hs-identifier hs-var hs-var">splitPosNegCmds</span></a></span></span><span> </span><span id="local-6989586621679335472"><span class="annot"><span class="annottext">[[TapeCommand]]
</span><a href="#local-6989586621679335472"><span class="hs-identifier hs-var">commands</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-16"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679335471"><span class="annot"><span class="annottext">check21 :: [TapeCommand] -&gt; Bool
</span><a href="#local-6989586621679335471"><span class="hs-identifier hs-var hs-var">check21</span></a></span></span><span> </span><span id="local-6989586621679335470"><span class="annot"><span class="annottext">[TapeCommand]
</span><a href="#local-6989586621679335470"><span class="hs-identifier hs-var">command</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-17"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[TapeCommand]
</span><a href="#local-6989586621679335470"><span class="hs-identifier hs-var">command</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-18"></span><span>                </span><span class="annot"><a href="TMType.html#PreSMCommand"><span class="hs-identifier hs-type">TMType.PreSMCommand</span></a></span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="TMType.html#Value"><span class="hs-identifier hs-type">TMType.Value</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">StateOmega
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="annottext">(Square, StateOmega)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">[TapeCommand]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-19"></span><span>                </span><span class="annot"><a href="TMType.html#PreSMCommand"><span class="hs-identifier hs-type">TMType.PreSMCommand</span></a></span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Square
</span><a href="TMType.html#ES"><span class="hs-identifier hs-var">TMType.ES</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">StateOmega
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="annottext">(Square, StateOmega)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679335466"><span class="annot"><span class="annottext">[TapeCommand]
</span><a href="#local-6989586621679335466"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[TapeCommand] -&gt; Bool
</span><a href="#local-6989586621679335471"><span class="hs-identifier hs-var">check21</span></a></span><span> </span><span class="annot"><span class="annottext">[TapeCommand]
</span><a href="#local-6989586621679335466"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-20"></span><span>                </span><span class="annot"><a href="TMType.html#PreSMCommand"><span class="hs-identifier hs-type">TMType.PreSMCommand</span></a></span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="TMType.html#E"><span class="hs-identifier hs-type">TMType.E</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">StateOmega
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="annottext">(Square, StateOmega)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">[TapeCommand]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-21"></span><span>                </span><span class="annot"><a href="TMType.html#PreSMCommand"><span class="hs-identifier hs-type">TMType.PreSMCommand</span></a></span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="TMType.html#BCommand"><span class="hs-identifier hs-type">TMType.BCommand</span></a></span><span> </span><span class="annot"><span class="annottext">[TapeCommand]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">StateOmega
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Square
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">StateOmega
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">[TapeCommand]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-22"></span><span>                </span><span class="annot"><a href="TMType.html#PreSMCommand"><span class="hs-identifier hs-type">TMType.PreSMCommand</span></a></span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="TMType.html#PCommand"><span class="hs-identifier hs-type">TMType.PCommand</span></a></span><span> </span><span class="annot"><span class="annottext">[TapeCommand]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">StateOmega
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Square
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">StateOmega
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">[TapeCommand]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-23"></span><span>                </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-24"></span><span>                </span><span id="local-6989586621679335462"><span class="annot"><span class="annottext">[TapeCommand]
</span><a href="#local-6989586621679335462"><span class="hs-identifier hs-var">cmd</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Bool
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Bool) -&gt; String -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Must be PreSMCommand: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[TapeCommand] -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">[TapeCommand]
</span><a href="#local-6989586621679335462"><span class="hs-identifier hs-var">cmd</span></a></span><span>
</span><span id="line-25"></span><span>
</span><span id="line-26"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679335459"><span class="annot"><span class="annottext">reverseCommand :: TapeCommand -&gt; TapeCommand
</span><a href="#local-6989586621679335459"><span class="hs-identifier hs-var hs-var">reverseCommand</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="TMType.html#PreSMCommand"><span class="hs-identifier hs-type">TMType.PreSMCommand</span></a></span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679335458"><span class="annot"><span class="annottext">Square
</span><a href="#local-6989586621679335458"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679335457"><span class="annot"><span class="annottext">StateOmega
</span><a href="#local-6989586621679335457"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span id="local-6989586621679335456"><span class="annot"><span class="annottext">Square
</span><a href="#local-6989586621679335456"><span class="hs-identifier hs-var">a1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679335455"><span class="annot"><span class="annottext">StateOmega
</span><a href="#local-6989586621679335455"><span class="hs-identifier hs-var">b1</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">((Square, StateOmega), (Square, StateOmega)) -&gt; TapeCommand
</span><a href="TMType.html#PreSMCommand"><span class="hs-identifier hs-var">TMType.PreSMCommand</span></a></span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Square
</span><a href="#local-6989586621679335456"><span class="hs-identifier hs-var">a1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">StateOmega
</span><a href="#local-6989586621679335455"><span class="hs-identifier hs-var">b1</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Square
</span><a href="#local-6989586621679335458"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">StateOmega
</span><a href="#local-6989586621679335457"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span>        </span><span class="annot"><a href="#local-6989586621679335459"><span class="hs-identifier hs-var">reverseCommand</span></a></span><span> </span><span class="annot"><span class="annottext">TapeCommand
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; TapeCommand
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Must be PreSMCommand&quot;</span></span><span>
</span><span id="line-28"></span><span>
</span><span id="line-29"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679335454"><span class="annot"><span class="annottext">splitPosNegCmdsInternal :: [[TapeCommand]]
-&gt; ([[TapeCommand]], [[TapeCommand]], [[TapeCommand]],
    [[TapeCommand]])
-&gt; ([[TapeCommand]], [[TapeCommand]], [[TapeCommand]],
    [[TapeCommand]])
</span><a href="#local-6989586621679335454"><span class="hs-identifier hs-var hs-var">splitPosNegCmdsInternal</span></a></span></span><span> </span><span id="local-6989586621679335453"><span class="annot"><span class="annottext">[[TapeCommand]]
</span><a href="#local-6989586621679335453"><span class="hs-identifier hs-var">cmds</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679335452"><span class="annot"><span class="annottext">[[TapeCommand]]
</span><a href="#local-6989586621679335452"><span class="hs-identifier hs-var">accP21</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679335451"><span class="annot"><span class="annottext">[[TapeCommand]]
</span><a href="#local-6989586621679335451"><span class="hs-identifier hs-var">accP22</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679335450"><span class="annot"><span class="annottext">[[TapeCommand]]
</span><a href="#local-6989586621679335450"><span class="hs-identifier hs-var">accN21</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679335449"><span class="annot"><span class="annottext">[[TapeCommand]]
</span><a href="#local-6989586621679335449"><span class="hs-identifier hs-var">accN22</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-30"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[[TapeCommand]]
</span><a href="#local-6989586621679335453"><span class="hs-identifier hs-var">cmds</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-31"></span><span>                </span><span id="local-6989586621679335448"><span class="annot"><span class="annottext">[TapeCommand]
</span><a href="#local-6989586621679335448"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679335447"><span class="annot"><span class="annottext">[[TapeCommand]]
</span><a href="#local-6989586621679335447"><span class="hs-identifier hs-var">t</span></a></span></span><span>
</span><span id="line-32"></span><span>                    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[TapeCommand] -&gt; Bool
</span><a href="#local-6989586621679335471"><span class="hs-identifier hs-var">check21</span></a></span><span> </span><span class="annot"><span class="annottext">[TapeCommand]
</span><a href="#local-6989586621679335448"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[[TapeCommand]]
-&gt; ([[TapeCommand]], [[TapeCommand]], [[TapeCommand]],
    [[TapeCommand]])
-&gt; ([[TapeCommand]], [[TapeCommand]], [[TapeCommand]],
    [[TapeCommand]])
</span><a href="#local-6989586621679335454"><span class="hs-identifier hs-var">splitPosNegCmdsInternal</span></a></span><span> </span><span class="annot"><span class="annottext">[[TapeCommand]]
</span><a href="#local-6989586621679335447"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TapeCommand]
</span><a href="#local-6989586621679335448"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">[TapeCommand] -&gt; [[TapeCommand]] -&gt; [[TapeCommand]]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[[TapeCommand]]
</span><a href="#local-6989586621679335452"><span class="hs-identifier hs-var">accP21</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[[TapeCommand]]
</span><a href="#local-6989586621679335451"><span class="hs-identifier hs-var">accP22</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[[TapeCommand]]
</span><a href="#local-6989586621679335450"><span class="hs-identifier hs-var">accN21</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[[TapeCommand]]
</span><a href="#local-6989586621679335449"><span class="hs-identifier hs-var">accN22</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span>                    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[TapeCommand] -&gt; Bool
</span><a href="#local-6989586621679335471"><span class="hs-identifier hs-var">check21</span></a></span><span> </span><span class="annot"><span class="annottext">[TapeCommand]
</span><a href="#local-6989586621679335446"><span class="hs-identifier hs-var">reversedH</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[[TapeCommand]]
-&gt; ([[TapeCommand]], [[TapeCommand]], [[TapeCommand]],
    [[TapeCommand]])
-&gt; ([[TapeCommand]], [[TapeCommand]], [[TapeCommand]],
    [[TapeCommand]])
</span><a href="#local-6989586621679335454"><span class="hs-identifier hs-var">splitPosNegCmdsInternal</span></a></span><span> </span><span class="annot"><span class="annottext">[[TapeCommand]]
</span><a href="#local-6989586621679335447"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[[TapeCommand]]
</span><a href="#local-6989586621679335452"><span class="hs-identifier hs-var">accP21</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[[TapeCommand]]
</span><a href="#local-6989586621679335451"><span class="hs-identifier hs-var">accP22</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[TapeCommand]
</span><a href="#local-6989586621679335448"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">[TapeCommand] -&gt; [[TapeCommand]] -&gt; [[TapeCommand]]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[[TapeCommand]]
</span><a href="#local-6989586621679335450"><span class="hs-identifier hs-var">accN21</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[[TapeCommand]]
</span><a href="#local-6989586621679335449"><span class="hs-identifier hs-var">accN22</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span>                    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[TapeCommand]
</span><a href="#local-6989586621679335446"><span class="hs-identifier hs-var">reversedH</span></a></span><span> </span><span class="annot"><span class="annottext">[TapeCommand] -&gt; [[TapeCommand]] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`notElem`</span></span><span> </span><span class="annot"><span class="annottext">[[TapeCommand]]
</span><a href="#local-6989586621679335451"><span class="hs-identifier hs-var">accP22</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[[TapeCommand]]
-&gt; ([[TapeCommand]], [[TapeCommand]], [[TapeCommand]],
    [[TapeCommand]])
-&gt; ([[TapeCommand]], [[TapeCommand]], [[TapeCommand]],
    [[TapeCommand]])
</span><a href="#local-6989586621679335454"><span class="hs-identifier hs-var">splitPosNegCmdsInternal</span></a></span><span> </span><span class="annot"><span class="annottext">[[TapeCommand]]
</span><a href="#local-6989586621679335447"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[[TapeCommand]]
</span><a href="#local-6989586621679335452"><span class="hs-identifier hs-var">accP21</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[TapeCommand]
</span><a href="#local-6989586621679335448"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">[TapeCommand] -&gt; [[TapeCommand]] -&gt; [[TapeCommand]]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[[TapeCommand]]
</span><a href="#local-6989586621679335451"><span class="hs-identifier hs-var">accP22</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[[TapeCommand]]
</span><a href="#local-6989586621679335450"><span class="hs-identifier hs-var">accN21</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[[TapeCommand]]
</span><a href="#local-6989586621679335449"><span class="hs-identifier hs-var">accN22</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span>                    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[[TapeCommand]]
-&gt; ([[TapeCommand]], [[TapeCommand]], [[TapeCommand]],
    [[TapeCommand]])
-&gt; ([[TapeCommand]], [[TapeCommand]], [[TapeCommand]],
    [[TapeCommand]])
</span><a href="#local-6989586621679335454"><span class="hs-identifier hs-var">splitPosNegCmdsInternal</span></a></span><span> </span><span class="annot"><span class="annottext">[[TapeCommand]]
</span><a href="#local-6989586621679335447"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[[TapeCommand]]
</span><a href="#local-6989586621679335452"><span class="hs-identifier hs-var">accP21</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[[TapeCommand]]
</span><a href="#local-6989586621679335451"><span class="hs-identifier hs-var">accP22</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[[TapeCommand]]
</span><a href="#local-6989586621679335450"><span class="hs-identifier hs-var">accN21</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[TapeCommand]
</span><a href="#local-6989586621679335448"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">[TapeCommand] -&gt; [[TapeCommand]] -&gt; [[TapeCommand]]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[[TapeCommand]]
</span><a href="#local-6989586621679335449"><span class="hs-identifier hs-var">accN22</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span>                    </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679335446"><span class="annot"><span class="annottext">reversedH :: [TapeCommand]
</span><a href="#local-6989586621679335446"><span class="hs-identifier hs-var hs-var">reversedH</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TapeCommand -&gt; TapeCommand) -&gt; [TapeCommand] -&gt; [TapeCommand]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">TapeCommand -&gt; TapeCommand
</span><a href="#local-6989586621679335459"><span class="hs-identifier hs-var">reverseCommand</span></a></span><span> </span><span class="annot"><span class="annottext">[TapeCommand]
</span><a href="#local-6989586621679335448"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-37"></span><span>                </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[[TapeCommand]]
</span><a href="#local-6989586621679335452"><span class="hs-identifier hs-var">accP21</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[[TapeCommand]]
</span><a href="#local-6989586621679335451"><span class="hs-identifier hs-var">accP22</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[[TapeCommand]]
</span><a href="#local-6989586621679335450"><span class="hs-identifier hs-var">accN21</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[[TapeCommand]]
</span><a href="#local-6989586621679335449"><span class="hs-identifier hs-var">accN22</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span>    </span><span class="annot"><span class="annottext">[[TapeCommand]]
-&gt; ([[TapeCommand]], [[TapeCommand]], [[TapeCommand]],
    [[TapeCommand]])
-&gt; ([[TapeCommand]], [[TapeCommand]], [[TapeCommand]],
    [[TapeCommand]])
</span><a href="#local-6989586621679335454"><span class="hs-identifier hs-var">splitPosNegCmdsInternal</span></a></span><span> </span><span class="annot"><span class="annottext">[[TapeCommand]]
</span><a href="#local-6989586621679335472"><span class="hs-identifier hs-var">commands</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span class="annot"><a href="TM2SM.html#copySMForCommand"><span class="hs-identifier hs-type">copySMForCommand</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="SMType.html#SM"><span class="hs-identifier hs-type">SM</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="SMType.html#SMTag"><span class="hs-identifier hs-type">SMTag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="SMType.html#TMCMD"><span class="hs-identifier hs-type">TMCMD</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="SMType.html#SM"><span class="hs-identifier hs-type">SM</span></a></span><span>
</span><span id="line-42"></span><span id="copySMForCommand"><span class="annot"><span class="annottext">copySMForCommand :: SM -&gt; SMTag -&gt; TMCMD -&gt; SM
</span><a href="TM2SM.html#copySMForCommand"><span class="hs-identifier hs-var hs-var">copySMForCommand</span></a></span></span><span> </span><span id="local-6989586621679335443"><span class="annot"><span class="annottext">SM
</span><a href="#local-6989586621679335443"><span class="hs-identifier hs-var">sm</span></a></span></span><span> </span><span id="local-6989586621679335442"><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335442"><span class="hs-identifier hs-var">tag</span></a></span></span><span> </span><span id="local-6989586621679335441"><span class="annot"><span class="annottext">TMCMD
</span><a href="#local-6989586621679335441"><span class="hs-identifier hs-var">cmd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-43"></span><span>   </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679335440"><span class="annot"><span class="annottext">q :: [Set State]
</span><a href="#local-6989586621679335440"><span class="hs-identifier hs-var hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Set State -&gt; Set State) -&gt; [Set State] -&gt; [Set State]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(State -&gt; State) -&gt; Set State -&gt; Set State
forall b a. Ord b =&gt; (a -&gt; b) -&gt; Set a -&gt; Set b
</span><span class="hs-identifier hs-var">Set.map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TMCMD -&gt; SMTag -&gt; State -&gt; State
</span><a href="TM2SMHelpers.html#addICmdSmTag"><span class="hs-identifier hs-var">addICmdSmTag</span></a></span><span> </span><span class="annot"><span class="annottext">TMCMD
</span><a href="#local-6989586621679335441"><span class="hs-identifier hs-var">cmd</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335442"><span class="hs-identifier hs-var">tag</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SM -&gt; [Set State]
</span><a href="SMType.html#qn"><span class="hs-identifier hs-var hs-var">qn</span></a></span><span> </span><span class="annot"><span class="annottext">SM
</span><a href="#local-6989586621679335443"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span>       </span><span id="local-6989586621679335436"><span class="annot"><span class="annottext">filterWord :: Word -&gt; Word
</span><a href="#local-6989586621679335436"><span class="hs-identifier hs-var hs-var">filterWord</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="SMType.html#Word"><span class="hs-identifier hs-type">Word</span></a></span><span> </span><span id="local-6989586621679335434"><span class="annot"><span class="annottext">[Smb]
</span><a href="#local-6989586621679335434"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Smb -&gt; Smb) -&gt; [Smb] -&gt; [Smb]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span> </span><span class="annot"><a href="SMType.html#SmbQ"><span class="hs-identifier hs-type">SmbQ</span></a></span><span> </span><span id="local-6989586621679335432"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335432"><span class="hs-identifier hs-var">smb</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TMCMD -&gt; SMTag -&gt; State -&gt; State
</span><a href="TM2SMHelpers.html#addICmdSmTag"><span class="hs-identifier hs-var">addICmdSmTag</span></a></span><span> </span><span class="annot"><span class="annottext">TMCMD
</span><a href="#local-6989586621679335441"><span class="hs-identifier hs-var">cmd</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335442"><span class="hs-identifier hs-var">tag</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335432"><span class="hs-identifier hs-var">smb</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">;</span><span> </span><span id="local-6989586621679335431"><span class="annot"><span class="annottext">Smb
</span><a href="#local-6989586621679335431"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Smb
</span><a href="#local-6989586621679335431"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Smb]
</span><a href="#local-6989586621679335434"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span>       </span><span id="local-6989586621679335430"><span class="annot"><span class="annottext">prog :: [SRule]
</span><a href="#local-6989586621679335430"><span class="hs-identifier hs-var hs-var">prog</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SRule -&gt; SRule) -&gt; [SRule] -&gt; [SRule]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="SMType.html#SRule"><span class="hs-identifier hs-type">SRule</span></a></span><span> </span><span id="local-6989586621679335428"><span class="annot"><span class="annottext">[(Word, Word)]
</span><a href="#local-6989586621679335428"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[(Word, Word)] -&gt; SRule
</span><a href="SMType.html#SRule"><span class="hs-identifier hs-var">SRule</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Word, Word) -&gt; (Word, Word)) -&gt; [(Word, Word)] -&gt; [(Word, Word)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word -&gt; Word
</span><a href="#local-6989586621679335436"><span class="hs-identifier hs-var">filterWord</span></a></span><span> </span><span class="annot"><span class="annottext">(Word -&gt; Word) -&gt; (Word -&gt; Word) -&gt; (Word, Word) -&gt; (Word, Word)
forall (a :: * -&gt; * -&gt; *) b c b' c'.
Arrow a =&gt;
a b c -&gt; a b' c' -&gt; a (b, b') (c, c')
</span><span class="hs-operator hs-var">***</span></span><span> </span><span class="annot"><span class="annottext">Word -&gt; Word
</span><a href="#local-6989586621679335436"><span class="hs-identifier hs-var">filterWord</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Word, Word)]
</span><a href="#local-6989586621679335428"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SM -&gt; [SRule]
</span><a href="SMType.html#srs"><span class="hs-identifier hs-var hs-var">srs</span></a></span><span> </span><span class="annot"><span class="annottext">SM
</span><a href="#local-6989586621679335443"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span>   </span><span class="hs-keyword">in</span><span>
</span><span id="line-47"></span><span>   </span><span class="annot"><span class="annottext">[[Y]] -&gt; [Set State] -&gt; [SRule] -&gt; SM
</span><a href="SMType.html#SM"><span class="hs-identifier hs-var">SM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SM -&gt; [[Y]]
</span><a href="SMType.html#yn"><span class="hs-identifier hs-var hs-var">yn</span></a></span><span> </span><span class="annot"><span class="annottext">SM
</span><a href="#local-6989586621679335443"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Set State]
</span><a href="#local-6989586621679335440"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">[SRule]
</span><a href="#local-6989586621679335430"><span class="hs-identifier hs-var">prog</span></a></span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span class="annot"><a href="TM2SM.html#createSMs"><span class="hs-identifier hs-type">createSMs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="SMType.html#Y"><span class="hs-identifier hs-type">Y</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="SMType.html#SM"><span class="hs-identifier hs-type">SM</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-50"></span><span id="createSMs"><span class="annot"><span class="annottext">createSMs :: [Y] -&gt; [SM]
</span><a href="TM2SM.html#createSMs"><span class="hs-identifier hs-var hs-var">createSMs</span></a></span></span><span> </span><span id="local-6989586621679335423"><span class="annot"><span class="annottext">[Y]
</span><a href="#local-6989586621679335423"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-51"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679335422"><span class="annot"><span class="annottext">ps :: [State]
</span><a href="#local-6989586621679335422"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">[</span><span class="annot"><span class="annottext">State
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679335421"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335421"><span class="hs-identifier hs-var">p1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679335420"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335420"><span class="hs-identifier hs-var">p2</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679335419"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335419"><span class="hs-identifier hs-var">p3</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679335418"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335418"><span class="hs-identifier hs-var">p4</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateName -&gt; [State]
</span><a href="TM2SMHelpers.html#gen"><span class="hs-identifier hs-var">gen</span></a></span><span> </span><span class="annot"><span class="annottext">StateName
</span><a href="SMType.html#P"><span class="hs-identifier hs-var">P</span></a></span><span>
</span><span id="line-52"></span><span>        </span><span id="local-6989586621679335415"><span class="annot"><span class="annottext">p's :: [State]
</span><a href="#local-6989586621679335415"><span class="hs-identifier hs-var">p's</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">[</span><span id="local-6989586621679335414"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335414"><span class="hs-identifier hs-var">p0'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679335413"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335413"><span class="hs-identifier hs-var">p1'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679335412"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335412"><span class="hs-identifier hs-var">p2'</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">State
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">State
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Tag] -&gt; [State] -&gt; [State]
</span><a href="TM2SMHelpers.html#addTags"><span class="hs-identifier hs-var">addTags</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Tag
</span><a href="SMType.html#Quote"><span class="hs-identifier hs-var">Quote</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[State]
</span><a href="#local-6989586621679335422"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-53"></span><span>        </span><span id="local-6989586621679335409"><span class="annot"><span class="annottext">pds :: [State]
</span><a href="#local-6989586621679335409"><span class="hs-identifier hs-var">pds</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">[</span><span id="local-6989586621679335408"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335408"><span class="hs-identifier hs-var">p0d</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679335407"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335407"><span class="hs-identifier hs-var">p1d</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">State
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">State
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679335406"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335406"><span class="hs-identifier hs-var">p4d</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Tag] -&gt; [State] -&gt; [State]
</span><a href="TM2SMHelpers.html#addTags"><span class="hs-identifier hs-var">addTags</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Tag
</span><a href="SMType.html#Dash"><span class="hs-identifier hs-var">Dash</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[State]
</span><a href="#local-6989586621679335422"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-54"></span><span>        </span><span class="hs-special">[</span><span id="local-6989586621679335404"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335404"><span class="hs-identifier hs-var">p0'd</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679335403"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335403"><span class="hs-identifier hs-var">p1'd</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679335402"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335402"><span class="hs-identifier hs-var">p2'd</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">State
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">State
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Tag] -&gt; [State] -&gt; [State]
</span><a href="TM2SMHelpers.html#addTags"><span class="hs-identifier hs-var">addTags</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Tag
</span><a href="SMType.html#Dash"><span class="hs-identifier hs-var">Dash</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[State]
</span><a href="#local-6989586621679335415"><span class="hs-identifier hs-var">p's</span></a></span><span>
</span><span id="line-55"></span><span>
</span><span id="line-56"></span><span>        </span><span id="local-6989586621679335401"><span class="annot"><span class="annottext">qs :: [State]
</span><a href="#local-6989586621679335401"><span class="hs-identifier hs-var">qs</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">[</span><span class="annot"><span class="annottext">State
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679335400"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335400"><span class="hs-identifier hs-var">q1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679335399"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335399"><span class="hs-identifier hs-var">q2</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679335398"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335398"><span class="hs-identifier hs-var">q3</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679335397"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335397"><span class="hs-identifier hs-var">q4</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateName -&gt; [State]
</span><a href="TM2SMHelpers.html#gen"><span class="hs-identifier hs-var">gen</span></a></span><span> </span><span class="annot"><span class="annottext">StateName
</span><a href="SMType.html#Q"><span class="hs-identifier hs-var">Q</span></a></span><span>
</span><span id="line-57"></span><span>        </span><span id="local-6989586621679335395"><span class="annot"><span class="annottext">q's :: [State]
</span><a href="#local-6989586621679335395"><span class="hs-identifier hs-var">q's</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">[</span><span id="local-6989586621679335394"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335394"><span class="hs-identifier hs-var">q0'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679335393"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335393"><span class="hs-identifier hs-var">q1'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679335392"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335392"><span class="hs-identifier hs-var">q2'</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">State
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">State
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Tag] -&gt; [State] -&gt; [State]
</span><a href="TM2SMHelpers.html#addTags"><span class="hs-identifier hs-var">addTags</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Tag
</span><a href="SMType.html#Quote"><span class="hs-identifier hs-var">Quote</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[State]
</span><a href="#local-6989586621679335401"><span class="hs-identifier hs-var">qs</span></a></span><span>
</span><span id="line-58"></span><span>        </span><span id="local-6989586621679335391"><span class="annot"><span class="annottext">qds :: [State]
</span><a href="#local-6989586621679335391"><span class="hs-identifier hs-var">qds</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">[</span><span id="local-6989586621679335390"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335390"><span class="hs-identifier hs-var">q0d</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679335389"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335389"><span class="hs-identifier hs-var">q1d</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">State
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">State
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679335388"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335388"><span class="hs-identifier hs-var">q4d</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Tag] -&gt; [State] -&gt; [State]
</span><a href="TM2SMHelpers.html#addTags"><span class="hs-identifier hs-var">addTags</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Tag
</span><a href="SMType.html#Dash"><span class="hs-identifier hs-var">Dash</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[State]
</span><a href="#local-6989586621679335401"><span class="hs-identifier hs-var">qs</span></a></span><span>
</span><span id="line-59"></span><span>        </span><span class="hs-special">[</span><span id="local-6989586621679335387"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335387"><span class="hs-identifier hs-var">q0'd</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679335386"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335386"><span class="hs-identifier hs-var">q1'd</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679335385"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335385"><span class="hs-identifier hs-var">q2'd</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">State
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">State
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Tag] -&gt; [State] -&gt; [State]
</span><a href="TM2SMHelpers.html#addTags"><span class="hs-identifier hs-var">addTags</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Tag
</span><a href="SMType.html#Dash"><span class="hs-identifier hs-var">Dash</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[State]
</span><a href="#local-6989586621679335395"><span class="hs-identifier hs-var">q's</span></a></span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span>        </span><span id="local-6989586621679335384"><span class="annot"><span class="annottext">rs :: [State]
</span><a href="#local-6989586621679335384"><span class="hs-identifier hs-var">rs</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">[</span><span class="annot"><span class="annottext">State
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679335383"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335383"><span class="hs-identifier hs-var">r1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679335382"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335382"><span class="hs-identifier hs-var">r2</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679335381"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335381"><span class="hs-identifier hs-var">r3</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679335380"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335380"><span class="hs-identifier hs-var">r4</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateName -&gt; [State]
</span><a href="TM2SMHelpers.html#gen"><span class="hs-identifier hs-var">gen</span></a></span><span> </span><span class="annot"><span class="annottext">StateName
</span><a href="SMType.html#R"><span class="hs-identifier hs-var">R</span></a></span><span>
</span><span id="line-62"></span><span>        </span><span id="local-6989586621679335378"><span class="annot"><span class="annottext">r's :: [State]
</span><a href="#local-6989586621679335378"><span class="hs-identifier hs-var">r's</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">[</span><span id="local-6989586621679335377"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335377"><span class="hs-identifier hs-var">r0'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679335376"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335376"><span class="hs-identifier hs-var">r1'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679335375"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335375"><span class="hs-identifier hs-var">r2'</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">State
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">State
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Tag] -&gt; [State] -&gt; [State]
</span><a href="TM2SMHelpers.html#addTags"><span class="hs-identifier hs-var">addTags</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Tag
</span><a href="SMType.html#Quote"><span class="hs-identifier hs-var">Quote</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[State]
</span><a href="#local-6989586621679335384"><span class="hs-identifier hs-var">rs</span></a></span><span>
</span><span id="line-63"></span><span>        </span><span id="local-6989586621679335374"><span class="annot"><span class="annottext">rds :: [State]
</span><a href="#local-6989586621679335374"><span class="hs-identifier hs-var">rds</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">[</span><span id="local-6989586621679335373"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335373"><span class="hs-identifier hs-var">r0d</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679335372"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335372"><span class="hs-identifier hs-var">r1d</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">State
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">State
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679335371"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335371"><span class="hs-identifier hs-var">r4d</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Tag] -&gt; [State] -&gt; [State]
</span><a href="TM2SMHelpers.html#addTags"><span class="hs-identifier hs-var">addTags</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Tag
</span><a href="SMType.html#Dash"><span class="hs-identifier hs-var">Dash</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[State]
</span><a href="#local-6989586621679335384"><span class="hs-identifier hs-var">rs</span></a></span><span>
</span><span id="line-64"></span><span>        </span><span class="hs-special">[</span><span id="local-6989586621679335370"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335370"><span class="hs-identifier hs-var">r0'd</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679335369"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335369"><span class="hs-identifier hs-var">r1'd</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679335368"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335368"><span class="hs-identifier hs-var">r2'd</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">State
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">State
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Tag] -&gt; [State] -&gt; [State]
</span><a href="TM2SMHelpers.html#addTags"><span class="hs-identifier hs-var">addTags</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Tag
</span><a href="SMType.html#Dash"><span class="hs-identifier hs-var">Dash</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[State]
</span><a href="#local-6989586621679335378"><span class="hs-identifier hs-var">r's</span></a></span><span>
</span><span id="line-65"></span><span>
</span><span id="line-66"></span><span>        </span><span id="local-6989586621679335367"><span class="annot"><span class="annottext">ss :: [State]
</span><a href="#local-6989586621679335367"><span class="hs-identifier hs-var">ss</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">[</span><span class="annot"><span class="annottext">State
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679335366"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335366"><span class="hs-identifier hs-var">s1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679335365"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335365"><span class="hs-identifier hs-var">s2</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679335364"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335364"><span class="hs-identifier hs-var">s3</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679335363"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335363"><span class="hs-identifier hs-var">s4</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateName -&gt; [State]
</span><a href="TM2SMHelpers.html#gen"><span class="hs-identifier hs-var">gen</span></a></span><span> </span><span class="annot"><span class="annottext">StateName
</span><a href="SMType.html#S"><span class="hs-identifier hs-var">S</span></a></span><span>
</span><span id="line-67"></span><span>        </span><span id="local-6989586621679335361"><span class="annot"><span class="annottext">s's :: [State]
</span><a href="#local-6989586621679335361"><span class="hs-identifier hs-var">s's</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">[</span><span id="local-6989586621679335360"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335360"><span class="hs-identifier hs-var">s0'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679335359"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335359"><span class="hs-identifier hs-var">s1'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679335358"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335358"><span class="hs-identifier hs-var">s2'</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">State
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">State
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Tag] -&gt; [State] -&gt; [State]
</span><a href="TM2SMHelpers.html#addTags"><span class="hs-identifier hs-var">addTags</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Tag
</span><a href="SMType.html#Quote"><span class="hs-identifier hs-var">Quote</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[State]
</span><a href="#local-6989586621679335367"><span class="hs-identifier hs-var">ss</span></a></span><span>
</span><span id="line-68"></span><span>        </span><span id="local-6989586621679335357"><span class="annot"><span class="annottext">sds :: [State]
</span><a href="#local-6989586621679335357"><span class="hs-identifier hs-var">sds</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">[</span><span id="local-6989586621679335356"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335356"><span class="hs-identifier hs-var">s0d</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679335355"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335355"><span class="hs-identifier hs-var">s1d</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">State
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">State
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679335354"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335354"><span class="hs-identifier hs-var">s4d</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Tag] -&gt; [State] -&gt; [State]
</span><a href="TM2SMHelpers.html#addTags"><span class="hs-identifier hs-var">addTags</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Tag
</span><a href="SMType.html#Dash"><span class="hs-identifier hs-var">Dash</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[State]
</span><a href="#local-6989586621679335367"><span class="hs-identifier hs-var">ss</span></a></span><span>
</span><span id="line-69"></span><span>        </span><span class="hs-special">[</span><span id="local-6989586621679335353"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335353"><span class="hs-identifier hs-var">s0'd</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679335352"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335352"><span class="hs-identifier hs-var">s1'd</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679335351"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335351"><span class="hs-identifier hs-var">s2'd</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">State
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">State
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Tag] -&gt; [State] -&gt; [State]
</span><a href="TM2SMHelpers.html#addTags"><span class="hs-identifier hs-var">addTags</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Tag
</span><a href="SMType.html#Dash"><span class="hs-identifier hs-var">Dash</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[State]
</span><a href="#local-6989586621679335361"><span class="hs-identifier hs-var">s's</span></a></span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span>        </span><span id="local-6989586621679335350"><span class="annot"><span class="annottext">ts :: [State]
</span><a href="#local-6989586621679335350"><span class="hs-identifier hs-var">ts</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">[</span><span class="annot"><span class="annottext">State
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679335349"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335349"><span class="hs-identifier hs-var">t1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679335348"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335348"><span class="hs-identifier hs-var">t2</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679335347"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335347"><span class="hs-identifier hs-var">t3</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679335346"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335346"><span class="hs-identifier hs-var">t4</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateName -&gt; [State]
</span><a href="TM2SMHelpers.html#gen"><span class="hs-identifier hs-var">gen</span></a></span><span> </span><span class="annot"><span class="annottext">StateName
</span><a href="SMType.html#T"><span class="hs-identifier hs-var">T</span></a></span><span>
</span><span id="line-72"></span><span>        </span><span id="local-6989586621679335344"><span class="annot"><span class="annottext">t's :: [State]
</span><a href="#local-6989586621679335344"><span class="hs-identifier hs-var">t's</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">[</span><span id="local-6989586621679335343"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335343"><span class="hs-identifier hs-var">t0'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679335342"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335342"><span class="hs-identifier hs-var">t1'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679335341"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335341"><span class="hs-identifier hs-var">t2'</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">State
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">State
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Tag] -&gt; [State] -&gt; [State]
</span><a href="TM2SMHelpers.html#addTags"><span class="hs-identifier hs-var">addTags</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Tag
</span><a href="SMType.html#Quote"><span class="hs-identifier hs-var">Quote</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[State]
</span><a href="#local-6989586621679335350"><span class="hs-identifier hs-var">ts</span></a></span><span>
</span><span id="line-73"></span><span>        </span><span id="local-6989586621679335340"><span class="annot"><span class="annottext">tds :: [State]
</span><a href="#local-6989586621679335340"><span class="hs-identifier hs-var">tds</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">[</span><span id="local-6989586621679335339"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335339"><span class="hs-identifier hs-var">t0d</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679335338"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335338"><span class="hs-identifier hs-var">t1d</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">State
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">State
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679335337"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335337"><span class="hs-identifier hs-var">t4d</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Tag] -&gt; [State] -&gt; [State]
</span><a href="TM2SMHelpers.html#addTags"><span class="hs-identifier hs-var">addTags</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Tag
</span><a href="SMType.html#Dash"><span class="hs-identifier hs-var">Dash</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[State]
</span><a href="#local-6989586621679335350"><span class="hs-identifier hs-var">ts</span></a></span><span>
</span><span id="line-74"></span><span>        </span><span class="hs-special">[</span><span id="local-6989586621679335336"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335336"><span class="hs-identifier hs-var">t0'd</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679335335"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335335"><span class="hs-identifier hs-var">t1'd</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679335334"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335334"><span class="hs-identifier hs-var">t2'd</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">State
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">State
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Tag] -&gt; [State] -&gt; [State]
</span><a href="TM2SMHelpers.html#addTags"><span class="hs-identifier hs-var">addTags</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Tag
</span><a href="SMType.html#Dash"><span class="hs-identifier hs-var">Dash</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[State]
</span><a href="#local-6989586621679335344"><span class="hs-identifier hs-var">t's</span></a></span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span>        </span><span id="local-6989586621679335333"><span class="annot"><span class="annottext">us :: [State]
</span><a href="#local-6989586621679335333"><span class="hs-identifier hs-var">us</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">[</span><span class="annot"><span class="annottext">State
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679335332"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335332"><span class="hs-identifier hs-var">u1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679335331"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335331"><span class="hs-identifier hs-var">u2</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679335330"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335330"><span class="hs-identifier hs-var">u3</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679335329"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335329"><span class="hs-identifier hs-var">u4</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateName -&gt; [State]
</span><a href="TM2SMHelpers.html#gen"><span class="hs-identifier hs-var">gen</span></a></span><span> </span><span class="annot"><span class="annottext">StateName
</span><a href="SMType.html#U"><span class="hs-identifier hs-var">U</span></a></span><span>
</span><span id="line-77"></span><span>        </span><span id="local-6989586621679335327"><span class="annot"><span class="annottext">u's :: [State]
</span><a href="#local-6989586621679335327"><span class="hs-identifier hs-var">u's</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">[</span><span id="local-6989586621679335326"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335326"><span class="hs-identifier hs-var">u0'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679335325"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335325"><span class="hs-identifier hs-var">u1'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679335324"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335324"><span class="hs-identifier hs-var">u2'</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">State
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">State
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Tag] -&gt; [State] -&gt; [State]
</span><a href="TM2SMHelpers.html#addTags"><span class="hs-identifier hs-var">addTags</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Tag
</span><a href="SMType.html#Quote"><span class="hs-identifier hs-var">Quote</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[State]
</span><a href="#local-6989586621679335333"><span class="hs-identifier hs-var">us</span></a></span><span>
</span><span id="line-78"></span><span>        </span><span id="local-6989586621679335323"><span class="annot"><span class="annottext">uds :: [State]
</span><a href="#local-6989586621679335323"><span class="hs-identifier hs-var">uds</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">[</span><span id="local-6989586621679335322"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335322"><span class="hs-identifier hs-var">u0d</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679335321"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335321"><span class="hs-identifier hs-var">u1d</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">State
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">State
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679335320"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335320"><span class="hs-identifier hs-var">u4d</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Tag] -&gt; [State] -&gt; [State]
</span><a href="TM2SMHelpers.html#addTags"><span class="hs-identifier hs-var">addTags</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Tag
</span><a href="SMType.html#Dash"><span class="hs-identifier hs-var">Dash</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[State]
</span><a href="#local-6989586621679335333"><span class="hs-identifier hs-var">us</span></a></span><span>
</span><span id="line-79"></span><span>        </span><span class="hs-special">[</span><span id="local-6989586621679335319"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335319"><span class="hs-identifier hs-var">u0'd</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679335318"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335318"><span class="hs-identifier hs-var">u1'd</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679335317"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335317"><span class="hs-identifier hs-var">u2'd</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">State
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">State
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Tag] -&gt; [State] -&gt; [State]
</span><a href="TM2SMHelpers.html#addTags"><span class="hs-identifier hs-var">addTags</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Tag
</span><a href="SMType.html#Dash"><span class="hs-identifier hs-var">Dash</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[State]
</span><a href="#local-6989586621679335327"><span class="hs-identifier hs-var">u's</span></a></span><span>
</span><span id="line-80"></span><span>
</span><span id="line-81"></span><span>        </span><span id="local-6989586621679335316"><span class="annot"><span class="annottext">xs :: [State]
</span><a href="#local-6989586621679335316"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">[</span><span id="local-6989586621679335315"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335315"><span class="hs-identifier hs-var">x0</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679335314"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335314"><span class="hs-identifier hs-var">x1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679335313"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335313"><span class="hs-identifier hs-var">x2</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">State
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679335312"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335312"><span class="hs-identifier hs-var">x4</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateName -&gt; String -&gt; State
</span><a href="TM2SMHelpers.html#eTagState"><span class="hs-identifier hs-var">eTagState</span></a></span><span> </span><span class="annot"><span class="annottext">StateName
</span><a href="SMType.html#X"><span class="hs-identifier hs-var">X</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">State -&gt; [State] -&gt; [State]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">StateName -&gt; [Integer] -&gt; [State]
forall a. Show a =&gt; StateName -&gt; [a] -&gt; [State]
</span><a href="TM2SMHelpers.html#genRange"><span class="hs-identifier hs-var">genRange</span></a></span><span> </span><span class="annot"><span class="annottext">StateName
</span><a href="SMType.html#X"><span class="hs-identifier hs-var">X</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">4</span></span><span class="hs-special">]</span><span>
</span><span id="line-82"></span><span>        </span><span class="hs-special">[</span><span id="local-6989586621679335308"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335308"><span class="hs-identifier hs-var">x0'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679335307"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335307"><span class="hs-identifier hs-var">x1'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679335306"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335306"><span class="hs-identifier hs-var">x2'</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">State
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">State
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Tag] -&gt; [State] -&gt; [State]
</span><a href="TM2SMHelpers.html#addTags"><span class="hs-identifier hs-var">addTags</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Tag
</span><a href="SMType.html#Quote"><span class="hs-identifier hs-var">Quote</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[State]
</span><a href="#local-6989586621679335316"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span>        </span><span id="local-6989586621679335305"><span class="annot"><span class="annottext">e :: State
</span><a href="#local-6989586621679335305"><span class="hs-identifier hs-var hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateName -&gt; String -&gt; Set Tag -&gt; Maybe StateVal -&gt; State
</span><a href="SMType.html#State"><span class="hs-identifier hs-var">State</span></a></span><span> </span><span class="annot"><span class="annottext">StateName
</span><a href="SMType.html#E"><span class="hs-identifier hs-var">E</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">Set Tag
</span><a href="TM2SMHelpers.html#eTag"><span class="hs-identifier hs-var">eTag</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe StateVal
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-85"></span><span>        </span><span id="local-6989586621679335301"><span class="annot"><span class="annottext">e' :: State
</span><a href="#local-6989586621679335301"><span class="hs-identifier hs-var hs-var">e'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateName -&gt; String -&gt; Set Tag -&gt; Maybe StateVal -&gt; State
</span><a href="SMType.html#State"><span class="hs-identifier hs-var">State</span></a></span><span> </span><span class="annot"><span class="annottext">StateName
</span><a href="SMType.html#E"><span class="hs-identifier hs-var">E</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Tag] -&gt; Set Tag
forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">Set.fromList</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Tag
</span><a href="SMType.html#Quote"><span class="hs-identifier hs-var">Quote</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe StateVal
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-86"></span><span>        </span><span id="local-6989586621679335299"><span class="annot"><span class="annottext">f :: State
</span><a href="#local-6989586621679335299"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateName -&gt; String -&gt; Set Tag -&gt; Maybe StateVal -&gt; State
</span><a href="SMType.html#State"><span class="hs-identifier hs-var">State</span></a></span><span> </span><span class="annot"><span class="annottext">StateName
</span><a href="SMType.html#F"><span class="hs-identifier hs-var">F</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">Set Tag
</span><a href="TM2SMHelpers.html#eTag"><span class="hs-identifier hs-var">eTag</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe StateVal
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-87"></span><span>        </span><span id="local-6989586621679335297"><span class="annot"><span class="annottext">f' :: State
</span><a href="#local-6989586621679335297"><span class="hs-identifier hs-var hs-var">f'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateName -&gt; String -&gt; Set Tag -&gt; Maybe StateVal -&gt; State
</span><a href="SMType.html#State"><span class="hs-identifier hs-var">State</span></a></span><span> </span><span class="annot"><span class="annottext">StateName
</span><a href="SMType.html#F"><span class="hs-identifier hs-var">F</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Tag] -&gt; Set Tag
forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">Set.fromList</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Tag
</span><a href="SMType.html#Quote"><span class="hs-identifier hs-var">Quote</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe StateVal
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-88"></span><span>
</span><span id="line-89"></span><span>        </span><span class="annot"><a href="#local-6989586621679335296"><span class="hs-identifier hs-type">copySM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="SMType.html#SM"><span class="hs-identifier hs-type">SM</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="SMType.html#State"><span class="hs-identifier hs-type">State</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="SMType.html#Tag"><span class="hs-identifier hs-type">Tag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="SMType.html#SM"><span class="hs-identifier hs-type">SM</span></a></span><span>
</span><span id="line-90"></span><span>        </span><span id="local-6989586621679335296"><span class="annot"><span class="annottext">copySM :: SM -&gt; (State -&gt; Bool) -&gt; Tag -&gt; SM
</span><a href="#local-6989586621679335296"><span class="hs-identifier hs-var hs-var">copySM</span></a></span></span><span> </span><span id="local-6989586621679335295"><span class="annot"><span class="annottext">SM
</span><a href="#local-6989586621679335295"><span class="hs-identifier hs-var">sm</span></a></span></span><span> </span><span id="local-6989586621679335294"><span class="annot"><span class="annottext">State -&gt; Bool
</span><a href="#local-6989586621679335294"><span class="hs-identifier hs-var">qFilter</span></a></span></span><span> </span><span id="local-6989586621679335293"><span class="annot"><span class="annottext">Tag
</span><a href="#local-6989586621679335293"><span class="hs-identifier hs-var">newTag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-91"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679335292"><span class="annot"><span class="annottext">qss :: [Set State]
</span><a href="#local-6989586621679335292"><span class="hs-identifier hs-var hs-var">qss</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Set State -&gt; Set State) -&gt; [Set State] -&gt; [Set State]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(State -&gt; State) -&gt; Set State -&gt; Set State
forall b a. Ord b =&gt; (a -&gt; b) -&gt; Set a -&gt; Set b
</span><span class="hs-identifier hs-var">Set.map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679335291"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335291"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">State -&gt; Bool
</span><a href="#local-6989586621679335294"><span class="hs-identifier hs-var">qFilter</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335291"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Tag -&gt; State -&gt; State
</span><a href="TM2SMHelpers.html#addTag"><span class="hs-identifier hs-var">addTag</span></a></span><span> </span><span class="annot"><span class="annottext">Tag
</span><a href="#local-6989586621679335293"><span class="hs-identifier hs-var">newTag</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335291"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335291"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Set State] -&gt; [Set State]) -&gt; [Set State] -&gt; [Set State]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SM -&gt; [Set State]
</span><a href="SMType.html#qn"><span class="hs-identifier hs-var hs-var">qn</span></a></span><span> </span><span class="annot"><span class="annottext">SM
</span><a href="#local-6989586621679335295"><span class="hs-identifier hs-var">sm</span></a></span><span>
</span><span id="line-92"></span><span>                </span><span id="local-6989586621679335289"><span class="annot"><span class="annottext">filterWord :: Word -&gt; Word
</span><a href="#local-6989586621679335289"><span class="hs-identifier hs-var hs-var">filterWord</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="SMType.html#Word"><span class="hs-identifier hs-type">Word</span></a></span><span> </span><span id="local-6989586621679335288"><span class="annot"><span class="annottext">[Smb]
</span><a href="#local-6989586621679335288"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Smb -&gt; Smb) -&gt; [Smb] -&gt; [Smb]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679335287"><span class="annot"><span class="annottext">Smb
</span><a href="#local-6989586621679335287"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Smb
</span><a href="#local-6989586621679335287"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="annot"><a href="SMType.html#SmbQ"><span class="hs-identifier hs-type">SmbQ</span></a></span><span> </span><span id="local-6989586621679335286"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335286"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">State -&gt; Bool
</span><a href="#local-6989586621679335294"><span class="hs-identifier hs-var">qFilter</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335286"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tag -&gt; State -&gt; State
</span><a href="TM2SMHelpers.html#addTag"><span class="hs-identifier hs-var">addTag</span></a></span><span> </span><span class="annot"><span class="annottext">Tag
</span><a href="#local-6989586621679335293"><span class="hs-identifier hs-var">newTag</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335286"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Smb
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Smb
</span><a href="#local-6989586621679335287"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Smb]
</span><a href="#local-6989586621679335288"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-93"></span><span>                </span><span id="local-6989586621679335285"><span class="annot"><span class="annottext">prog :: [SRule]
</span><a href="#local-6989586621679335285"><span class="hs-identifier hs-var hs-var">prog</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SRule -&gt; SRule) -&gt; [SRule] -&gt; [SRule]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="SMType.html#SRule"><span class="hs-identifier hs-type">SRule</span></a></span><span> </span><span id="local-6989586621679335284"><span class="annot"><span class="annottext">[(Word, Word)]
</span><a href="#local-6989586621679335284"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[(Word, Word)] -&gt; SRule
</span><a href="SMType.html#SRule"><span class="hs-identifier hs-var">SRule</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Word, Word) -&gt; (Word, Word)) -&gt; [(Word, Word)] -&gt; [(Word, Word)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word -&gt; Word
</span><a href="#local-6989586621679335289"><span class="hs-identifier hs-var">filterWord</span></a></span><span> </span><span class="annot"><span class="annottext">(Word -&gt; Word) -&gt; (Word -&gt; Word) -&gt; (Word, Word) -&gt; (Word, Word)
forall (a :: * -&gt; * -&gt; *) b c b' c'.
Arrow a =&gt;
a b c -&gt; a b' c' -&gt; a (b, b') (c, c')
</span><span class="hs-operator hs-var">***</span></span><span> </span><span class="annot"><span class="annottext">Word -&gt; Word
</span><a href="#local-6989586621679335289"><span class="hs-identifier hs-var">filterWord</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Word, Word)]
</span><a href="#local-6989586621679335284"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SM -&gt; [SRule]
</span><a href="SMType.html#srs"><span class="hs-identifier hs-var hs-var">srs</span></a></span><span> </span><span class="annot"><span class="annottext">SM
</span><a href="#local-6989586621679335295"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-94"></span><span>            </span><span class="hs-keyword">in</span><span>
</span><span id="line-95"></span><span>                </span><span class="annot"><span class="annottext">[[Y]] -&gt; [Set State] -&gt; [SRule] -&gt; SM
</span><a href="SMType.html#SM"><span class="hs-identifier hs-var">SM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SM -&gt; [[Y]]
</span><a href="SMType.html#yn"><span class="hs-identifier hs-var hs-var">yn</span></a></span><span> </span><span class="annot"><span class="annottext">SM
</span><a href="#local-6989586621679335295"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Set State]
</span><a href="#local-6989586621679335292"><span class="hs-identifier hs-var">qss</span></a></span><span> </span><span class="annot"><span class="annottext">[SRule]
</span><a href="#local-6989586621679335285"><span class="hs-identifier hs-var">prog</span></a></span><span>
</span><span id="line-96"></span><span>
</span><span id="line-97"></span><span>        </span><span class="annot"><a href="#local-6989586621679335283"><span class="hs-identifier hs-type">sm1</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="SMType.html#SM"><span class="hs-identifier hs-type">SM</span></a></span><span>
</span><span id="line-98"></span><span>        </span><span id="local-6989586621679335283"><span class="annot"><span class="annottext">sm1 :: SM
</span><a href="#local-6989586621679335283"><span class="hs-identifier hs-var hs-var">sm1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-99"></span><span>            </span><span class="hs-keyword">let</span><span>
</span><span id="line-100"></span><span>               </span><span id="local-6989586621679335282"><span class="annot"><span class="annottext">rl1 :: SRule
</span><a href="#local-6989586621679335282"><span class="hs-identifier hs-var hs-var">rl1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-101"></span><span>                  </span><span class="annot"><span class="annottext">[(Word, Word)] -&gt; SRule
</span><a href="SMType.html#SRule"><span class="hs-identifier hs-var">SRule</span></a></span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-102"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335400"><span class="hs-identifier hs-var">q1</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Y -&gt; Smb
</span><a href="SMType.html#SmbY%27"><span class="hs-identifier hs-var">SmbY'</span></a></span><span> </span><span class="annot"><span class="annottext">Y
</span><a href="SMType.html#Delta"><span class="hs-identifier hs-var">Delta</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Y -&gt; Smb
</span><a href="SMType.html#SmbY%27"><span class="hs-identifier hs-var">SmbY'</span></a></span><span> </span><span class="annot"><span class="annottext">Y
</span><a href="SMType.html#Delta"><span class="hs-identifier hs-var">Delta</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335400"><span class="hs-identifier hs-var">q1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Y -&gt; Smb
</span><a href="SMType.html#SmbY"><span class="hs-identifier hs-var">SmbY</span></a></span><span> </span><span class="annot"><span class="annottext">Y
</span><a href="SMType.html#Delta"><span class="hs-identifier hs-var">Delta</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Y -&gt; Smb
</span><a href="SMType.html#SmbY"><span class="hs-identifier hs-var">SmbY</span></a></span><span> </span><span class="annot"><span class="annottext">Y
</span><a href="SMType.html#Delta"><span class="hs-identifier hs-var">Delta</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-103"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335383"><span class="hs-identifier hs-var">r1</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Y -&gt; Smb
</span><a href="SMType.html#SmbY%27"><span class="hs-identifier hs-var">SmbY'</span></a></span><span> </span><span class="annot"><span class="annottext">Y
</span><a href="SMType.html#Delta"><span class="hs-identifier hs-var">Delta</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335383"><span class="hs-identifier hs-var">r1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Y -&gt; Smb
</span><a href="SMType.html#SmbY"><span class="hs-identifier hs-var">SmbY</span></a></span><span> </span><span class="annot"><span class="annottext">Y
</span><a href="SMType.html#Delta"><span class="hs-identifier hs-var">Delta</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-104"></span><span>                  </span><span class="hs-special">]</span><span>
</span><span id="line-105"></span><span>               </span><span id="local-6989586621679335278"><span class="annot"><span class="annottext">rl2 :: SRule
</span><a href="#local-6989586621679335278"><span class="hs-identifier hs-var hs-var">rl2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-106"></span><span>                  </span><span class="annot"><span class="annottext">[(Word, Word)] -&gt; SRule
</span><a href="SMType.html#SRule"><span class="hs-identifier hs-var">SRule</span></a></span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-107"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335421"><span class="hs-identifier hs-var">p1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335400"><span class="hs-identifier hs-var">q1</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335420"><span class="hs-identifier hs-var">p2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335399"><span class="hs-identifier hs-var">q2</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-108"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335383"><span class="hs-identifier hs-var">r1</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335382"><span class="hs-identifier hs-var">r2</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-109"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335366"><span class="hs-identifier hs-var">s1</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335365"><span class="hs-identifier hs-var">s2</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-110"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335349"><span class="hs-identifier hs-var">t1</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335348"><span class="hs-identifier hs-var">t2</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-111"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335332"><span class="hs-identifier hs-var">u1</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Y -&gt; Smb
</span><a href="SMType.html#SmbY"><span class="hs-identifier hs-var">SmbY</span></a></span><span> </span><span class="annot"><span class="annottext">Y
</span><a href="SMType.html#Delta"><span class="hs-identifier hs-var">Delta</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335331"><span class="hs-identifier hs-var">u2</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-112"></span><span>                  </span><span class="hs-special">]</span><span>
</span><span id="line-113"></span><span>               </span><span id="local-6989586621679335277"><span class="annot"><span class="annottext">rl3 :: SRule
</span><a href="#local-6989586621679335277"><span class="hs-identifier hs-var hs-var">rl3</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-114"></span><span>                  </span><span class="annot"><span class="annottext">[(Word, Word)] -&gt; SRule
</span><a href="SMType.html#SRule"><span class="hs-identifier hs-var">SRule</span></a></span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-115"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335421"><span class="hs-identifier hs-var">p1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Y -&gt; Smb
</span><a href="SMType.html#SmbY"><span class="hs-identifier hs-var">SmbY</span></a></span><span> </span><span class="annot"><span class="annottext">Y
</span><a href="SMType.html#Delta"><span class="hs-identifier hs-var">Delta</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335400"><span class="hs-identifier hs-var">q1</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335419"><span class="hs-identifier hs-var">p3</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Y -&gt; Smb
</span><a href="SMType.html#SmbY"><span class="hs-identifier hs-var">SmbY</span></a></span><span> </span><span class="annot"><span class="annottext">Y
</span><a href="SMType.html#Delta"><span class="hs-identifier hs-var">Delta</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335398"><span class="hs-identifier hs-var">q3</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-116"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335383"><span class="hs-identifier hs-var">r1</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335381"><span class="hs-identifier hs-var">r3</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-117"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335366"><span class="hs-identifier hs-var">s1</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335364"><span class="hs-identifier hs-var">s3</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-118"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335349"><span class="hs-identifier hs-var">t1</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335347"><span class="hs-identifier hs-var">t3</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-119"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335332"><span class="hs-identifier hs-var">u1</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335330"><span class="hs-identifier hs-var">u3</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-120"></span><span>
</span><span id="line-121"></span><span>                  </span><span class="hs-special">]</span><span>
</span><span id="line-122"></span><span>            </span><span class="hs-keyword">in</span><span>
</span><span id="line-123"></span><span>            </span><span class="annot"><span class="annottext">[[Y]] -&gt; [Set State] -&gt; [SRule] -&gt; SM
</span><a href="SMType.html#SM"><span class="hs-identifier hs-var">SM</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><span class="annottext">Y
</span><a href="SMType.html#Delta"><span class="hs-identifier hs-var">Delta</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="annot"><span class="annottext">Y
</span><a href="SMType.html#Delta"><span class="hs-identifier hs-var">Delta</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="annot"><span class="annottext">Y
</span><a href="SMType.html#Delta"><span class="hs-identifier hs-var">Delta</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="annot"><span class="annottext">Y
</span><a href="SMType.html#Delta"><span class="hs-identifier hs-var">Delta</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([State] -&gt; Set State) -&gt; [[State]] -&gt; [Set State]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">[State] -&gt; Set State
forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">Set.fromList</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335421"><span class="hs-identifier hs-var">p1</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335420"><span class="hs-identifier hs-var">p2</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335419"><span class="hs-identifier hs-var">p3</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335400"><span class="hs-identifier hs-var">q1</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335399"><span class="hs-identifier hs-var">q2</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335398"><span class="hs-identifier hs-var">q3</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335383"><span class="hs-identifier hs-var">r1</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335382"><span class="hs-identifier hs-var">r2</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335381"><span class="hs-identifier hs-var">r3</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335366"><span class="hs-identifier hs-var">s1</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335365"><span class="hs-identifier hs-var">s2</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335364"><span class="hs-identifier hs-var">s3</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335349"><span class="hs-identifier hs-var">t1</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335348"><span class="hs-identifier hs-var">t2</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335347"><span class="hs-identifier hs-var">t3</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335332"><span class="hs-identifier hs-var">u1</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335331"><span class="hs-identifier hs-var">u2</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335330"><span class="hs-identifier hs-var">u3</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">SRule
</span><a href="#local-6989586621679335282"><span class="hs-identifier hs-var">rl1</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">SRule
</span><a href="#local-6989586621679335278"><span class="hs-identifier hs-var">rl2</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">SRule
</span><a href="#local-6989586621679335277"><span class="hs-identifier hs-var">rl3</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-124"></span><span>
</span><span id="line-125"></span><span>        </span><span class="annot"><a href="#local-6989586621679335276"><span class="hs-identifier hs-type">sm2</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="SMType.html#SM"><span class="hs-identifier hs-type">SM</span></a></span><span>
</span><span id="line-126"></span><span>        </span><span id="local-6989586621679335276"><span class="annot"><span class="annottext">sm2 :: SM
</span><a href="#local-6989586621679335276"><span class="hs-identifier hs-var hs-var">sm2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-127"></span><span>            </span><span class="hs-keyword">let</span><span>
</span><span id="line-128"></span><span>               </span><span id="local-6989586621679335275"><span class="annot"><span class="annottext">rl1 :: SRule
</span><a href="#local-6989586621679335275"><span class="hs-identifier hs-var hs-var">rl1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-129"></span><span>                  </span><span class="annot"><span class="annottext">[(Word, Word)] -&gt; SRule
</span><a href="SMType.html#SRule"><span class="hs-identifier hs-var">SRule</span></a></span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-130"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335399"><span class="hs-identifier hs-var">q2</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Y -&gt; Smb
</span><a href="SMType.html#SmbY"><span class="hs-identifier hs-var">SmbY</span></a></span><span> </span><span class="annot"><span class="annottext">Y
</span><a href="SMType.html#Delta"><span class="hs-identifier hs-var">Delta</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335399"><span class="hs-identifier hs-var">q2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Y -&gt; Smb
</span><a href="SMType.html#SmbY%27"><span class="hs-identifier hs-var">SmbY'</span></a></span><span> </span><span class="annot"><span class="annottext">Y
</span><a href="SMType.html#Delta"><span class="hs-identifier hs-var">Delta</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-131"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335365"><span class="hs-identifier hs-var">s2</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Y -&gt; Smb
</span><a href="SMType.html#SmbY%27"><span class="hs-identifier hs-var">SmbY'</span></a></span><span> </span><span class="annot"><span class="annottext">Y
</span><a href="SMType.html#Delta"><span class="hs-identifier hs-var">Delta</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335365"><span class="hs-identifier hs-var">s2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Y -&gt; Smb
</span><a href="SMType.html#SmbY"><span class="hs-identifier hs-var">SmbY</span></a></span><span> </span><span class="annot"><span class="annottext">Y
</span><a href="SMType.html#Delta"><span class="hs-identifier hs-var">Delta</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-132"></span><span>                  </span><span class="hs-special">]</span><span>
</span><span id="line-133"></span><span>
</span><span id="line-134"></span><span>               </span><span id="local-6989586621679335274"><span class="annot"><span class="annottext">rl2 :: SRule
</span><a href="#local-6989586621679335274"><span class="hs-identifier hs-var hs-var">rl2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-135"></span><span>                  </span><span class="annot"><span class="annottext">[(Word, Word)] -&gt; SRule
</span><a href="SMType.html#SRule"><span class="hs-identifier hs-var">SRule</span></a></span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-136"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335399"><span class="hs-identifier hs-var">q2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335382"><span class="hs-identifier hs-var">r2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335365"><span class="hs-identifier hs-var">s2</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335400"><span class="hs-identifier hs-var">q1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335383"><span class="hs-identifier hs-var">r1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335366"><span class="hs-identifier hs-var">s1</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-137"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335420"><span class="hs-identifier hs-var">p2</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335421"><span class="hs-identifier hs-var">p1</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-138"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335348"><span class="hs-identifier hs-var">t2</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335349"><span class="hs-identifier hs-var">t1</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-139"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335331"><span class="hs-identifier hs-var">u2</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335332"><span class="hs-identifier hs-var">u1</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-140"></span><span>                  </span><span class="hs-special">]</span><span>
</span><span id="line-141"></span><span>
</span><span id="line-142"></span><span>            </span><span class="hs-keyword">in</span><span>
</span><span id="line-143"></span><span>            </span><span class="annot"><span class="annottext">[[Y]] -&gt; [Set State] -&gt; [SRule] -&gt; SM
</span><a href="SMType.html#SM"><span class="hs-identifier hs-var">SM</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><span class="annottext">Y
</span><a href="SMType.html#Delta"><span class="hs-identifier hs-var">Delta</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="annot"><span class="annottext">Y
</span><a href="SMType.html#Delta"><span class="hs-identifier hs-var">Delta</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="annot"><span class="annottext">Y
</span><a href="SMType.html#Delta"><span class="hs-identifier hs-var">Delta</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="annot"><span class="annottext">Y
</span><a href="SMType.html#Delta"><span class="hs-identifier hs-var">Delta</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([State] -&gt; Set State) -&gt; [[State]] -&gt; [Set State]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">[State] -&gt; Set State
forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">Set.fromList</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335421"><span class="hs-identifier hs-var">p1</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335420"><span class="hs-identifier hs-var">p2</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335400"><span class="hs-identifier hs-var">q1</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335399"><span class="hs-identifier hs-var">q2</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335383"><span class="hs-identifier hs-var">r1</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335382"><span class="hs-identifier hs-var">r2</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335366"><span class="hs-identifier hs-var">s1</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335365"><span class="hs-identifier hs-var">s2</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335349"><span class="hs-identifier hs-var">t1</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335348"><span class="hs-identifier hs-var">t2</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335332"><span class="hs-identifier hs-var">u1</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335331"><span class="hs-identifier hs-var">u2</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">SRule
</span><a href="#local-6989586621679335275"><span class="hs-identifier hs-var">rl1</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">SRule
</span><a href="#local-6989586621679335274"><span class="hs-identifier hs-var">rl2</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-144"></span><span>
</span><span id="line-145"></span><span>
</span><span id="line-146"></span><span>        </span><span class="annot"><a href="#local-6989586621679335273"><span class="hs-identifier hs-type">sm3</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="SMType.html#SM"><span class="hs-identifier hs-type">SM</span></a></span><span>
</span><span id="line-147"></span><span>        </span><span id="local-6989586621679335273"><span class="annot"><span class="annottext">sm3 :: SM
</span><a href="#local-6989586621679335273"><span class="hs-identifier hs-var hs-var">sm3</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[Y]] -&gt; [Set State] -&gt; [SRule] -&gt; SM
</span><a href="SMType.html#SM"><span class="hs-identifier hs-var">SM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SM -&gt; [[Y]]
</span><a href="SMType.html#yn"><span class="hs-identifier hs-var hs-var">yn</span></a></span><span> </span><span class="annot"><span class="annottext">SM
</span><a href="#local-6989586621679335283"><span class="hs-identifier hs-var">sm1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SM -&gt; [Set State]
</span><a href="SMType.html#qn"><span class="hs-identifier hs-var hs-var">qn</span></a></span><span> </span><span class="annot"><span class="annottext">SM
</span><a href="#local-6989586621679335283"><span class="hs-identifier hs-var">sm1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SM -&gt; [SRule]
</span><a href="SMType.html#srs"><span class="hs-identifier hs-var hs-var">srs</span></a></span><span> </span><span class="annot"><span class="annottext">SM
</span><a href="#local-6989586621679335283"><span class="hs-identifier hs-var">sm1</span></a></span><span> </span><span class="annot"><span class="annottext">[SRule] -&gt; [SRule] -&gt; [SRule]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">SM -&gt; [SRule]
</span><a href="SMType.html#srs"><span class="hs-identifier hs-var hs-var">srs</span></a></span><span> </span><span class="annot"><span class="annottext">SM
</span><a href="#local-6989586621679335276"><span class="hs-identifier hs-var">sm2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-148"></span><span>
</span><span id="line-149"></span><span>        </span><span class="annot"><a href="#local-6989586621679335272"><span class="hs-identifier hs-type">sm4</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="SMType.html#SM"><span class="hs-identifier hs-type">SM</span></a></span><span>
</span><span id="line-150"></span><span>        </span><span id="local-6989586621679335272"><span class="annot"><span class="annottext">sm4 :: SM
</span><a href="#local-6989586621679335272"><span class="hs-identifier hs-var hs-var">sm4</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-151"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679335271"><span class="annot"><span class="annottext">sm3' :: SM
</span><a href="#local-6989586621679335271"><span class="hs-identifier hs-var hs-var">sm3'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SM -&gt; (State -&gt; Bool) -&gt; Tag -&gt; SM
</span><a href="#local-6989586621679335296"><span class="hs-identifier hs-var">copySM</span></a></span><span> </span><span class="annot"><span class="annottext">SM
</span><a href="#local-6989586621679335273"><span class="hs-identifier hs-var">sm3</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679335270"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335270"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">State -&gt; String
</span><a href="SMType.html#s_idx"><span class="hs-identifier hs-var hs-var">s_idx</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335270"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;3&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Tag
</span><a href="SMType.html#Quote"><span class="hs-identifier hs-var">Quote</span></a></span><span>
</span><span id="line-152"></span><span>            </span><span class="hs-keyword">in</span><span>
</span><span id="line-153"></span><span>            </span><span class="annot"><span class="annottext">[[Y]] -&gt; [Set State] -&gt; [SRule] -&gt; SM
</span><a href="SMType.html#SM"><span class="hs-identifier hs-var">SM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SM -&gt; [[Y]]
</span><a href="SMType.html#yn"><span class="hs-identifier hs-var hs-var">yn</span></a></span><span> </span><span class="annot"><span class="annottext">SM
</span><a href="#local-6989586621679335283"><span class="hs-identifier hs-var">sm1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([Set State] -&gt; Set State) -&gt; [[Set State]] -&gt; [Set State]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">[Set State] -&gt; Set State
forall (f :: * -&gt; *) a. (Foldable f, Ord a) =&gt; f (Set a) -&gt; Set a
</span><span class="hs-identifier hs-var">Set.unions</span></span><span> </span><span class="annot"><span class="annottext">([[Set State]] -&gt; [Set State]) -&gt; [[Set State]] -&gt; [Set State]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[[Set State]] -&gt; [[Set State]]
forall a. [[a]] -&gt; [[a]]
</span><span class="hs-identifier hs-var">transpose</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">SM -&gt; [Set State]
</span><a href="SMType.html#qn"><span class="hs-identifier hs-var hs-var">qn</span></a></span><span> </span><span class="annot"><span class="annottext">SM
</span><a href="#local-6989586621679335273"><span class="hs-identifier hs-var">sm3</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SM -&gt; [Set State]
</span><a href="SMType.html#qn"><span class="hs-identifier hs-var hs-var">qn</span></a></span><span> </span><span class="annot"><span class="annottext">SM
</span><a href="#local-6989586621679335271"><span class="hs-identifier hs-var">sm3'</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SM -&gt; [SRule]
</span><a href="SMType.html#srs"><span class="hs-identifier hs-var hs-var">srs</span></a></span><span> </span><span class="annot"><span class="annottext">SM
</span><a href="#local-6989586621679335273"><span class="hs-identifier hs-var">sm3</span></a></span><span> </span><span class="annot"><span class="annottext">[SRule] -&gt; [SRule] -&gt; [SRule]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">SM -&gt; [SRule]
</span><a href="SMType.html#srs"><span class="hs-identifier hs-var hs-var">srs</span></a></span><span> </span><span class="annot"><span class="annottext">SM
</span><a href="#local-6989586621679335271"><span class="hs-identifier hs-var">sm3'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-154"></span><span>
</span><span id="line-155"></span><span>
</span><span id="line-156"></span><span>        </span><span class="annot"><a href="#local-6989586621679335266"><span class="hs-identifier hs-type">sm4d</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="SMType.html#SM"><span class="hs-identifier hs-type">SM</span></a></span><span>
</span><span id="line-157"></span><span>        </span><span id="local-6989586621679335266"><span class="annot"><span class="annottext">sm4d :: SM
</span><a href="#local-6989586621679335266"><span class="hs-identifier hs-var hs-var">sm4d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SM -&gt; (State -&gt; Bool) -&gt; Tag -&gt; SM
</span><a href="#local-6989586621679335296"><span class="hs-identifier hs-var">copySM</span></a></span><span> </span><span class="annot"><span class="annottext">SM
</span><a href="#local-6989586621679335272"><span class="hs-identifier hs-var">sm4</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; State -&gt; Bool
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Tag
</span><a href="SMType.html#Dash"><span class="hs-identifier hs-var">Dash</span></a></span><span>
</span><span id="line-158"></span><span>
</span><span id="line-159"></span><span>        </span><span class="annot"><a href="#local-6989586621679335264"><span class="hs-identifier hs-type">sm5</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="SMType.html#Y"><span class="hs-identifier hs-type">Y</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="SMType.html#SM"><span class="hs-identifier hs-type">SM</span></a></span><span>
</span><span id="line-160"></span><span>        </span><span id="local-6989586621679335264"><span class="annot"><span class="annottext">sm5 :: [Y] -&gt; SM
</span><a href="#local-6989586621679335264"><span class="hs-identifier hs-var hs-var">sm5</span></a></span></span><span> </span><span id="local-6989586621679335263"><span class="annot"><span class="annottext">[Y]
</span><a href="#local-6989586621679335263"><span class="hs-identifier hs-var">ys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-161"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679335262"><span class="annot"><span class="annottext">st :: [Set State]
</span><a href="#local-6989586621679335262"><span class="hs-identifier hs-var hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([State] -&gt; Set State) -&gt; [[State]] -&gt; [Set State]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">[State] -&gt; Set State
forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">Set.fromList</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335305"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335315"><span class="hs-identifier hs-var">x0</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335312"><span class="hs-identifier hs-var">x4</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335299"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335301"><span class="hs-identifier hs-var">e'</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-162"></span><span>                      </span><span class="annot"><span class="annottext">[State]
</span><a href="#local-6989586621679335422"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="annot"><span class="annottext">[State] -&gt; [State] -&gt; [State]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335414"><span class="hs-identifier hs-var">p0'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335413"><span class="hs-identifier hs-var">p1'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335412"><span class="hs-identifier hs-var">p2'</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-163"></span><span>                      </span><span class="annot"><span class="annottext">[State]
</span><a href="#local-6989586621679335401"><span class="hs-identifier hs-var">qs</span></a></span><span> </span><span class="annot"><span class="annottext">[State] -&gt; [State] -&gt; [State]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335394"><span class="hs-identifier hs-var">q0'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335393"><span class="hs-identifier hs-var">q1'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335392"><span class="hs-identifier hs-var">q2'</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-164"></span><span>                      </span><span class="annot"><span class="annottext">[State]
</span><a href="#local-6989586621679335384"><span class="hs-identifier hs-var">rs</span></a></span><span> </span><span class="annot"><span class="annottext">[State] -&gt; [State] -&gt; [State]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335377"><span class="hs-identifier hs-var">r0'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335376"><span class="hs-identifier hs-var">r1'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335375"><span class="hs-identifier hs-var">r2'</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-165"></span><span>                      </span><span class="annot"><span class="annottext">[State]
</span><a href="#local-6989586621679335367"><span class="hs-identifier hs-var">ss</span></a></span><span> </span><span class="annot"><span class="annottext">[State] -&gt; [State] -&gt; [State]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335360"><span class="hs-identifier hs-var">s0'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335359"><span class="hs-identifier hs-var">s1'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335358"><span class="hs-identifier hs-var">s2'</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-166"></span><span>                      </span><span class="annot"><span class="annottext">[State]
</span><a href="#local-6989586621679335350"><span class="hs-identifier hs-var">ts</span></a></span><span> </span><span class="annot"><span class="annottext">[State] -&gt; [State] -&gt; [State]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335343"><span class="hs-identifier hs-var">t0'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335342"><span class="hs-identifier hs-var">t1'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335341"><span class="hs-identifier hs-var">t2'</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-167"></span><span>                      </span><span class="annot"><span class="annottext">[State]
</span><a href="#local-6989586621679335333"><span class="hs-identifier hs-var">us</span></a></span><span> </span><span class="annot"><span class="annottext">[State] -&gt; [State] -&gt; [State]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335326"><span class="hs-identifier hs-var">u0'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335325"><span class="hs-identifier hs-var">u1'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335324"><span class="hs-identifier hs-var">u2'</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-168"></span><span>                      </span><span class="annot"><span class="annottext">[State]
</span><a href="#local-6989586621679335409"><span class="hs-identifier hs-var">pds</span></a></span><span> </span><span class="annot"><span class="annottext">[State] -&gt; [State] -&gt; [State]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335404"><span class="hs-identifier hs-var">p0'd</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335403"><span class="hs-identifier hs-var">p1'd</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335402"><span class="hs-identifier hs-var">p2'd</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-169"></span><span>                      </span><span class="annot"><span class="annottext">[State]
</span><a href="#local-6989586621679335391"><span class="hs-identifier hs-var">qds</span></a></span><span> </span><span class="annot"><span class="annottext">[State] -&gt; [State] -&gt; [State]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335387"><span class="hs-identifier hs-var">q0'd</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335386"><span class="hs-identifier hs-var">q1'd</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335385"><span class="hs-identifier hs-var">q2'd</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-170"></span><span>                      </span><span class="annot"><span class="annottext">[State]
</span><a href="#local-6989586621679335374"><span class="hs-identifier hs-var">rds</span></a></span><span> </span><span class="annot"><span class="annottext">[State] -&gt; [State] -&gt; [State]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335370"><span class="hs-identifier hs-var">r0'd</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335369"><span class="hs-identifier hs-var">r1'd</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335368"><span class="hs-identifier hs-var">r2'd</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-171"></span><span>                      </span><span class="annot"><span class="annottext">[State]
</span><a href="#local-6989586621679335357"><span class="hs-identifier hs-var">sds</span></a></span><span> </span><span class="annot"><span class="annottext">[State] -&gt; [State] -&gt; [State]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335353"><span class="hs-identifier hs-var">s0'd</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335352"><span class="hs-identifier hs-var">s1'd</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335351"><span class="hs-identifier hs-var">s2'd</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-172"></span><span>                      </span><span class="annot"><span class="annottext">[State]
</span><a href="#local-6989586621679335340"><span class="hs-identifier hs-var">tds</span></a></span><span> </span><span class="annot"><span class="annottext">[State] -&gt; [State] -&gt; [State]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335336"><span class="hs-identifier hs-var">t0'd</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335335"><span class="hs-identifier hs-var">t1'd</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335334"><span class="hs-identifier hs-var">t2'd</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-173"></span><span>                      </span><span class="annot"><span class="annottext">[State]
</span><a href="#local-6989586621679335323"><span class="hs-identifier hs-var">uds</span></a></span><span> </span><span class="annot"><span class="annottext">[State] -&gt; [State] -&gt; [State]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335319"><span class="hs-identifier hs-var">u0'd</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335318"><span class="hs-identifier hs-var">u1'd</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335317"><span class="hs-identifier hs-var">u2'd</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-174"></span><span>                      </span><span class="hs-special">[</span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335297"><span class="hs-identifier hs-var">f'</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-175"></span><span>                </span><span id="local-6989586621679335261"><span class="annot"><span class="annottext">yss :: [[Y]]
</span><a href="#local-6989586621679335261"><span class="hs-identifier hs-var hs-var">yss</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Y]
</span><a href="#local-6989586621679335263"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Y]
</span><a href="#local-6989586621679335263"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="annot"><span class="annottext">Y
</span><a href="SMType.html#Delta"><span class="hs-identifier hs-var">Delta</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="annot"><span class="annottext">Y
</span><a href="SMType.html#Delta"><span class="hs-identifier hs-var">Delta</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="annot"><span class="annottext">Y
</span><a href="SMType.html#Delta"><span class="hs-identifier hs-var">Delta</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="annot"><span class="annottext">Y
</span><a href="SMType.html#Delta"><span class="hs-identifier hs-var">Delta</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="annot"><span class="annottext">Y
</span><a href="SMType.html#Delta"><span class="hs-identifier hs-var">Delta</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="annot"><span class="annottext">Y
</span><a href="SMType.html#Delta"><span class="hs-identifier hs-var">Delta</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="annot"><span class="annottext">Y
</span><a href="SMType.html#Delta"><span class="hs-identifier hs-var">Delta</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="annot"><span class="annottext">Y
</span><a href="SMType.html#Delta"><span class="hs-identifier hs-var">Delta</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="annot"><span class="annottext">Y
</span><a href="SMType.html#Delta"><span class="hs-identifier hs-var">Delta</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="annot"><span class="annottext">Y
</span><a href="SMType.html#Delta"><span class="hs-identifier hs-var">Delta</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-176"></span><span>                </span><span id="local-6989586621679335260"><span class="annot"><span class="annottext">prg :: [SRule]
</span><a href="#local-6989586621679335260"><span class="hs-identifier hs-var hs-var">prg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Y -&gt; SRule) -&gt; [Y] -&gt; [SRule]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679335259"><span class="annot"><span class="annottext">Y
</span><a href="#local-6989586621679335259"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[(Word, Word)] -&gt; SRule
</span><a href="SMType.html#SRule"><span class="hs-identifier hs-var">SRule</span></a></span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335315"><span class="hs-identifier hs-var">x0</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Y -&gt; Smb
</span><a href="SMType.html#SmbY%27"><span class="hs-identifier hs-var">SmbY'</span></a></span><span> </span><span class="annot"><span class="annottext">Y
</span><a href="#local-6989586621679335259"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335315"><span class="hs-identifier hs-var">x0</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Y -&gt; Smb
</span><a href="SMType.html#SmbY"><span class="hs-identifier hs-var">SmbY</span></a></span><span> </span><span class="annot"><span class="annottext">Y
</span><a href="#local-6989586621679335259"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-177"></span><span>                                        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335413"><span class="hs-identifier hs-var">p1'</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335414"><span class="hs-identifier hs-var">p0'</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-178"></span><span>                                        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335393"><span class="hs-identifier hs-var">q1'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335376"><span class="hs-identifier hs-var">r1'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335359"><span class="hs-identifier hs-var">s1'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335342"><span class="hs-identifier hs-var">t1'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335325"><span class="hs-identifier hs-var">u1'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335408"><span class="hs-identifier hs-var">p0d</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-179"></span><span>                                         </span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Y -&gt; Smb
</span><a href="SMType.html#SmbY%27"><span class="hs-identifier hs-var">SmbY'</span></a></span><span> </span><span class="annot"><span class="annottext">Y
</span><a href="SMType.html#Delta"><span class="hs-identifier hs-var">Delta</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335394"><span class="hs-identifier hs-var">q0'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335377"><span class="hs-identifier hs-var">r0'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335360"><span class="hs-identifier hs-var">s0'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335343"><span class="hs-identifier hs-var">t0'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335326"><span class="hs-identifier hs-var">u0'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335407"><span class="hs-identifier hs-var">p1d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Y -&gt; Smb
</span><a href="SMType.html#SmbY"><span class="hs-identifier hs-var">SmbY</span></a></span><span> </span><span class="annot"><span class="annottext">Y
</span><a href="SMType.html#Delta"><span class="hs-identifier hs-var">Delta</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-180"></span><span>                                        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335390"><span class="hs-identifier hs-var">q0d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335373"><span class="hs-identifier hs-var">r0d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335356"><span class="hs-identifier hs-var">s0d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335339"><span class="hs-identifier hs-var">t0d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335322"><span class="hs-identifier hs-var">u0d</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-181"></span><span>                                         </span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335389"><span class="hs-identifier hs-var">q1d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335372"><span class="hs-identifier hs-var">r1d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335355"><span class="hs-identifier hs-var">s1d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335338"><span class="hs-identifier hs-var">t1d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335321"><span class="hs-identifier hs-var">u1d</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-182"></span><span>                                      </span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Y]
</span><a href="#local-6989586621679335423"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-183"></span><span>            </span><span class="hs-keyword">in</span><span>
</span><span id="line-184"></span><span>            </span><span class="annot"><span class="annottext">[[Y]] -&gt; [Set State] -&gt; [SRule] -&gt; SM
</span><a href="SMType.html#SM"><span class="hs-identifier hs-var">SM</span></a></span><span> </span><span class="annot"><span class="annottext">[[Y]]
</span><a href="#local-6989586621679335261"><span class="hs-identifier hs-var">yss</span></a></span><span> </span><span class="annot"><span class="annottext">[Set State]
</span><a href="#local-6989586621679335262"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">[SRule]
</span><a href="#local-6989586621679335260"><span class="hs-identifier hs-var">prg</span></a></span><span>
</span><span id="line-185"></span><span>
</span><span id="line-186"></span><span>        </span><span class="annot"><a href="#local-6989586621679335258"><span class="hs-identifier hs-type">sm6</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="SMType.html#Y"><span class="hs-identifier hs-type">Y</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="SMType.html#SM"><span class="hs-identifier hs-type">SM</span></a></span><span>
</span><span id="line-187"></span><span>        </span><span id="local-6989586621679335258"><span class="annot"><span class="annottext">sm6 :: [Y] -&gt; SM
</span><a href="#local-6989586621679335258"><span class="hs-identifier hs-var hs-var">sm6</span></a></span></span><span> </span><span id="local-6989586621679335257"><span class="annot"><span class="annottext">[Y]
</span><a href="#local-6989586621679335257"><span class="hs-identifier hs-var">ys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-188"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679335256"><span class="annot"><span class="annottext">sm5' :: SM
</span><a href="#local-6989586621679335256"><span class="hs-identifier hs-var hs-var">sm5'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Y] -&gt; SM
</span><a href="#local-6989586621679335264"><span class="hs-identifier hs-var">sm5</span></a></span><span> </span><span class="annot"><span class="annottext">[Y]
</span><a href="#local-6989586621679335257"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-189"></span><span>                </span><span id="local-6989586621679335255"><span class="annot"><span class="annottext">prg :: [SRule]
</span><a href="#local-6989586621679335255"><span class="hs-identifier hs-var hs-var">prg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[(Word, Word)] -&gt; SRule
</span><a href="SMType.html#SRule"><span class="hs-identifier hs-var">SRule</span></a></span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335414"><span class="hs-identifier hs-var">p0'</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335421"><span class="hs-identifier hs-var">p1</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-190"></span><span>                              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335394"><span class="hs-identifier hs-var">q0'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335377"><span class="hs-identifier hs-var">r0'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335360"><span class="hs-identifier hs-var">s0'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335343"><span class="hs-identifier hs-var">t0'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335326"><span class="hs-identifier hs-var">u0'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335403"><span class="hs-identifier hs-var">p1'd</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-191"></span><span>                               </span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335400"><span class="hs-identifier hs-var">q1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335383"><span class="hs-identifier hs-var">r1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335366"><span class="hs-identifier hs-var">s1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335349"><span class="hs-identifier hs-var">t1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335332"><span class="hs-identifier hs-var">u1</span></a></span><span> </span><span class="hs-special">,</span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335408"><span class="hs-identifier hs-var">p0d</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-192"></span><span>                              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335386"><span class="hs-identifier hs-var">q1'd</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335369"><span class="hs-identifier hs-var">r1'd</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335352"><span class="hs-identifier hs-var">s1'd</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335335"><span class="hs-identifier hs-var">t1'd</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335318"><span class="hs-identifier hs-var">u1'd</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-193"></span><span>                               </span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335390"><span class="hs-identifier hs-var">q0d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335373"><span class="hs-identifier hs-var">r0d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335356"><span class="hs-identifier hs-var">s0d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335339"><span class="hs-identifier hs-var">t0d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335322"><span class="hs-identifier hs-var">u0d</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-194"></span><span>            </span><span class="hs-keyword">in</span><span>
</span><span id="line-195"></span><span>            </span><span class="annot"><span class="annottext">[[Y]] -&gt; [Set State] -&gt; [SRule] -&gt; SM
</span><a href="SMType.html#SM"><span class="hs-identifier hs-var">SM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SM -&gt; [[Y]]
</span><a href="SMType.html#yn"><span class="hs-identifier hs-var hs-var">yn</span></a></span><span> </span><span class="annot"><span class="annottext">SM
</span><a href="#local-6989586621679335256"><span class="hs-identifier hs-var">sm5'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SM -&gt; [Set State]
</span><a href="SMType.html#qn"><span class="hs-identifier hs-var hs-var">qn</span></a></span><span> </span><span class="annot"><span class="annottext">SM
</span><a href="#local-6989586621679335256"><span class="hs-identifier hs-var">sm5'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[SRule]
</span><a href="#local-6989586621679335255"><span class="hs-identifier hs-var">prg</span></a></span><span>
</span><span id="line-196"></span><span>
</span><span id="line-197"></span><span>        </span><span class="annot"><a href="#local-6989586621679335254"><span class="hs-identifier hs-type">sm7</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="SMType.html#Y"><span class="hs-identifier hs-type">Y</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="SMType.html#SM"><span class="hs-identifier hs-type">SM</span></a></span><span>
</span><span id="line-198"></span><span>        </span><span id="local-6989586621679335254"><span class="annot"><span class="annottext">sm7 :: [Y] -&gt; SM
</span><a href="#local-6989586621679335254"><span class="hs-identifier hs-var hs-var">sm7</span></a></span></span><span> </span><span id="local-6989586621679335253"><span class="annot"><span class="annottext">[Y]
</span><a href="#local-6989586621679335253"><span class="hs-identifier hs-var">ys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-199"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679335252"><span class="annot"><span class="annottext">sm5' :: SM
</span><a href="#local-6989586621679335252"><span class="hs-identifier hs-var hs-var">sm5'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Y] -&gt; SM
</span><a href="#local-6989586621679335264"><span class="hs-identifier hs-var">sm5</span></a></span><span> </span><span class="annot"><span class="annottext">[Y]
</span><a href="#local-6989586621679335253"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-200"></span><span>                </span><span id="local-6989586621679335251"><span class="annot"><span class="annottext">prg :: [SRule]
</span><a href="#local-6989586621679335251"><span class="hs-identifier hs-var hs-var">prg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[(Word, Word)] -&gt; SRule
</span><a href="SMType.html#SRule"><span class="hs-identifier hs-var">SRule</span></a></span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335305"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335315"><span class="hs-identifier hs-var">x0</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335305"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335312"><span class="hs-identifier hs-var">x4</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-201"></span><span>                              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335421"><span class="hs-identifier hs-var">p1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335400"><span class="hs-identifier hs-var">q1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335383"><span class="hs-identifier hs-var">r1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335366"><span class="hs-identifier hs-var">s1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335349"><span class="hs-identifier hs-var">t1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335332"><span class="hs-identifier hs-var">u1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335408"><span class="hs-identifier hs-var">p0d</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-202"></span><span>                               </span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335418"><span class="hs-identifier hs-var">p4</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335397"><span class="hs-identifier hs-var">q4</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335380"><span class="hs-identifier hs-var">r4</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335363"><span class="hs-identifier hs-var">s4</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335346"><span class="hs-identifier hs-var">t4</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335329"><span class="hs-identifier hs-var">u4</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335406"><span class="hs-identifier hs-var">p4d</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-203"></span><span>                              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335390"><span class="hs-identifier hs-var">q0d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335373"><span class="hs-identifier hs-var">r0d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335356"><span class="hs-identifier hs-var">s0d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335339"><span class="hs-identifier hs-var">t0d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335322"><span class="hs-identifier hs-var">u0d</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-204"></span><span>                               </span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335388"><span class="hs-identifier hs-var">q4d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335371"><span class="hs-identifier hs-var">r4d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335354"><span class="hs-identifier hs-var">s4d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335337"><span class="hs-identifier hs-var">t4d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335320"><span class="hs-identifier hs-var">u4d</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-205"></span><span>
</span><span id="line-206"></span><span>            </span><span class="hs-keyword">in</span><span>
</span><span id="line-207"></span><span>            </span><span class="annot"><span class="annottext">[[Y]] -&gt; [Set State] -&gt; [SRule] -&gt; SM
</span><a href="SMType.html#SM"><span class="hs-identifier hs-var">SM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SM -&gt; [[Y]]
</span><a href="SMType.html#yn"><span class="hs-identifier hs-var hs-var">yn</span></a></span><span> </span><span class="annot"><span class="annottext">SM
</span><a href="#local-6989586621679335252"><span class="hs-identifier hs-var">sm5'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SM -&gt; [Set State]
</span><a href="SMType.html#qn"><span class="hs-identifier hs-var hs-var">qn</span></a></span><span> </span><span class="annot"><span class="annottext">SM
</span><a href="#local-6989586621679335252"><span class="hs-identifier hs-var">sm5'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[SRule]
</span><a href="#local-6989586621679335251"><span class="hs-identifier hs-var">prg</span></a></span><span>
</span><span id="line-208"></span><span>
</span><span id="line-209"></span><span>        </span><span class="annot"><a href="#local-6989586621679335250"><span class="hs-identifier hs-type">sm8</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="SMType.html#Y"><span class="hs-identifier hs-type">Y</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="SMType.html#SM"><span class="hs-identifier hs-type">SM</span></a></span><span>
</span><span id="line-210"></span><span>        </span><span id="local-6989586621679335250"><span class="annot"><span class="annottext">sm8 :: [Y] -&gt; SM
</span><a href="#local-6989586621679335250"><span class="hs-identifier hs-var hs-var">sm8</span></a></span></span><span> </span><span id="local-6989586621679335249"><span class="annot"><span class="annottext">[Y]
</span><a href="#local-6989586621679335249"><span class="hs-identifier hs-var">ys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-211"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679335248"><span class="annot"><span class="annottext">sm5' :: SM
</span><a href="#local-6989586621679335248"><span class="hs-identifier hs-var hs-var">sm5'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Y] -&gt; SM
</span><a href="#local-6989586621679335264"><span class="hs-identifier hs-var">sm5</span></a></span><span> </span><span class="annot"><span class="annottext">[Y]
</span><a href="#local-6989586621679335249"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-212"></span><span>            </span><span class="hs-keyword">in</span><span>
</span><span id="line-213"></span><span>            </span><span class="annot"><span class="annottext">[[Y]] -&gt; [Set State] -&gt; [SRule] -&gt; SM
</span><a href="SMType.html#SM"><span class="hs-identifier hs-var">SM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SM -&gt; [[Y]]
</span><a href="SMType.html#yn"><span class="hs-identifier hs-var hs-var">yn</span></a></span><span> </span><span class="annot"><span class="annottext">SM
</span><a href="#local-6989586621679335248"><span class="hs-identifier hs-var">sm5'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SM -&gt; [Set State]
</span><a href="SMType.html#qn"><span class="hs-identifier hs-var hs-var">qn</span></a></span><span> </span><span class="annot"><span class="annottext">SM
</span><a href="#local-6989586621679335248"><span class="hs-identifier hs-var">sm5'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SM -&gt; [SRule]
</span><a href="SMType.html#srs"><span class="hs-identifier hs-var hs-var">srs</span></a></span><span> </span><span class="annot"><span class="annottext">SM
</span><a href="#local-6989586621679335272"><span class="hs-identifier hs-var">sm4</span></a></span><span> </span><span class="annot"><span class="annottext">[SRule] -&gt; [SRule] -&gt; [SRule]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">SM -&gt; [SRule]
</span><a href="SMType.html#srs"><span class="hs-identifier hs-var hs-var">srs</span></a></span><span> </span><span class="annot"><span class="annottext">SM
</span><a href="#local-6989586621679335248"><span class="hs-identifier hs-var">sm5'</span></a></span><span> </span><span class="annot"><span class="annottext">[SRule] -&gt; [SRule] -&gt; [SRule]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">SM -&gt; [SRule]
</span><a href="SMType.html#srs"><span class="hs-identifier hs-var hs-var">srs</span></a></span><span> </span><span class="annot"><span class="annottext">SM
</span><a href="#local-6989586621679335266"><span class="hs-identifier hs-var">sm4d</span></a></span><span> </span><span class="annot"><span class="annottext">[SRule] -&gt; [SRule] -&gt; [SRule]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">SM -&gt; [SRule]
</span><a href="SMType.html#srs"><span class="hs-identifier hs-var hs-var">srs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Y] -&gt; SM
</span><a href="#local-6989586621679335258"><span class="hs-identifier hs-var">sm6</span></a></span><span> </span><span class="annot"><span class="annottext">[Y]
</span><a href="#local-6989586621679335249"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[SRule] -&gt; [SRule] -&gt; [SRule]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">SM -&gt; [SRule]
</span><a href="SMType.html#srs"><span class="hs-identifier hs-var hs-var">srs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Y] -&gt; SM
</span><a href="#local-6989586621679335254"><span class="hs-identifier hs-var">sm7</span></a></span><span> </span><span class="annot"><span class="annottext">[Y]
</span><a href="#local-6989586621679335249"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-214"></span><span>
</span><span id="line-215"></span><span>        </span><span class="annot"><a href="#local-6989586621679335247"><span class="hs-identifier hs-type">sm9</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="SMType.html#Y"><span class="hs-identifier hs-type">Y</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="SMType.html#SM"><span class="hs-identifier hs-type">SM</span></a></span><span>
</span><span id="line-216"></span><span>        </span><span id="local-6989586621679335247"><span class="annot"><span class="annottext">sm9 :: [Y] -&gt; SM
</span><a href="#local-6989586621679335247"><span class="hs-identifier hs-var hs-var">sm9</span></a></span></span><span> </span><span id="local-6989586621679335246"><span class="annot"><span class="annottext">[Y]
</span><a href="#local-6989586621679335246"><span class="hs-identifier hs-var">ys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-217"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679335245"><span class="annot"><span class="annottext">sm8' :: SM
</span><a href="#local-6989586621679335245"><span class="hs-identifier hs-var hs-var">sm8'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Y] -&gt; SM
</span><a href="#local-6989586621679335250"><span class="hs-identifier hs-var">sm8</span></a></span><span> </span><span class="annot"><span class="annottext">[Y]
</span><a href="#local-6989586621679335246"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-218"></span><span>                </span><span id="local-6989586621679335244"><span class="annot"><span class="annottext">sm8c :: SM
</span><a href="#local-6989586621679335244"><span class="hs-identifier hs-var hs-var">sm8c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SM -&gt; (State -&gt; Bool) -&gt; Tag -&gt; SM
</span><a href="#local-6989586621679335296"><span class="hs-identifier hs-var">copySM</span></a></span><span> </span><span class="annot"><span class="annottext">SM
</span><a href="#local-6989586621679335245"><span class="hs-identifier hs-var">sm8'</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679335243"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335243"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">StateName -&gt; [StateName] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">notElem</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">State -&gt; StateName
</span><a href="SMType.html#s_name"><span class="hs-identifier hs-var hs-var">s_name</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335243"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">StateName
</span><a href="SMType.html#E"><span class="hs-identifier hs-var">E</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">StateName
</span><a href="SMType.html#F"><span class="hs-identifier hs-var">F</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">State -&gt; String
</span><a href="SMType.html#s_idx"><span class="hs-identifier hs-var hs-var">s_idx</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335243"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;4&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Tag
</span><a href="SMType.html#Hat"><span class="hs-identifier hs-var">Hat</span></a></span><span>
</span><span id="line-219"></span><span>            </span><span class="hs-keyword">in</span><span>
</span><span id="line-220"></span><span>            </span><span class="annot"><span class="annottext">[[Y]] -&gt; [Set State] -&gt; [SRule] -&gt; SM
</span><a href="SMType.html#SM"><span class="hs-identifier hs-var">SM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SM -&gt; [[Y]]
</span><a href="SMType.html#yn"><span class="hs-identifier hs-var hs-var">yn</span></a></span><span> </span><span class="annot"><span class="annottext">SM
</span><a href="#local-6989586621679335283"><span class="hs-identifier hs-var">sm1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([Set State] -&gt; Set State) -&gt; [[Set State]] -&gt; [Set State]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">[Set State] -&gt; Set State
forall (f :: * -&gt; *) a. (Foldable f, Ord a) =&gt; f (Set a) -&gt; Set a
</span><span class="hs-identifier hs-var">Set.unions</span></span><span> </span><span class="annot"><span class="annottext">([[Set State]] -&gt; [Set State]) -&gt; [[Set State]] -&gt; [Set State]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[[Set State]] -&gt; [[Set State]]
forall a. [[a]] -&gt; [[a]]
</span><span class="hs-identifier hs-var">transpose</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">SM -&gt; [Set State]
</span><a href="SMType.html#qn"><span class="hs-identifier hs-var hs-var">qn</span></a></span><span> </span><span class="annot"><span class="annottext">SM
</span><a href="#local-6989586621679335245"><span class="hs-identifier hs-var">sm8'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SM -&gt; [Set State]
</span><a href="SMType.html#qn"><span class="hs-identifier hs-var hs-var">qn</span></a></span><span> </span><span class="annot"><span class="annottext">SM
</span><a href="#local-6989586621679335244"><span class="hs-identifier hs-var">sm8c</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SM -&gt; [SRule]
</span><a href="SMType.html#srs"><span class="hs-identifier hs-var hs-var">srs</span></a></span><span> </span><span class="annot"><span class="annottext">SM
</span><a href="#local-6989586621679335245"><span class="hs-identifier hs-var">sm8'</span></a></span><span> </span><span class="annot"><span class="annottext">[SRule] -&gt; [SRule] -&gt; [SRule]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">SM -&gt; [SRule]
</span><a href="SMType.html#srs"><span class="hs-identifier hs-var hs-var">srs</span></a></span><span> </span><span class="annot"><span class="annottext">SM
</span><a href="#local-6989586621679335244"><span class="hs-identifier hs-var">sm8c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-221"></span><span>
</span><span id="line-222"></span><span>        </span><span class="annot"><a href="#local-6989586621679335239"><span class="hs-identifier hs-type">smAlpha</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="SMType.html#SM"><span class="hs-identifier hs-type">SM</span></a></span><span>
</span><span id="line-223"></span><span>        </span><span id="local-6989586621679335239"><span class="annot"><span class="annottext">smAlpha :: SM
</span><a href="#local-6989586621679335239"><span class="hs-identifier hs-var hs-var">smAlpha</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[Y]] -&gt; [Set State] -&gt; [SRule] -&gt; SM
</span><a href="SMType.html#SM"><span class="hs-identifier hs-var">SM</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><span class="annottext">Y
</span><a href="SMType.html#Alpha"><span class="hs-identifier hs-var">Alpha</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="annot"><span class="annottext">Y
</span><a href="SMType.html#Alpha"><span class="hs-identifier hs-var">Alpha</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([State] -&gt; Set State) -&gt; [[State]] -&gt; [Set State]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">[State] -&gt; Set State
forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">Set.fromList</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335305"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335315"><span class="hs-identifier hs-var">x0</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335314"><span class="hs-identifier hs-var">x1</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335313"><span class="hs-identifier hs-var">x2</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335299"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-224"></span><span>                                                                                </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[(Word, Word)] -&gt; SRule
</span><a href="SMType.html#SRule"><span class="hs-identifier hs-var">SRule</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335315"><span class="hs-identifier hs-var">x0</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Y -&gt; Smb
</span><a href="SMType.html#SmbY%27"><span class="hs-identifier hs-var">SmbY'</span></a></span><span> </span><span class="annot"><span class="annottext">Y
</span><a href="SMType.html#Alpha"><span class="hs-identifier hs-var">Alpha</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335315"><span class="hs-identifier hs-var">x0</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Y -&gt; Smb
</span><a href="SMType.html#SmbY"><span class="hs-identifier hs-var">SmbY</span></a></span><span> </span><span class="annot"><span class="annottext">Y
</span><a href="SMType.html#Alpha"><span class="hs-identifier hs-var">Alpha</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-225"></span><span>                                                                                </span><span class="annot"><span class="annottext">[(Word, Word)] -&gt; SRule
</span><a href="SMType.html#SRule"><span class="hs-identifier hs-var">SRule</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335305"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335315"><span class="hs-identifier hs-var">x0</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335305"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335314"><span class="hs-identifier hs-var">x1</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-226"></span><span>                                                                                </span><span class="annot"><span class="annottext">[(Word, Word)] -&gt; SRule
</span><a href="SMType.html#SRule"><span class="hs-identifier hs-var">SRule</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335314"><span class="hs-identifier hs-var">x1</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Y -&gt; Smb
</span><a href="SMType.html#SmbY"><span class="hs-identifier hs-var">SmbY</span></a></span><span> </span><span class="annot"><span class="annottext">Y
</span><a href="SMType.html#Alpha"><span class="hs-identifier hs-var">Alpha</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335314"><span class="hs-identifier hs-var">x1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Y -&gt; Smb
</span><a href="SMType.html#SmbY%27"><span class="hs-identifier hs-var">SmbY'</span></a></span><span> </span><span class="annot"><span class="annottext">Y
</span><a href="SMType.html#Alpha"><span class="hs-identifier hs-var">Alpha</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-227"></span><span>                                                                                </span><span class="annot"><span class="annottext">[(Word, Word)] -&gt; SRule
</span><a href="SMType.html#SRule"><span class="hs-identifier hs-var">SRule</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335314"><span class="hs-identifier hs-var">x1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335299"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335313"><span class="hs-identifier hs-var">x2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335299"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-228"></span><span>
</span><span id="line-229"></span><span>        </span><span class="annot"><a href="#local-6989586621679335237"><span class="hs-identifier hs-type">smOmega</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="SMType.html#SM"><span class="hs-identifier hs-type">SM</span></a></span><span>
</span><span id="line-230"></span><span>        </span><span id="local-6989586621679335237"><span class="annot"><span class="annottext">smOmega :: SM
</span><a href="#local-6989586621679335237"><span class="hs-identifier hs-var hs-var">smOmega</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[Y]] -&gt; [Set State] -&gt; [SRule] -&gt; SM
</span><a href="SMType.html#SM"><span class="hs-identifier hs-var">SM</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><span class="annottext">Y
</span><a href="SMType.html#Omega"><span class="hs-identifier hs-var">Omega</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="annot"><span class="annottext">Y
</span><a href="SMType.html#Omega"><span class="hs-identifier hs-var">Omega</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([State] -&gt; Set State) -&gt; [[State]] -&gt; [Set State]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">[State] -&gt; Set State
forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">Set.fromList</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335301"><span class="hs-identifier hs-var">e'</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335308"><span class="hs-identifier hs-var">x0'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335307"><span class="hs-identifier hs-var">x1'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335306"><span class="hs-identifier hs-var">x2'</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335297"><span class="hs-identifier hs-var">f'</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-231"></span><span>                                                                                </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[(Word, Word)] -&gt; SRule
</span><a href="SMType.html#SRule"><span class="hs-identifier hs-var">SRule</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335308"><span class="hs-identifier hs-var">x0'</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Y -&gt; Smb
</span><a href="SMType.html#SmbY"><span class="hs-identifier hs-var">SmbY</span></a></span><span> </span><span class="annot"><span class="annottext">Y
</span><a href="SMType.html#Omega"><span class="hs-identifier hs-var">Omega</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335308"><span class="hs-identifier hs-var">x0'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Y -&gt; Smb
</span><a href="SMType.html#SmbY%27"><span class="hs-identifier hs-var">SmbY'</span></a></span><span> </span><span class="annot"><span class="annottext">Y
</span><a href="SMType.html#Omega"><span class="hs-identifier hs-var">Omega</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-232"></span><span>                                                                                </span><span class="annot"><span class="annottext">[(Word, Word)] -&gt; SRule
</span><a href="SMType.html#SRule"><span class="hs-identifier hs-var">SRule</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335308"><span class="hs-identifier hs-var">x0'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335297"><span class="hs-identifier hs-var">f'</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335307"><span class="hs-identifier hs-var">x1'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335297"><span class="hs-identifier hs-var">f'</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-233"></span><span>                                                                                </span><span class="annot"><span class="annottext">[(Word, Word)] -&gt; SRule
</span><a href="SMType.html#SRule"><span class="hs-identifier hs-var">SRule</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335307"><span class="hs-identifier hs-var">x1'</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Y -&gt; Smb
</span><a href="SMType.html#SmbY%27"><span class="hs-identifier hs-var">SmbY'</span></a></span><span> </span><span class="annot"><span class="annottext">Y
</span><a href="SMType.html#Omega"><span class="hs-identifier hs-var">Omega</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335307"><span class="hs-identifier hs-var">x1'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Y -&gt; Smb
</span><a href="SMType.html#SmbY"><span class="hs-identifier hs-var">SmbY</span></a></span><span> </span><span class="annot"><span class="annottext">Y
</span><a href="SMType.html#Omega"><span class="hs-identifier hs-var">Omega</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-234"></span><span>                                                                                </span><span class="annot"><span class="annottext">[(Word, Word)] -&gt; SRule
</span><a href="SMType.html#SRule"><span class="hs-identifier hs-var">SRule</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335301"><span class="hs-identifier hs-var">e'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335307"><span class="hs-identifier hs-var">x1'</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335301"><span class="hs-identifier hs-var">e'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679335306"><span class="hs-identifier hs-var">x2'</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-235"></span><span>
</span><span id="line-236"></span><span>   </span><span class="hs-keyword">in</span><span>
</span><span id="line-237"></span><span>      </span><span class="hs-special">[</span><span class="annot"><span class="annottext">SM
</span><a href="#local-6989586621679335272"><span class="hs-identifier hs-var">sm4</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Y] -&gt; SM
</span><a href="#local-6989586621679335247"><span class="hs-identifier hs-var">sm9</span></a></span><span> </span><span class="annot"><span class="annottext">[Y]
</span><a href="#local-6989586621679335423"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SM
</span><a href="#local-6989586621679335239"><span class="hs-identifier hs-var">smAlpha</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SM
</span><a href="#local-6989586621679335237"><span class="hs-identifier hs-var">smOmega</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-238"></span><span>
</span><span id="line-239"></span><span class="annot"><a href="TM2SM.html#genConnectingRules"><span class="hs-identifier hs-type">genConnectingRules</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="SMType.html#TMCMD"><span class="hs-identifier hs-type">TMCMD</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="SMType.html#SRule"><span class="hs-identifier hs-type">SRule</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-240"></span><span id="genConnectingRules"><span class="annot"><span class="annottext">genConnectingRules :: TMCMD -&gt; [SRule]
</span><a href="TM2SM.html#genConnectingRules"><span class="hs-identifier hs-var hs-var">genConnectingRules</span></a></span></span><span> </span><span id="local-6989586621679335234"><span class="annot"><span class="annottext">TMCMD
</span><a href="#local-6989586621679335234"><span class="hs-identifier hs-var">cmd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-241"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="SMType.html#Command"><span class="hs-identifier hs-type">Command</span></a></span><span> </span><span id="local-6989586621679335232"><span class="annot"><span class="annottext">[TapeCommand]
</span><a href="#local-6989586621679335232"><span class="hs-identifier hs-var">command</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TMCMD
</span><a href="#local-6989586621679335234"><span class="hs-identifier hs-var">cmd</span></a></span><span>
</span><span id="line-242"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679335231"><span class="annot"><span class="annottext">k :: Int
</span><a href="#local-6989586621679335231"><span class="hs-identifier hs-var hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TapeCommand] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[TapeCommand]
</span><a href="#local-6989586621679335232"><span class="hs-identifier hs-var">command</span></a></span><span>
</span><span id="line-243"></span><span>
</span><span id="line-244"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679335230"><span class="annot"><span class="annottext">eF0 :: Smb
</span><a href="#local-6989586621679335230"><span class="hs-identifier hs-var hs-var">eF0</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eF"><span class="hs-identifier hs-var">eF</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-245"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679335228"><span class="annot"><span class="annottext">eFl' :: Smb
</span><a href="#local-6989586621679335228"><span class="hs-identifier hs-var hs-var">eFl'</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eF%27"><span class="hs-identifier hs-var">eF'</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335231"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-246"></span><span>
</span><span id="line-247"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679335225"><span class="annot"><span class="annottext">x :: Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335225"><span class="hs-identifier hs-var hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679335224"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335224"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span id="local-6989586621679335223"><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335223"><span class="hs-identifier hs-var">sm</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">(State -&gt; Smb) -&gt; State -&gt; Smb
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StateName
-&gt; String -&gt; Set Tag -&gt; Int -&gt; Maybe TMCMD -&gt; Maybe SMTag -&gt; State
</span><a href="TM2SMHelpers.html#newState"><span class="hs-identifier hs-var">newState</span></a></span><span> </span><span class="annot"><span class="annottext">StateName
</span><a href="SMType.html#X"><span class="hs-identifier hs-var">X</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">Set Tag
</span><a href="TM2SMHelpers.html#eTag"><span class="hs-identifier hs-var">eTag</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335224"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TMCMD -&gt; Maybe TMCMD
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">TMCMD
</span><a href="#local-6989586621679335234"><span class="hs-identifier hs-var">cmd</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SMTag -&gt; Maybe SMTag
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335223"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-248"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679335221"><span class="annot"><span class="annottext">x' :: Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335221"><span class="hs-identifier hs-var hs-var">x'</span></a></span></span><span> </span><span id="local-6989586621679335220"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335220"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span id="local-6989586621679335219"><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335219"><span class="hs-identifier hs-var">sm</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">(State -&gt; Smb) -&gt; State -&gt; Smb
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StateName
-&gt; String -&gt; Set Tag -&gt; Int -&gt; Maybe TMCMD -&gt; Maybe SMTag -&gt; State
</span><a href="TM2SMHelpers.html#newState"><span class="hs-identifier hs-var">newState</span></a></span><span> </span><span class="annot"><span class="annottext">StateName
</span><a href="SMType.html#X"><span class="hs-identifier hs-var">X</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">Set Tag
</span><a href="TM2SMHelpers.html#quoteTag"><span class="hs-identifier hs-var">quoteTag</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335220"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TMCMD -&gt; Maybe TMCMD
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">TMCMD
</span><a href="#local-6989586621679335234"><span class="hs-identifier hs-var">cmd</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SMTag -&gt; Maybe SMTag
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335219"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-249"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679335217"><span class="annot"><span class="annottext">f' :: String -&gt; Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335217"><span class="hs-identifier hs-var hs-var">f'</span></a></span></span><span> </span><span id="local-6989586621679335216"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679335216"><span class="hs-identifier hs-var">idx</span></a></span></span><span> </span><span id="local-6989586621679335215"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335215"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span id="local-6989586621679335214"><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335214"><span class="hs-identifier hs-var">sm</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">(State -&gt; Smb) -&gt; State -&gt; Smb
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StateName
-&gt; String -&gt; Set Tag -&gt; Int -&gt; Maybe TMCMD -&gt; Maybe SMTag -&gt; State
</span><a href="TM2SMHelpers.html#newState"><span class="hs-identifier hs-var">newState</span></a></span><span> </span><span class="annot"><span class="annottext">StateName
</span><a href="SMType.html#F"><span class="hs-identifier hs-var">F</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679335216"><span class="hs-identifier hs-var">idx</span></a></span><span> </span><span class="annot"><span class="annottext">Set Tag
</span><a href="TM2SMHelpers.html#quoteTag"><span class="hs-identifier hs-var">quoteTag</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335215"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TMCMD -&gt; Maybe TMCMD
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">TMCMD
</span><a href="#local-6989586621679335234"><span class="hs-identifier hs-var">cmd</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SMTag -&gt; Maybe SMTag
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335214"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-250"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679335213"><span class="annot"><span class="annottext">f :: String -&gt; Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335213"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679335212"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679335212"><span class="hs-identifier hs-var">idx</span></a></span></span><span> </span><span id="local-6989586621679335211"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335211"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span id="local-6989586621679335210"><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335210"><span class="hs-identifier hs-var">sm</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">(State -&gt; Smb) -&gt; State -&gt; Smb
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StateName
-&gt; String -&gt; Set Tag -&gt; Int -&gt; Maybe TMCMD -&gt; Maybe SMTag -&gt; State
</span><a href="TM2SMHelpers.html#newState"><span class="hs-identifier hs-var">newState</span></a></span><span> </span><span class="annot"><span class="annottext">StateName
</span><a href="SMType.html#F"><span class="hs-identifier hs-var">F</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679335212"><span class="hs-identifier hs-var">idx</span></a></span><span> </span><span class="annot"><span class="annottext">Set Tag
</span><a href="TM2SMHelpers.html#eTag"><span class="hs-identifier hs-var">eTag</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335211"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TMCMD -&gt; Maybe TMCMD
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">TMCMD
</span><a href="#local-6989586621679335234"><span class="hs-identifier hs-var">cmd</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SMTag -&gt; Maybe SMTag
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335210"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-251"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679335209"><span class="annot"><span class="annottext">fl' :: SMTag -&gt; Smb
</span><a href="#local-6989586621679335209"><span class="hs-identifier hs-var hs-var">fl'</span></a></span></span><span> </span><span id="local-6989586621679335208"><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335208"><span class="hs-identifier hs-var">sm</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">(State -&gt; Smb) -&gt; State -&gt; Smb
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StateName
-&gt; String -&gt; Set Tag -&gt; Int -&gt; Maybe TMCMD -&gt; Maybe SMTag -&gt; State
</span><a href="TM2SMHelpers.html#newState"><span class="hs-identifier hs-var">newState</span></a></span><span> </span><span class="annot"><span class="annottext">StateName
</span><a href="SMType.html#F"><span class="hs-identifier hs-var">F</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">Set Tag
</span><a href="TM2SMHelpers.html#quoteTag"><span class="hs-identifier hs-var">quoteTag</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335231"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TMCMD -&gt; Maybe TMCMD
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">TMCMD
</span><a href="#local-6989586621679335234"><span class="hs-identifier hs-var">cmd</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SMTag -&gt; Maybe SMTag
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335208"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-252"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679335207"><span class="annot"><span class="annottext">f0 :: SMTag -&gt; Smb
</span><a href="#local-6989586621679335207"><span class="hs-identifier hs-var hs-var">f0</span></a></span></span><span> </span><span id="local-6989586621679335206"><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335206"><span class="hs-identifier hs-var">sm</span></a></span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">(State -&gt; Smb) -&gt; State -&gt; Smb
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StateName
-&gt; String -&gt; Set Tag -&gt; Int -&gt; Maybe TMCMD -&gt; Maybe SMTag -&gt; State
</span><a href="TM2SMHelpers.html#newState"><span class="hs-identifier hs-var">newState</span></a></span><span> </span><span class="annot"><span class="annottext">StateName
</span><a href="SMType.html#F"><span class="hs-identifier hs-var">F</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">Set Tag
</span><a href="TM2SMHelpers.html#eTag"><span class="hs-identifier hs-var">eTag</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TMCMD -&gt; Maybe TMCMD
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">TMCMD
</span><a href="#local-6989586621679335234"><span class="hs-identifier hs-var">cmd</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SMTag -&gt; Maybe SMTag
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335206"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-253"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679335205"><span class="annot"><span class="annottext">e' :: Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335205"><span class="hs-identifier hs-var hs-var">e'</span></a></span></span><span> </span><span id="local-6989586621679335204"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335204"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span id="local-6989586621679335203"><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335203"><span class="hs-identifier hs-var">sm</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">(State -&gt; Smb) -&gt; State -&gt; Smb
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StateName
-&gt; String -&gt; Set Tag -&gt; Int -&gt; Maybe TMCMD -&gt; Maybe SMTag -&gt; State
</span><a href="TM2SMHelpers.html#newState"><span class="hs-identifier hs-var">newState</span></a></span><span> </span><span class="annot"><span class="annottext">StateName
</span><a href="SMType.html#E"><span class="hs-identifier hs-var">E</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">Set Tag
</span><a href="TM2SMHelpers.html#quoteTag"><span class="hs-identifier hs-var">quoteTag</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335204"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TMCMD -&gt; Maybe TMCMD
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">TMCMD
</span><a href="#local-6989586621679335234"><span class="hs-identifier hs-var">cmd</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SMTag -&gt; Maybe SMTag
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335203"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-254"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679335202"><span class="annot"><span class="annottext">e :: Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335202"><span class="hs-identifier hs-var hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679335201"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335201"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span id="local-6989586621679335200"><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335200"><span class="hs-identifier hs-var">sm</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">(State -&gt; Smb) -&gt; State -&gt; Smb
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StateName
-&gt; String -&gt; Set Tag -&gt; Int -&gt; Maybe TMCMD -&gt; Maybe SMTag -&gt; State
</span><a href="TM2SMHelpers.html#newState"><span class="hs-identifier hs-var">newState</span></a></span><span> </span><span class="annot"><span class="annottext">StateName
</span><a href="SMType.html#E"><span class="hs-identifier hs-var">E</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">Set Tag
</span><a href="TM2SMHelpers.html#eTag"><span class="hs-identifier hs-var">eTag</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335201"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TMCMD -&gt; Maybe TMCMD
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">TMCMD
</span><a href="#local-6989586621679335234"><span class="hs-identifier hs-var">cmd</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SMTag -&gt; Maybe SMTag
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335200"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-255"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679335199"><span class="annot"><span class="annottext">p :: Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335199"><span class="hs-identifier hs-var hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679335198"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335198"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span id="local-6989586621679335197"><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335197"><span class="hs-identifier hs-var">sm</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">(State -&gt; Smb) -&gt; State -&gt; Smb
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StateName
-&gt; String -&gt; Set Tag -&gt; Int -&gt; Maybe TMCMD -&gt; Maybe SMTag -&gt; State
</span><a href="TM2SMHelpers.html#newState"><span class="hs-identifier hs-var">newState</span></a></span><span> </span><span class="annot"><span class="annottext">StateName
</span><a href="SMType.html#P"><span class="hs-identifier hs-var">P</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">Set Tag
</span><a href="TM2SMHelpers.html#eTag"><span class="hs-identifier hs-var">eTag</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335198"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TMCMD -&gt; Maybe TMCMD
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">TMCMD
</span><a href="#local-6989586621679335234"><span class="hs-identifier hs-var">cmd</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SMTag -&gt; Maybe SMTag
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335197"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-256"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679335196"><span class="annot"><span class="annottext">q :: Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335196"><span class="hs-identifier hs-var hs-var">q</span></a></span></span><span> </span><span id="local-6989586621679335195"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335195"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span id="local-6989586621679335194"><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335194"><span class="hs-identifier hs-var">sm</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">(State -&gt; Smb) -&gt; State -&gt; Smb
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StateName
-&gt; String -&gt; Set Tag -&gt; Int -&gt; Maybe TMCMD -&gt; Maybe SMTag -&gt; State
</span><a href="TM2SMHelpers.html#newState"><span class="hs-identifier hs-var">newState</span></a></span><span> </span><span class="annot"><span class="annottext">StateName
</span><a href="SMType.html#Q"><span class="hs-identifier hs-var">Q</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">Set Tag
</span><a href="TM2SMHelpers.html#eTag"><span class="hs-identifier hs-var">eTag</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335195"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TMCMD -&gt; Maybe TMCMD
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">TMCMD
</span><a href="#local-6989586621679335234"><span class="hs-identifier hs-var">cmd</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SMTag -&gt; Maybe SMTag
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335194"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-257"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679335193"><span class="annot"><span class="annottext">r :: Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335193"><span class="hs-identifier hs-var hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679335192"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335192"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span id="local-6989586621679335191"><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335191"><span class="hs-identifier hs-var">sm</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">(State -&gt; Smb) -&gt; State -&gt; Smb
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StateName
-&gt; String -&gt; Set Tag -&gt; Int -&gt; Maybe TMCMD -&gt; Maybe SMTag -&gt; State
</span><a href="TM2SMHelpers.html#newState"><span class="hs-identifier hs-var">newState</span></a></span><span> </span><span class="annot"><span class="annottext">StateName
</span><a href="SMType.html#R"><span class="hs-identifier hs-var">R</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">Set Tag
</span><a href="TM2SMHelpers.html#eTag"><span class="hs-identifier hs-var">eTag</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335192"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TMCMD -&gt; Maybe TMCMD
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">TMCMD
</span><a href="#local-6989586621679335234"><span class="hs-identifier hs-var">cmd</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SMTag -&gt; Maybe SMTag
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335191"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-258"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679335190"><span class="annot"><span class="annottext">s :: Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335190"><span class="hs-identifier hs-var hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679335189"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335189"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span id="local-6989586621679335188"><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335188"><span class="hs-identifier hs-var">sm</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">(State -&gt; Smb) -&gt; State -&gt; Smb
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StateName
-&gt; String -&gt; Set Tag -&gt; Int -&gt; Maybe TMCMD -&gt; Maybe SMTag -&gt; State
</span><a href="TM2SMHelpers.html#newState"><span class="hs-identifier hs-var">newState</span></a></span><span> </span><span class="annot"><span class="annottext">StateName
</span><a href="SMType.html#S"><span class="hs-identifier hs-var">S</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">Set Tag
</span><a href="TM2SMHelpers.html#eTag"><span class="hs-identifier hs-var">eTag</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335189"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TMCMD -&gt; Maybe TMCMD
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">TMCMD
</span><a href="#local-6989586621679335234"><span class="hs-identifier hs-var">cmd</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SMTag -&gt; Maybe SMTag
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335188"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-259"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679335187"><span class="annot"><span class="annottext">t :: Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335187"><span class="hs-identifier hs-var hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679335186"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335186"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span id="local-6989586621679335185"><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335185"><span class="hs-identifier hs-var">sm</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">(State -&gt; Smb) -&gt; State -&gt; Smb
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StateName
-&gt; String -&gt; Set Tag -&gt; Int -&gt; Maybe TMCMD -&gt; Maybe SMTag -&gt; State
</span><a href="TM2SMHelpers.html#newState"><span class="hs-identifier hs-var">newState</span></a></span><span> </span><span class="annot"><span class="annottext">StateName
</span><a href="SMType.html#T"><span class="hs-identifier hs-var">T</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">Set Tag
</span><a href="TM2SMHelpers.html#eTag"><span class="hs-identifier hs-var">eTag</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335186"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TMCMD -&gt; Maybe TMCMD
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">TMCMD
</span><a href="#local-6989586621679335234"><span class="hs-identifier hs-var">cmd</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SMTag -&gt; Maybe SMTag
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335185"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-260"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679335184"><span class="annot"><span class="annottext">u :: Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335184"><span class="hs-identifier hs-var hs-var">u</span></a></span></span><span> </span><span id="local-6989586621679335183"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335183"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span id="local-6989586621679335182"><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335182"><span class="hs-identifier hs-var">sm</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">(State -&gt; Smb) -&gt; State -&gt; Smb
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StateName
-&gt; String -&gt; Set Tag -&gt; Int -&gt; Maybe TMCMD -&gt; Maybe SMTag -&gt; State
</span><a href="TM2SMHelpers.html#newState"><span class="hs-identifier hs-var">newState</span></a></span><span> </span><span class="annot"><span class="annottext">StateName
</span><a href="SMType.html#U"><span class="hs-identifier hs-var">U</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">Set Tag
</span><a href="TM2SMHelpers.html#eTag"><span class="hs-identifier hs-var">eTag</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335183"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TMCMD -&gt; Maybe TMCMD
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">TMCMD
</span><a href="#local-6989586621679335234"><span class="hs-identifier hs-var">cmd</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SMTag -&gt; Maybe SMTag
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335182"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-261"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679335181"><span class="annot"><span class="annottext">pd :: Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335181"><span class="hs-identifier hs-var hs-var">pd</span></a></span></span><span> </span><span id="local-6989586621679335180"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335180"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span id="local-6989586621679335179"><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335179"><span class="hs-identifier hs-var">sm</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">(State -&gt; Smb) -&gt; State -&gt; Smb
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StateName
-&gt; String -&gt; Set Tag -&gt; Int -&gt; Maybe TMCMD -&gt; Maybe SMTag -&gt; State
</span><a href="TM2SMHelpers.html#newState"><span class="hs-identifier hs-var">newState</span></a></span><span> </span><span class="annot"><span class="annottext">StateName
</span><a href="SMType.html#P"><span class="hs-identifier hs-var">P</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">Set Tag
</span><a href="TM2SMHelpers.html#dashTag"><span class="hs-identifier hs-var">dashTag</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335180"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TMCMD -&gt; Maybe TMCMD
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">TMCMD
</span><a href="#local-6989586621679335234"><span class="hs-identifier hs-var">cmd</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SMTag -&gt; Maybe SMTag
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335179"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-262"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679335177"><span class="annot"><span class="annottext">qd :: Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335177"><span class="hs-identifier hs-var hs-var">qd</span></a></span></span><span> </span><span id="local-6989586621679335176"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335176"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span id="local-6989586621679335175"><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335175"><span class="hs-identifier hs-var">sm</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">(State -&gt; Smb) -&gt; State -&gt; Smb
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StateName
-&gt; String -&gt; Set Tag -&gt; Int -&gt; Maybe TMCMD -&gt; Maybe SMTag -&gt; State
</span><a href="TM2SMHelpers.html#newState"><span class="hs-identifier hs-var">newState</span></a></span><span> </span><span class="annot"><span class="annottext">StateName
</span><a href="SMType.html#Q"><span class="hs-identifier hs-var">Q</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">Set Tag
</span><a href="TM2SMHelpers.html#dashTag"><span class="hs-identifier hs-var">dashTag</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335176"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TMCMD -&gt; Maybe TMCMD
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">TMCMD
</span><a href="#local-6989586621679335234"><span class="hs-identifier hs-var">cmd</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SMTag -&gt; Maybe SMTag
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335175"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-263"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679335174"><span class="annot"><span class="annottext">rd :: Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335174"><span class="hs-identifier hs-var hs-var">rd</span></a></span></span><span> </span><span id="local-6989586621679335173"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335173"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span id="local-6989586621679335172"><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335172"><span class="hs-identifier hs-var">sm</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">(State -&gt; Smb) -&gt; State -&gt; Smb
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StateName
-&gt; String -&gt; Set Tag -&gt; Int -&gt; Maybe TMCMD -&gt; Maybe SMTag -&gt; State
</span><a href="TM2SMHelpers.html#newState"><span class="hs-identifier hs-var">newState</span></a></span><span> </span><span class="annot"><span class="annottext">StateName
</span><a href="SMType.html#R"><span class="hs-identifier hs-var">R</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">Set Tag
</span><a href="TM2SMHelpers.html#dashTag"><span class="hs-identifier hs-var">dashTag</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335173"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TMCMD -&gt; Maybe TMCMD
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">TMCMD
</span><a href="#local-6989586621679335234"><span class="hs-identifier hs-var">cmd</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SMTag -&gt; Maybe SMTag
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335172"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-264"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679335171"><span class="annot"><span class="annottext">sd :: Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335171"><span class="hs-identifier hs-var hs-var">sd</span></a></span></span><span> </span><span id="local-6989586621679335170"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335170"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span id="local-6989586621679335169"><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335169"><span class="hs-identifier hs-var">sm</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">(State -&gt; Smb) -&gt; State -&gt; Smb
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StateName
-&gt; String -&gt; Set Tag -&gt; Int -&gt; Maybe TMCMD -&gt; Maybe SMTag -&gt; State
</span><a href="TM2SMHelpers.html#newState"><span class="hs-identifier hs-var">newState</span></a></span><span> </span><span class="annot"><span class="annottext">StateName
</span><a href="SMType.html#S"><span class="hs-identifier hs-var">S</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">Set Tag
</span><a href="TM2SMHelpers.html#dashTag"><span class="hs-identifier hs-var">dashTag</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335170"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TMCMD -&gt; Maybe TMCMD
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">TMCMD
</span><a href="#local-6989586621679335234"><span class="hs-identifier hs-var">cmd</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SMTag -&gt; Maybe SMTag
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335169"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-265"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679335168"><span class="annot"><span class="annottext">td :: Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335168"><span class="hs-identifier hs-var hs-var">td</span></a></span></span><span> </span><span id="local-6989586621679335167"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335167"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span id="local-6989586621679335166"><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335166"><span class="hs-identifier hs-var">sm</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">(State -&gt; Smb) -&gt; State -&gt; Smb
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StateName
-&gt; String -&gt; Set Tag -&gt; Int -&gt; Maybe TMCMD -&gt; Maybe SMTag -&gt; State
</span><a href="TM2SMHelpers.html#newState"><span class="hs-identifier hs-var">newState</span></a></span><span> </span><span class="annot"><span class="annottext">StateName
</span><a href="SMType.html#T"><span class="hs-identifier hs-var">T</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">Set Tag
</span><a href="TM2SMHelpers.html#dashTag"><span class="hs-identifier hs-var">dashTag</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335167"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TMCMD -&gt; Maybe TMCMD
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">TMCMD
</span><a href="#local-6989586621679335234"><span class="hs-identifier hs-var">cmd</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SMTag -&gt; Maybe SMTag
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335166"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-266"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679335165"><span class="annot"><span class="annottext">ud :: Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335165"><span class="hs-identifier hs-var hs-var">ud</span></a></span></span><span> </span><span id="local-6989586621679335164"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335164"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span id="local-6989586621679335163"><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335163"><span class="hs-identifier hs-var">sm</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">(State -&gt; Smb) -&gt; State -&gt; Smb
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StateName
-&gt; String -&gt; Set Tag -&gt; Int -&gt; Maybe TMCMD -&gt; Maybe SMTag -&gt; State
</span><a href="TM2SMHelpers.html#newState"><span class="hs-identifier hs-var">newState</span></a></span><span> </span><span class="annot"><span class="annottext">StateName
</span><a href="SMType.html#U"><span class="hs-identifier hs-var">U</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">Set Tag
</span><a href="TM2SMHelpers.html#dashTag"><span class="hs-identifier hs-var">dashTag</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335164"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TMCMD -&gt; Maybe TMCMD
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">TMCMD
</span><a href="#local-6989586621679335234"><span class="hs-identifier hs-var">cmd</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SMTag -&gt; Maybe SMTag
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335163"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-267"></span><span>
</span><span id="line-268"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679335162"><span class="annot"><span class="annottext">pIndex :: String -&gt; Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335162"><span class="hs-identifier hs-var hs-var">pIndex</span></a></span></span><span> </span><span id="local-6989586621679335161"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679335161"><span class="hs-identifier hs-var">index</span></a></span></span><span> </span><span id="local-6989586621679335160"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335160"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span id="local-6989586621679335159"><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335159"><span class="hs-identifier hs-var">sm</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">(State -&gt; Smb) -&gt; State -&gt; Smb
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StateName
-&gt; String -&gt; Set Tag -&gt; Int -&gt; Maybe TMCMD -&gt; Maybe SMTag -&gt; State
</span><a href="TM2SMHelpers.html#newState"><span class="hs-identifier hs-var">newState</span></a></span><span> </span><span class="annot"><span class="annottext">StateName
</span><a href="SMType.html#P"><span class="hs-identifier hs-var">P</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679335161"><span class="hs-identifier hs-var">index</span></a></span><span> </span><span class="annot"><span class="annottext">Set Tag
</span><a href="TM2SMHelpers.html#eTag"><span class="hs-identifier hs-var">eTag</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335160"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TMCMD -&gt; Maybe TMCMD
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">TMCMD
</span><a href="#local-6989586621679335234"><span class="hs-identifier hs-var">cmd</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SMTag -&gt; Maybe SMTag
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335159"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-269"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679335158"><span class="annot"><span class="annottext">qIndex :: String -&gt; Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335158"><span class="hs-identifier hs-var hs-var">qIndex</span></a></span></span><span> </span><span id="local-6989586621679335157"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679335157"><span class="hs-identifier hs-var">index</span></a></span></span><span> </span><span id="local-6989586621679335156"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335156"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span id="local-6989586621679335155"><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335155"><span class="hs-identifier hs-var">sm</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">(State -&gt; Smb) -&gt; State -&gt; Smb
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StateName
-&gt; String -&gt; Set Tag -&gt; Int -&gt; Maybe TMCMD -&gt; Maybe SMTag -&gt; State
</span><a href="TM2SMHelpers.html#newState"><span class="hs-identifier hs-var">newState</span></a></span><span> </span><span class="annot"><span class="annottext">StateName
</span><a href="SMType.html#Q"><span class="hs-identifier hs-var">Q</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679335157"><span class="hs-identifier hs-var">index</span></a></span><span> </span><span class="annot"><span class="annottext">Set Tag
</span><a href="TM2SMHelpers.html#eTag"><span class="hs-identifier hs-var">eTag</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335156"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TMCMD -&gt; Maybe TMCMD
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">TMCMD
</span><a href="#local-6989586621679335234"><span class="hs-identifier hs-var">cmd</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SMTag -&gt; Maybe SMTag
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335155"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-270"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679335154"><span class="annot"><span class="annottext">rIndex :: String -&gt; Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335154"><span class="hs-identifier hs-var hs-var">rIndex</span></a></span></span><span> </span><span id="local-6989586621679335153"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679335153"><span class="hs-identifier hs-var">index</span></a></span></span><span> </span><span id="local-6989586621679335152"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335152"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span id="local-6989586621679335151"><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335151"><span class="hs-identifier hs-var">sm</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">(State -&gt; Smb) -&gt; State -&gt; Smb
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StateName
-&gt; String -&gt; Set Tag -&gt; Int -&gt; Maybe TMCMD -&gt; Maybe SMTag -&gt; State
</span><a href="TM2SMHelpers.html#newState"><span class="hs-identifier hs-var">newState</span></a></span><span> </span><span class="annot"><span class="annottext">StateName
</span><a href="SMType.html#R"><span class="hs-identifier hs-var">R</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679335153"><span class="hs-identifier hs-var">index</span></a></span><span> </span><span class="annot"><span class="annottext">Set Tag
</span><a href="TM2SMHelpers.html#eTag"><span class="hs-identifier hs-var">eTag</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335152"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TMCMD -&gt; Maybe TMCMD
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">TMCMD
</span><a href="#local-6989586621679335234"><span class="hs-identifier hs-var">cmd</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SMTag -&gt; Maybe SMTag
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335151"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-271"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679335150"><span class="annot"><span class="annottext">sIndex :: String -&gt; Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335150"><span class="hs-identifier hs-var hs-var">sIndex</span></a></span></span><span> </span><span id="local-6989586621679335149"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679335149"><span class="hs-identifier hs-var">index</span></a></span></span><span> </span><span id="local-6989586621679335148"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335148"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span id="local-6989586621679335147"><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335147"><span class="hs-identifier hs-var">sm</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">(State -&gt; Smb) -&gt; State -&gt; Smb
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StateName
-&gt; String -&gt; Set Tag -&gt; Int -&gt; Maybe TMCMD -&gt; Maybe SMTag -&gt; State
</span><a href="TM2SMHelpers.html#newState"><span class="hs-identifier hs-var">newState</span></a></span><span> </span><span class="annot"><span class="annottext">StateName
</span><a href="SMType.html#S"><span class="hs-identifier hs-var">S</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679335149"><span class="hs-identifier hs-var">index</span></a></span><span> </span><span class="annot"><span class="annottext">Set Tag
</span><a href="TM2SMHelpers.html#eTag"><span class="hs-identifier hs-var">eTag</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335148"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TMCMD -&gt; Maybe TMCMD
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">TMCMD
</span><a href="#local-6989586621679335234"><span class="hs-identifier hs-var">cmd</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SMTag -&gt; Maybe SMTag
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335147"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-272"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679335146"><span class="annot"><span class="annottext">tIndex :: String -&gt; Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335146"><span class="hs-identifier hs-var hs-var">tIndex</span></a></span></span><span> </span><span id="local-6989586621679335145"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679335145"><span class="hs-identifier hs-var">index</span></a></span></span><span> </span><span id="local-6989586621679335144"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335144"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span id="local-6989586621679335143"><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335143"><span class="hs-identifier hs-var">sm</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">(State -&gt; Smb) -&gt; State -&gt; Smb
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StateName
-&gt; String -&gt; Set Tag -&gt; Int -&gt; Maybe TMCMD -&gt; Maybe SMTag -&gt; State
</span><a href="TM2SMHelpers.html#newState"><span class="hs-identifier hs-var">newState</span></a></span><span> </span><span class="annot"><span class="annottext">StateName
</span><a href="SMType.html#T"><span class="hs-identifier hs-var">T</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679335145"><span class="hs-identifier hs-var">index</span></a></span><span> </span><span class="annot"><span class="annottext">Set Tag
</span><a href="TM2SMHelpers.html#eTag"><span class="hs-identifier hs-var">eTag</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335144"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TMCMD -&gt; Maybe TMCMD
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">TMCMD
</span><a href="#local-6989586621679335234"><span class="hs-identifier hs-var">cmd</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SMTag -&gt; Maybe SMTag
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335143"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-273"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679335142"><span class="annot"><span class="annottext">uIndex :: String -&gt; Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335142"><span class="hs-identifier hs-var hs-var">uIndex</span></a></span></span><span> </span><span id="local-6989586621679335141"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679335141"><span class="hs-identifier hs-var">index</span></a></span></span><span> </span><span id="local-6989586621679335140"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335140"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span id="local-6989586621679335139"><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335139"><span class="hs-identifier hs-var">sm</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">(State -&gt; Smb) -&gt; State -&gt; Smb
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StateName
-&gt; String -&gt; Set Tag -&gt; Int -&gt; Maybe TMCMD -&gt; Maybe SMTag -&gt; State
</span><a href="TM2SMHelpers.html#newState"><span class="hs-identifier hs-var">newState</span></a></span><span> </span><span class="annot"><span class="annottext">StateName
</span><a href="SMType.html#U"><span class="hs-identifier hs-var">U</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679335141"><span class="hs-identifier hs-var">index</span></a></span><span> </span><span class="annot"><span class="annottext">Set Tag
</span><a href="TM2SMHelpers.html#eTag"><span class="hs-identifier hs-var">eTag</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335140"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TMCMD -&gt; Maybe TMCMD
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">TMCMD
</span><a href="#local-6989586621679335234"><span class="hs-identifier hs-var">cmd</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SMTag -&gt; Maybe SMTag
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335139"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-274"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679335138"><span class="annot"><span class="annottext">xIndex :: String -&gt; Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335138"><span class="hs-identifier hs-var hs-var">xIndex</span></a></span></span><span> </span><span id="local-6989586621679335137"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679335137"><span class="hs-identifier hs-var">index</span></a></span></span><span> </span><span id="local-6989586621679335136"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335136"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span id="local-6989586621679335135"><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335135"><span class="hs-identifier hs-var">sm</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">(State -&gt; Smb) -&gt; State -&gt; Smb
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StateName
-&gt; String -&gt; Set Tag -&gt; Int -&gt; Maybe TMCMD -&gt; Maybe SMTag -&gt; State
</span><a href="TM2SMHelpers.html#newState"><span class="hs-identifier hs-var">newState</span></a></span><span> </span><span class="annot"><span class="annottext">StateName
</span><a href="SMType.html#X"><span class="hs-identifier hs-var">X</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679335137"><span class="hs-identifier hs-var">index</span></a></span><span> </span><span class="annot"><span class="annottext">Set Tag
</span><a href="TM2SMHelpers.html#eTag"><span class="hs-identifier hs-var">eTag</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335136"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TMCMD -&gt; Maybe TMCMD
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">TMCMD
</span><a href="#local-6989586621679335234"><span class="hs-identifier hs-var">cmd</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SMTag -&gt; Maybe SMTag
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335135"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-275"></span><span>
</span><span id="line-276"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679335134"><span class="annot"><span class="annottext">pIndex' :: String -&gt; Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335134"><span class="hs-identifier hs-var hs-var">pIndex'</span></a></span></span><span> </span><span id="local-6989586621679335133"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679335133"><span class="hs-identifier hs-var">index</span></a></span></span><span> </span><span id="local-6989586621679335132"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335132"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span id="local-6989586621679335131"><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335131"><span class="hs-identifier hs-var">sm</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">(State -&gt; Smb) -&gt; State -&gt; Smb
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StateName
-&gt; String -&gt; Set Tag -&gt; Int -&gt; Maybe TMCMD -&gt; Maybe SMTag -&gt; State
</span><a href="TM2SMHelpers.html#newState"><span class="hs-identifier hs-var">newState</span></a></span><span> </span><span class="annot"><span class="annottext">StateName
</span><a href="SMType.html#P"><span class="hs-identifier hs-var">P</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679335133"><span class="hs-identifier hs-var">index</span></a></span><span> </span><span class="annot"><span class="annottext">Set Tag
</span><a href="TM2SMHelpers.html#quoteTag"><span class="hs-identifier hs-var">quoteTag</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335132"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TMCMD -&gt; Maybe TMCMD
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">TMCMD
</span><a href="#local-6989586621679335234"><span class="hs-identifier hs-var">cmd</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SMTag -&gt; Maybe SMTag
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335131"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-277"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679335130"><span class="annot"><span class="annottext">qIndex' :: String -&gt; Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335130"><span class="hs-identifier hs-var hs-var">qIndex'</span></a></span></span><span> </span><span id="local-6989586621679335129"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679335129"><span class="hs-identifier hs-var">index</span></a></span></span><span> </span><span id="local-6989586621679335128"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335128"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span id="local-6989586621679335127"><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335127"><span class="hs-identifier hs-var">sm</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">(State -&gt; Smb) -&gt; State -&gt; Smb
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StateName
-&gt; String -&gt; Set Tag -&gt; Int -&gt; Maybe TMCMD -&gt; Maybe SMTag -&gt; State
</span><a href="TM2SMHelpers.html#newState"><span class="hs-identifier hs-var">newState</span></a></span><span> </span><span class="annot"><span class="annottext">StateName
</span><a href="SMType.html#Q"><span class="hs-identifier hs-var">Q</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679335129"><span class="hs-identifier hs-var">index</span></a></span><span> </span><span class="annot"><span class="annottext">Set Tag
</span><a href="TM2SMHelpers.html#quoteTag"><span class="hs-identifier hs-var">quoteTag</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335128"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TMCMD -&gt; Maybe TMCMD
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">TMCMD
</span><a href="#local-6989586621679335234"><span class="hs-identifier hs-var">cmd</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SMTag -&gt; Maybe SMTag
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335127"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-278"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679335126"><span class="annot"><span class="annottext">rIndex' :: String -&gt; Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335126"><span class="hs-identifier hs-var hs-var">rIndex'</span></a></span></span><span> </span><span id="local-6989586621679335125"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679335125"><span class="hs-identifier hs-var">index</span></a></span></span><span> </span><span id="local-6989586621679335124"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335124"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span id="local-6989586621679335123"><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335123"><span class="hs-identifier hs-var">sm</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">(State -&gt; Smb) -&gt; State -&gt; Smb
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StateName
-&gt; String -&gt; Set Tag -&gt; Int -&gt; Maybe TMCMD -&gt; Maybe SMTag -&gt; State
</span><a href="TM2SMHelpers.html#newState"><span class="hs-identifier hs-var">newState</span></a></span><span> </span><span class="annot"><span class="annottext">StateName
</span><a href="SMType.html#R"><span class="hs-identifier hs-var">R</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679335125"><span class="hs-identifier hs-var">index</span></a></span><span> </span><span class="annot"><span class="annottext">Set Tag
</span><a href="TM2SMHelpers.html#quoteTag"><span class="hs-identifier hs-var">quoteTag</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335124"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TMCMD -&gt; Maybe TMCMD
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">TMCMD
</span><a href="#local-6989586621679335234"><span class="hs-identifier hs-var">cmd</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SMTag -&gt; Maybe SMTag
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335123"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-279"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679335122"><span class="annot"><span class="annottext">sIndex' :: String -&gt; Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335122"><span class="hs-identifier hs-var hs-var">sIndex'</span></a></span></span><span> </span><span id="local-6989586621679335121"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679335121"><span class="hs-identifier hs-var">index</span></a></span></span><span> </span><span id="local-6989586621679335120"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335120"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span id="local-6989586621679335119"><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335119"><span class="hs-identifier hs-var">sm</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">(State -&gt; Smb) -&gt; State -&gt; Smb
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StateName
-&gt; String -&gt; Set Tag -&gt; Int -&gt; Maybe TMCMD -&gt; Maybe SMTag -&gt; State
</span><a href="TM2SMHelpers.html#newState"><span class="hs-identifier hs-var">newState</span></a></span><span> </span><span class="annot"><span class="annottext">StateName
</span><a href="SMType.html#S"><span class="hs-identifier hs-var">S</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679335121"><span class="hs-identifier hs-var">index</span></a></span><span> </span><span class="annot"><span class="annottext">Set Tag
</span><a href="TM2SMHelpers.html#quoteTag"><span class="hs-identifier hs-var">quoteTag</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335120"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TMCMD -&gt; Maybe TMCMD
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">TMCMD
</span><a href="#local-6989586621679335234"><span class="hs-identifier hs-var">cmd</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SMTag -&gt; Maybe SMTag
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335119"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-280"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679335118"><span class="annot"><span class="annottext">tIndex' :: String -&gt; Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335118"><span class="hs-identifier hs-var hs-var">tIndex'</span></a></span></span><span> </span><span id="local-6989586621679335117"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679335117"><span class="hs-identifier hs-var">index</span></a></span></span><span> </span><span id="local-6989586621679335116"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335116"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span id="local-6989586621679335115"><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335115"><span class="hs-identifier hs-var">sm</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">(State -&gt; Smb) -&gt; State -&gt; Smb
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StateName
-&gt; String -&gt; Set Tag -&gt; Int -&gt; Maybe TMCMD -&gt; Maybe SMTag -&gt; State
</span><a href="TM2SMHelpers.html#newState"><span class="hs-identifier hs-var">newState</span></a></span><span> </span><span class="annot"><span class="annottext">StateName
</span><a href="SMType.html#T"><span class="hs-identifier hs-var">T</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679335117"><span class="hs-identifier hs-var">index</span></a></span><span> </span><span class="annot"><span class="annottext">Set Tag
</span><a href="TM2SMHelpers.html#quoteTag"><span class="hs-identifier hs-var">quoteTag</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335116"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TMCMD -&gt; Maybe TMCMD
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">TMCMD
</span><a href="#local-6989586621679335234"><span class="hs-identifier hs-var">cmd</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SMTag -&gt; Maybe SMTag
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335115"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-281"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679335114"><span class="annot"><span class="annottext">uIndex' :: String -&gt; Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335114"><span class="hs-identifier hs-var hs-var">uIndex'</span></a></span></span><span> </span><span id="local-6989586621679335113"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679335113"><span class="hs-identifier hs-var">index</span></a></span></span><span> </span><span id="local-6989586621679335112"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335112"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span id="local-6989586621679335111"><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335111"><span class="hs-identifier hs-var">sm</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">(State -&gt; Smb) -&gt; State -&gt; Smb
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StateName
-&gt; String -&gt; Set Tag -&gt; Int -&gt; Maybe TMCMD -&gt; Maybe SMTag -&gt; State
</span><a href="TM2SMHelpers.html#newState"><span class="hs-identifier hs-var">newState</span></a></span><span> </span><span class="annot"><span class="annottext">StateName
</span><a href="SMType.html#U"><span class="hs-identifier hs-var">U</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679335113"><span class="hs-identifier hs-var">index</span></a></span><span> </span><span class="annot"><span class="annottext">Set Tag
</span><a href="TM2SMHelpers.html#quoteTag"><span class="hs-identifier hs-var">quoteTag</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335112"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TMCMD -&gt; Maybe TMCMD
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">TMCMD
</span><a href="#local-6989586621679335234"><span class="hs-identifier hs-var">cmd</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SMTag -&gt; Maybe SMTag
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335111"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-282"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679335110"><span class="annot"><span class="annottext">xIndex' :: String -&gt; Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335110"><span class="hs-identifier hs-var hs-var">xIndex'</span></a></span></span><span> </span><span id="local-6989586621679335109"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679335109"><span class="hs-identifier hs-var">index</span></a></span></span><span> </span><span id="local-6989586621679335108"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335108"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span id="local-6989586621679335107"><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335107"><span class="hs-identifier hs-var">sm</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">(State -&gt; Smb) -&gt; State -&gt; Smb
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StateName
-&gt; String -&gt; Set Tag -&gt; Int -&gt; Maybe TMCMD -&gt; Maybe SMTag -&gt; State
</span><a href="TM2SMHelpers.html#newState"><span class="hs-identifier hs-var">newState</span></a></span><span> </span><span class="annot"><span class="annottext">StateName
</span><a href="SMType.html#X"><span class="hs-identifier hs-var">X</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679335109"><span class="hs-identifier hs-var">index</span></a></span><span> </span><span class="annot"><span class="annottext">Set Tag
</span><a href="TM2SMHelpers.html#quoteTag"><span class="hs-identifier hs-var">quoteTag</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335108"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TMCMD -&gt; Maybe TMCMD
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">TMCMD
</span><a href="#local-6989586621679335234"><span class="hs-identifier hs-var">cmd</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SMTag -&gt; Maybe SMTag
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335107"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-283"></span><span>
</span><span id="line-284"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679335106"><span class="annot"><span class="annottext">phIndex :: String -&gt; Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335106"><span class="hs-identifier hs-var hs-var">phIndex</span></a></span></span><span> </span><span id="local-6989586621679335105"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679335105"><span class="hs-identifier hs-var">index</span></a></span></span><span> </span><span id="local-6989586621679335104"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335104"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span id="local-6989586621679335103"><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335103"><span class="hs-identifier hs-var">sm</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">(State -&gt; Smb) -&gt; State -&gt; Smb
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StateName
-&gt; String -&gt; Set Tag -&gt; Int -&gt; Maybe TMCMD -&gt; Maybe SMTag -&gt; State
</span><a href="TM2SMHelpers.html#newState"><span class="hs-identifier hs-var">newState</span></a></span><span> </span><span class="annot"><span class="annottext">StateName
</span><a href="SMType.html#P"><span class="hs-identifier hs-var">P</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679335105"><span class="hs-identifier hs-var">index</span></a></span><span> </span><span class="annot"><span class="annottext">Set Tag
</span><a href="TM2SMHelpers.html#hatTag"><span class="hs-identifier hs-var">hatTag</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335104"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TMCMD -&gt; Maybe TMCMD
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">TMCMD
</span><a href="#local-6989586621679335234"><span class="hs-identifier hs-var">cmd</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SMTag -&gt; Maybe SMTag
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335103"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-285"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679335101"><span class="annot"><span class="annottext">qhIndex :: String -&gt; Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335101"><span class="hs-identifier hs-var hs-var">qhIndex</span></a></span></span><span> </span><span id="local-6989586621679335100"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679335100"><span class="hs-identifier hs-var">index</span></a></span></span><span> </span><span id="local-6989586621679335099"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335099"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span id="local-6989586621679335098"><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335098"><span class="hs-identifier hs-var">sm</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">(State -&gt; Smb) -&gt; State -&gt; Smb
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StateName
-&gt; String -&gt; Set Tag -&gt; Int -&gt; Maybe TMCMD -&gt; Maybe SMTag -&gt; State
</span><a href="TM2SMHelpers.html#newState"><span class="hs-identifier hs-var">newState</span></a></span><span> </span><span class="annot"><span class="annottext">StateName
</span><a href="SMType.html#Q"><span class="hs-identifier hs-var">Q</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679335100"><span class="hs-identifier hs-var">index</span></a></span><span> </span><span class="annot"><span class="annottext">Set Tag
</span><a href="TM2SMHelpers.html#hatTag"><span class="hs-identifier hs-var">hatTag</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335099"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TMCMD -&gt; Maybe TMCMD
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">TMCMD
</span><a href="#local-6989586621679335234"><span class="hs-identifier hs-var">cmd</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SMTag -&gt; Maybe SMTag
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335098"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-286"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679335097"><span class="annot"><span class="annottext">rhIndex :: String -&gt; Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335097"><span class="hs-identifier hs-var hs-var">rhIndex</span></a></span></span><span> </span><span id="local-6989586621679335096"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679335096"><span class="hs-identifier hs-var">index</span></a></span></span><span> </span><span id="local-6989586621679335095"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335095"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span id="local-6989586621679335094"><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335094"><span class="hs-identifier hs-var">sm</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">(State -&gt; Smb) -&gt; State -&gt; Smb
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StateName
-&gt; String -&gt; Set Tag -&gt; Int -&gt; Maybe TMCMD -&gt; Maybe SMTag -&gt; State
</span><a href="TM2SMHelpers.html#newState"><span class="hs-identifier hs-var">newState</span></a></span><span> </span><span class="annot"><span class="annottext">StateName
</span><a href="SMType.html#R"><span class="hs-identifier hs-var">R</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679335096"><span class="hs-identifier hs-var">index</span></a></span><span> </span><span class="annot"><span class="annottext">Set Tag
</span><a href="TM2SMHelpers.html#hatTag"><span class="hs-identifier hs-var">hatTag</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335095"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TMCMD -&gt; Maybe TMCMD
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">TMCMD
</span><a href="#local-6989586621679335234"><span class="hs-identifier hs-var">cmd</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SMTag -&gt; Maybe SMTag
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335094"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-287"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679335093"><span class="annot"><span class="annottext">shIndex :: String -&gt; Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335093"><span class="hs-identifier hs-var hs-var">shIndex</span></a></span></span><span> </span><span id="local-6989586621679335092"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679335092"><span class="hs-identifier hs-var">index</span></a></span></span><span> </span><span id="local-6989586621679335091"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335091"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span id="local-6989586621679335090"><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335090"><span class="hs-identifier hs-var">sm</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">(State -&gt; Smb) -&gt; State -&gt; Smb
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StateName
-&gt; String -&gt; Set Tag -&gt; Int -&gt; Maybe TMCMD -&gt; Maybe SMTag -&gt; State
</span><a href="TM2SMHelpers.html#newState"><span class="hs-identifier hs-var">newState</span></a></span><span> </span><span class="annot"><span class="annottext">StateName
</span><a href="SMType.html#S"><span class="hs-identifier hs-var">S</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679335092"><span class="hs-identifier hs-var">index</span></a></span><span> </span><span class="annot"><span class="annottext">Set Tag
</span><a href="TM2SMHelpers.html#hatTag"><span class="hs-identifier hs-var">hatTag</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335091"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TMCMD -&gt; Maybe TMCMD
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">TMCMD
</span><a href="#local-6989586621679335234"><span class="hs-identifier hs-var">cmd</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SMTag -&gt; Maybe SMTag
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335090"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-288"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679335089"><span class="annot"><span class="annottext">thIndex :: String -&gt; Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335089"><span class="hs-identifier hs-var hs-var">thIndex</span></a></span></span><span> </span><span id="local-6989586621679335088"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679335088"><span class="hs-identifier hs-var">index</span></a></span></span><span> </span><span id="local-6989586621679335087"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335087"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span id="local-6989586621679335086"><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335086"><span class="hs-identifier hs-var">sm</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">(State -&gt; Smb) -&gt; State -&gt; Smb
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StateName
-&gt; String -&gt; Set Tag -&gt; Int -&gt; Maybe TMCMD -&gt; Maybe SMTag -&gt; State
</span><a href="TM2SMHelpers.html#newState"><span class="hs-identifier hs-var">newState</span></a></span><span> </span><span class="annot"><span class="annottext">StateName
</span><a href="SMType.html#T"><span class="hs-identifier hs-var">T</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679335088"><span class="hs-identifier hs-var">index</span></a></span><span> </span><span class="annot"><span class="annottext">Set Tag
</span><a href="TM2SMHelpers.html#hatTag"><span class="hs-identifier hs-var">hatTag</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335087"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TMCMD -&gt; Maybe TMCMD
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">TMCMD
</span><a href="#local-6989586621679335234"><span class="hs-identifier hs-var">cmd</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SMTag -&gt; Maybe SMTag
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335086"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-289"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679335085"><span class="annot"><span class="annottext">uhIndex :: String -&gt; Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335085"><span class="hs-identifier hs-var hs-var">uhIndex</span></a></span></span><span> </span><span id="local-6989586621679335084"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679335084"><span class="hs-identifier hs-var">index</span></a></span></span><span> </span><span id="local-6989586621679335083"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335083"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span id="local-6989586621679335082"><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335082"><span class="hs-identifier hs-var">sm</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">(State -&gt; Smb) -&gt; State -&gt; Smb
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StateName
-&gt; String -&gt; Set Tag -&gt; Int -&gt; Maybe TMCMD -&gt; Maybe SMTag -&gt; State
</span><a href="TM2SMHelpers.html#newState"><span class="hs-identifier hs-var">newState</span></a></span><span> </span><span class="annot"><span class="annottext">StateName
</span><a href="SMType.html#U"><span class="hs-identifier hs-var">U</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679335084"><span class="hs-identifier hs-var">index</span></a></span><span> </span><span class="annot"><span class="annottext">Set Tag
</span><a href="TM2SMHelpers.html#hatTag"><span class="hs-identifier hs-var">hatTag</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335083"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TMCMD -&gt; Maybe TMCMD
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">TMCMD
</span><a href="#local-6989586621679335234"><span class="hs-identifier hs-var">cmd</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SMTag -&gt; Maybe SMTag
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335082"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-290"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679335081"><span class="annot"><span class="annottext">xh :: Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335081"><span class="hs-identifier hs-var hs-var">xh</span></a></span></span><span> </span><span id="local-6989586621679335080"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335080"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span id="local-6989586621679335079"><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335079"><span class="hs-identifier hs-var">sm</span></a></span></span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">(State -&gt; Smb) -&gt; State -&gt; Smb
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StateName
-&gt; String -&gt; Set Tag -&gt; Int -&gt; Maybe TMCMD -&gt; Maybe SMTag -&gt; State
</span><a href="TM2SMHelpers.html#newState"><span class="hs-identifier hs-var">newState</span></a></span><span> </span><span class="annot"><span class="annottext">StateName
</span><a href="SMType.html#X"><span class="hs-identifier hs-var">X</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">Set Tag
</span><a href="TM2SMHelpers.html#hatTag"><span class="hs-identifier hs-var">hatTag</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335080"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TMCMD -&gt; Maybe TMCMD
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">TMCMD
</span><a href="#local-6989586621679335234"><span class="hs-identifier hs-var">cmd</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SMTag -&gt; Maybe SMTag
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335079"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-291"></span><span>
</span><span id="line-292"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679335078"><span class="annot"><span class="annottext">phdIndex :: String -&gt; Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335078"><span class="hs-identifier hs-var hs-var">phdIndex</span></a></span></span><span> </span><span id="local-6989586621679335077"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679335077"><span class="hs-identifier hs-var">index</span></a></span></span><span> </span><span id="local-6989586621679335076"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335076"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span id="local-6989586621679335075"><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335075"><span class="hs-identifier hs-var">sm</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">(State -&gt; Smb) -&gt; State -&gt; Smb
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StateName
-&gt; String -&gt; Set Tag -&gt; Int -&gt; Maybe TMCMD -&gt; Maybe SMTag -&gt; State
</span><a href="TM2SMHelpers.html#newState"><span class="hs-identifier hs-var">newState</span></a></span><span> </span><span class="annot"><span class="annottext">StateName
</span><a href="SMType.html#P"><span class="hs-identifier hs-var">P</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679335077"><span class="hs-identifier hs-var">index</span></a></span><span> </span><span class="annot"><span class="annottext">Set Tag
</span><a href="TM2SMHelpers.html#hatdashTag"><span class="hs-identifier hs-var">hatdashTag</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335076"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TMCMD -&gt; Maybe TMCMD
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">TMCMD
</span><a href="#local-6989586621679335234"><span class="hs-identifier hs-var">cmd</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SMTag -&gt; Maybe SMTag
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335075"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-293"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679335073"><span class="annot"><span class="annottext">qhdIndex :: String -&gt; Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335073"><span class="hs-identifier hs-var hs-var">qhdIndex</span></a></span></span><span> </span><span id="local-6989586621679335072"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679335072"><span class="hs-identifier hs-var">index</span></a></span></span><span> </span><span id="local-6989586621679335071"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335071"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span id="local-6989586621679335070"><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335070"><span class="hs-identifier hs-var">sm</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">(State -&gt; Smb) -&gt; State -&gt; Smb
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StateName
-&gt; String -&gt; Set Tag -&gt; Int -&gt; Maybe TMCMD -&gt; Maybe SMTag -&gt; State
</span><a href="TM2SMHelpers.html#newState"><span class="hs-identifier hs-var">newState</span></a></span><span> </span><span class="annot"><span class="annottext">StateName
</span><a href="SMType.html#Q"><span class="hs-identifier hs-var">Q</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679335072"><span class="hs-identifier hs-var">index</span></a></span><span> </span><span class="annot"><span class="annottext">Set Tag
</span><a href="TM2SMHelpers.html#hatdashTag"><span class="hs-identifier hs-var">hatdashTag</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335071"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TMCMD -&gt; Maybe TMCMD
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">TMCMD
</span><a href="#local-6989586621679335234"><span class="hs-identifier hs-var">cmd</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SMTag -&gt; Maybe SMTag
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335070"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-294"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679335069"><span class="annot"><span class="annottext">rhdIndex :: String -&gt; Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335069"><span class="hs-identifier hs-var hs-var">rhdIndex</span></a></span></span><span> </span><span id="local-6989586621679335068"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679335068"><span class="hs-identifier hs-var">index</span></a></span></span><span> </span><span id="local-6989586621679335067"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335067"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span id="local-6989586621679335066"><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335066"><span class="hs-identifier hs-var">sm</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">(State -&gt; Smb) -&gt; State -&gt; Smb
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StateName
-&gt; String -&gt; Set Tag -&gt; Int -&gt; Maybe TMCMD -&gt; Maybe SMTag -&gt; State
</span><a href="TM2SMHelpers.html#newState"><span class="hs-identifier hs-var">newState</span></a></span><span> </span><span class="annot"><span class="annottext">StateName
</span><a href="SMType.html#R"><span class="hs-identifier hs-var">R</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679335068"><span class="hs-identifier hs-var">index</span></a></span><span> </span><span class="annot"><span class="annottext">Set Tag
</span><a href="TM2SMHelpers.html#hatdashTag"><span class="hs-identifier hs-var">hatdashTag</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335067"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TMCMD -&gt; Maybe TMCMD
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">TMCMD
</span><a href="#local-6989586621679335234"><span class="hs-identifier hs-var">cmd</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SMTag -&gt; Maybe SMTag
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335066"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-295"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679335065"><span class="annot"><span class="annottext">shdIndex :: String -&gt; Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335065"><span class="hs-identifier hs-var hs-var">shdIndex</span></a></span></span><span> </span><span id="local-6989586621679335064"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679335064"><span class="hs-identifier hs-var">index</span></a></span></span><span> </span><span id="local-6989586621679335063"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335063"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span id="local-6989586621679335062"><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335062"><span class="hs-identifier hs-var">sm</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">(State -&gt; Smb) -&gt; State -&gt; Smb
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StateName
-&gt; String -&gt; Set Tag -&gt; Int -&gt; Maybe TMCMD -&gt; Maybe SMTag -&gt; State
</span><a href="TM2SMHelpers.html#newState"><span class="hs-identifier hs-var">newState</span></a></span><span> </span><span class="annot"><span class="annottext">StateName
</span><a href="SMType.html#S"><span class="hs-identifier hs-var">S</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679335064"><span class="hs-identifier hs-var">index</span></a></span><span> </span><span class="annot"><span class="annottext">Set Tag
</span><a href="TM2SMHelpers.html#hatdashTag"><span class="hs-identifier hs-var">hatdashTag</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335063"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TMCMD -&gt; Maybe TMCMD
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">TMCMD
</span><a href="#local-6989586621679335234"><span class="hs-identifier hs-var">cmd</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SMTag -&gt; Maybe SMTag
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335062"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-296"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679335061"><span class="annot"><span class="annottext">thdIndex :: String -&gt; Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335061"><span class="hs-identifier hs-var hs-var">thdIndex</span></a></span></span><span> </span><span id="local-6989586621679335060"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679335060"><span class="hs-identifier hs-var">index</span></a></span></span><span> </span><span id="local-6989586621679335059"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335059"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span id="local-6989586621679335058"><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335058"><span class="hs-identifier hs-var">sm</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">(State -&gt; Smb) -&gt; State -&gt; Smb
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StateName
-&gt; String -&gt; Set Tag -&gt; Int -&gt; Maybe TMCMD -&gt; Maybe SMTag -&gt; State
</span><a href="TM2SMHelpers.html#newState"><span class="hs-identifier hs-var">newState</span></a></span><span> </span><span class="annot"><span class="annottext">StateName
</span><a href="SMType.html#T"><span class="hs-identifier hs-var">T</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679335060"><span class="hs-identifier hs-var">index</span></a></span><span> </span><span class="annot"><span class="annottext">Set Tag
</span><a href="TM2SMHelpers.html#hatdashTag"><span class="hs-identifier hs-var">hatdashTag</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335059"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TMCMD -&gt; Maybe TMCMD
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">TMCMD
</span><a href="#local-6989586621679335234"><span class="hs-identifier hs-var">cmd</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SMTag -&gt; Maybe SMTag
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335058"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-297"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679335057"><span class="annot"><span class="annottext">uhdIndex :: String -&gt; Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335057"><span class="hs-identifier hs-var hs-var">uhdIndex</span></a></span></span><span> </span><span id="local-6989586621679335056"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679335056"><span class="hs-identifier hs-var">index</span></a></span></span><span> </span><span id="local-6989586621679335055"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335055"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span id="local-6989586621679335054"><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335054"><span class="hs-identifier hs-var">sm</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">(State -&gt; Smb) -&gt; State -&gt; Smb
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StateName
-&gt; String -&gt; Set Tag -&gt; Int -&gt; Maybe TMCMD -&gt; Maybe SMTag -&gt; State
</span><a href="TM2SMHelpers.html#newState"><span class="hs-identifier hs-var">newState</span></a></span><span> </span><span class="annot"><span class="annottext">StateName
</span><a href="SMType.html#U"><span class="hs-identifier hs-var">U</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679335056"><span class="hs-identifier hs-var">index</span></a></span><span> </span><span class="annot"><span class="annottext">Set Tag
</span><a href="TM2SMHelpers.html#hatdashTag"><span class="hs-identifier hs-var">hatdashTag</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335055"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TMCMD -&gt; Maybe TMCMD
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">TMCMD
</span><a href="#local-6989586621679335234"><span class="hs-identifier hs-var">cmd</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SMTag -&gt; Maybe SMTag
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335054"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-298"></span><span>
</span><span id="line-299"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679335053"><span class="annot"><span class="annottext">Square
</span><a href="#local-6989586621679335053"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679335052"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TapeCommand] -&gt; (Square, Int)
</span><a href="TM2SMHelpers.html#getai"><span class="hs-identifier hs-var">getai</span></a></span><span> </span><span class="annot"><span class="annottext">[TapeCommand]
</span><a href="#local-6989586621679335232"><span class="hs-identifier hs-var">command</span></a></span><span>
</span><span id="line-300"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679335050"><span class="annot"><span class="annottext">getFromJ :: Int -&gt; String
</span><a href="#local-6989586621679335050"><span class="hs-identifier hs-var hs-var">getFromJ</span></a></span></span><span> </span><span id="local-6989586621679335049"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335049"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679335048"><span class="hs-identifier hs-var">state</span></a></span><span> </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679335048"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679335048"><span class="hs-identifier hs-var">state</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TapeCommand] -&gt; Int -&gt; (String, String)
</span><a href="TM2SMHelpers.html#getJIdx"><span class="hs-identifier hs-var">getJIdx</span></a></span><span> </span><span class="annot"><span class="annottext">[TapeCommand]
</span><a href="#local-6989586621679335232"><span class="hs-identifier hs-var">command</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335049"><span class="hs-identifier hs-var">j</span></a></span><span>
</span><span id="line-301"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679335046"><span class="annot"><span class="annottext">getToJ :: Int -&gt; String
</span><a href="#local-6989586621679335046"><span class="hs-identifier hs-var hs-var">getToJ</span></a></span></span><span> </span><span id="local-6989586621679335045"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335045"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679335044"><span class="hs-identifier hs-var">state</span></a></span><span> </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679335044"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679335044"><span class="hs-identifier hs-var">state</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TapeCommand] -&gt; Int -&gt; (String, String)
</span><a href="TM2SMHelpers.html#getJIdx"><span class="hs-identifier hs-var">getJIdx</span></a></span><span> </span><span class="annot"><span class="annottext">[TapeCommand]
</span><a href="#local-6989586621679335232"><span class="hs-identifier hs-var">command</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335045"><span class="hs-identifier hs-var">j</span></a></span><span>
</span><span id="line-302"></span><span>
</span><span id="line-303"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679335043"><span class="annot"><span class="annottext">p4 :: SMTag -&gt; Smb
</span><a href="#local-6989586621679335043"><span class="hs-identifier hs-var hs-var">p4</span></a></span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335162"><span class="hs-identifier hs-var">pIndex</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;1&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-304"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679335042"><span class="annot"><span class="annottext">q4 :: SMTag -&gt; Smb
</span><a href="#local-6989586621679335042"><span class="hs-identifier hs-var hs-var">q4</span></a></span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335158"><span class="hs-identifier hs-var">qIndex</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;1&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-305"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679335041"><span class="annot"><span class="annottext">r4 :: SMTag -&gt; Smb
</span><a href="#local-6989586621679335041"><span class="hs-identifier hs-var hs-var">r4</span></a></span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335154"><span class="hs-identifier hs-var">rIndex</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;1&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-306"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679335040"><span class="annot"><span class="annottext">s4 :: SMTag -&gt; Smb
</span><a href="#local-6989586621679335040"><span class="hs-identifier hs-var hs-var">s4</span></a></span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335150"><span class="hs-identifier hs-var">sIndex</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;1&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-307"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679335039"><span class="annot"><span class="annottext">t4 :: SMTag -&gt; Smb
</span><a href="#local-6989586621679335039"><span class="hs-identifier hs-var hs-var">t4</span></a></span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335146"><span class="hs-identifier hs-var">tIndex</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;1&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-308"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679335038"><span class="annot"><span class="annottext">u4 :: SMTag -&gt; Smb
</span><a href="#local-6989586621679335038"><span class="hs-identifier hs-var hs-var">u4</span></a></span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335142"><span class="hs-identifier hs-var">uIndex</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;1&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-309"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679335037"><span class="annot"><span class="annottext">pd4 :: SMTag -&gt; Smb
</span><a href="#local-6989586621679335037"><span class="hs-identifier hs-var hs-var">pd4</span></a></span></span><span> </span><span id="local-6989586621679335036"><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335036"><span class="hs-identifier hs-var">sm</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">(State -&gt; Smb) -&gt; State -&gt; Smb
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StateName
-&gt; String -&gt; Set Tag -&gt; Int -&gt; Maybe TMCMD -&gt; Maybe SMTag -&gt; State
</span><a href="TM2SMHelpers.html#newState"><span class="hs-identifier hs-var">newState</span></a></span><span> </span><span class="annot"><span class="annottext">StateName
</span><a href="SMType.html#P"><span class="hs-identifier hs-var">P</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;0&quot;</span></span><span> </span><span class="annot"><span class="annottext">Set Tag
</span><a href="TM2SMHelpers.html#dashTag"><span class="hs-identifier hs-var">dashTag</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TMCMD -&gt; Maybe TMCMD
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">TMCMD
</span><a href="#local-6989586621679335234"><span class="hs-identifier hs-var">cmd</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SMTag -&gt; Maybe SMTag
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335036"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-310"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679335035"><span class="annot"><span class="annottext">qd4 :: SMTag -&gt; Smb
</span><a href="#local-6989586621679335035"><span class="hs-identifier hs-var hs-var">qd4</span></a></span></span><span> </span><span id="local-6989586621679335034"><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335034"><span class="hs-identifier hs-var">sm</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">(State -&gt; Smb) -&gt; State -&gt; Smb
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StateName
-&gt; String -&gt; Set Tag -&gt; Int -&gt; Maybe TMCMD -&gt; Maybe SMTag -&gt; State
</span><a href="TM2SMHelpers.html#newState"><span class="hs-identifier hs-var">newState</span></a></span><span> </span><span class="annot"><span class="annottext">StateName
</span><a href="SMType.html#Q"><span class="hs-identifier hs-var">Q</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;0&quot;</span></span><span> </span><span class="annot"><span class="annottext">Set Tag
</span><a href="TM2SMHelpers.html#dashTag"><span class="hs-identifier hs-var">dashTag</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TMCMD -&gt; Maybe TMCMD
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">TMCMD
</span><a href="#local-6989586621679335234"><span class="hs-identifier hs-var">cmd</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SMTag -&gt; Maybe SMTag
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335034"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-311"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679335033"><span class="annot"><span class="annottext">rd4 :: SMTag -&gt; Smb
</span><a href="#local-6989586621679335033"><span class="hs-identifier hs-var hs-var">rd4</span></a></span></span><span> </span><span id="local-6989586621679335032"><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335032"><span class="hs-identifier hs-var">sm</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">(State -&gt; Smb) -&gt; State -&gt; Smb
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StateName
-&gt; String -&gt; Set Tag -&gt; Int -&gt; Maybe TMCMD -&gt; Maybe SMTag -&gt; State
</span><a href="TM2SMHelpers.html#newState"><span class="hs-identifier hs-var">newState</span></a></span><span> </span><span class="annot"><span class="annottext">StateName
</span><a href="SMType.html#R"><span class="hs-identifier hs-var">R</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;0&quot;</span></span><span> </span><span class="annot"><span class="annottext">Set Tag
</span><a href="TM2SMHelpers.html#dashTag"><span class="hs-identifier hs-var">dashTag</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TMCMD -&gt; Maybe TMCMD
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">TMCMD
</span><a href="#local-6989586621679335234"><span class="hs-identifier hs-var">cmd</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SMTag -&gt; Maybe SMTag
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335032"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-312"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679335031"><span class="annot"><span class="annottext">sd4 :: SMTag -&gt; Smb
</span><a href="#local-6989586621679335031"><span class="hs-identifier hs-var hs-var">sd4</span></a></span></span><span> </span><span id="local-6989586621679335030"><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335030"><span class="hs-identifier hs-var">sm</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">(State -&gt; Smb) -&gt; State -&gt; Smb
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StateName
-&gt; String -&gt; Set Tag -&gt; Int -&gt; Maybe TMCMD -&gt; Maybe SMTag -&gt; State
</span><a href="TM2SMHelpers.html#newState"><span class="hs-identifier hs-var">newState</span></a></span><span> </span><span class="annot"><span class="annottext">StateName
</span><a href="SMType.html#S"><span class="hs-identifier hs-var">S</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;0&quot;</span></span><span> </span><span class="annot"><span class="annottext">Set Tag
</span><a href="TM2SMHelpers.html#dashTag"><span class="hs-identifier hs-var">dashTag</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TMCMD -&gt; Maybe TMCMD
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">TMCMD
</span><a href="#local-6989586621679335234"><span class="hs-identifier hs-var">cmd</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SMTag -&gt; Maybe SMTag
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335030"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-313"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679335029"><span class="annot"><span class="annottext">td4 :: SMTag -&gt; Smb
</span><a href="#local-6989586621679335029"><span class="hs-identifier hs-var hs-var">td4</span></a></span></span><span> </span><span id="local-6989586621679335028"><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335028"><span class="hs-identifier hs-var">sm</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">(State -&gt; Smb) -&gt; State -&gt; Smb
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StateName
-&gt; String -&gt; Set Tag -&gt; Int -&gt; Maybe TMCMD -&gt; Maybe SMTag -&gt; State
</span><a href="TM2SMHelpers.html#newState"><span class="hs-identifier hs-var">newState</span></a></span><span> </span><span class="annot"><span class="annottext">StateName
</span><a href="SMType.html#T"><span class="hs-identifier hs-var">T</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;0&quot;</span></span><span> </span><span class="annot"><span class="annottext">Set Tag
</span><a href="TM2SMHelpers.html#dashTag"><span class="hs-identifier hs-var">dashTag</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TMCMD -&gt; Maybe TMCMD
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">TMCMD
</span><a href="#local-6989586621679335234"><span class="hs-identifier hs-var">cmd</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SMTag -&gt; Maybe SMTag
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335028"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-314"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679335027"><span class="annot"><span class="annottext">ud4 :: SMTag -&gt; Smb
</span><a href="#local-6989586621679335027"><span class="hs-identifier hs-var hs-var">ud4</span></a></span></span><span> </span><span id="local-6989586621679335026"><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335026"><span class="hs-identifier hs-var">sm</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State -&gt; Smb
</span><a href="SMType.html#SmbQ"><span class="hs-identifier hs-var">SmbQ</span></a></span><span> </span><span class="annot"><span class="annottext">(State -&gt; Smb) -&gt; State -&gt; Smb
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StateName
-&gt; String -&gt; Set Tag -&gt; Int -&gt; Maybe TMCMD -&gt; Maybe SMTag -&gt; State
</span><a href="TM2SMHelpers.html#newState"><span class="hs-identifier hs-var">newState</span></a></span><span> </span><span class="annot"><span class="annottext">StateName
</span><a href="SMType.html#U"><span class="hs-identifier hs-var">U</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;0&quot;</span></span><span> </span><span class="annot"><span class="annottext">Set Tag
</span><a href="TM2SMHelpers.html#dashTag"><span class="hs-identifier hs-var">dashTag</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TMCMD -&gt; Maybe TMCMD
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">TMCMD
</span><a href="#local-6989586621679335234"><span class="hs-identifier hs-var">cmd</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SMTag -&gt; Maybe SMTag
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335026"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-315"></span><span>
</span><span id="line-316"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679335025"><span class="annot"><span class="annottext">rule4 :: SRule
</span><a href="#local-6989586621679335025"><span class="hs-identifier hs-var hs-var">rule4</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-317"></span><span>            </span><span class="annot"><span class="annottext">[(Word, Word)] -&gt; SRule
</span><a href="SMType.html#SRule"><span class="hs-identifier hs-var">SRule</span></a></span><span> </span><span class="annot"><span class="annottext">([(Word, Word)] -&gt; SRule) -&gt; [(Word, Word)] -&gt; SRule
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(Word, Word)] -&gt; [(Word, Word)] -&gt; [(Word, Word)]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">(++)</span></span><span>
</span><span id="line-318"></span><span>            </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eE"><span class="hs-identifier hs-var">eE</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335202"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T4"><span class="hs-identifier hs-var">T4</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-319"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Smb
</span><a href="#local-6989586621679335228"><span class="hs-identifier hs-var">eFl'</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">SMTag -&gt; Smb
</span><a href="#local-6989586621679335209"><span class="hs-identifier hs-var">fl'</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T4"><span class="hs-identifier hs-var">T4</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-320"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eX"><span class="hs-identifier hs-var">eX</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Smb
</span><a href="#local-6989586621679335230"><span class="hs-identifier hs-var">eF0</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335225"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T4"><span class="hs-identifier hs-var">T4</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SMTag -&gt; Smb
</span><a href="#local-6989586621679335207"><span class="hs-identifier hs-var">f0</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T4"><span class="hs-identifier hs-var">T4</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-321"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eE%27"><span class="hs-identifier hs-var">eE'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335231"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eX%27"><span class="hs-identifier hs-var">eX'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335231"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335205"><span class="hs-identifier hs-var">e'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335231"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T4"><span class="hs-identifier hs-var">T4</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335221"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335231"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T4"><span class="hs-identifier hs-var">T4</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-322"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eE"><span class="hs-identifier hs-var">eE</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335202"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T4"><span class="hs-identifier hs-var">T4</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-323"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eX"><span class="hs-identifier hs-var">eX</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eF"><span class="hs-identifier hs-var">eF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; String
</span><a href="#local-6989586621679335050"><span class="hs-identifier hs-var">getFromJ</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eE%27"><span class="hs-identifier hs-var">eE'</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eP"><span class="hs-identifier hs-var">eP</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-324"></span><span>            </span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335225"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T4"><span class="hs-identifier hs-var">T4</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335213"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; String
</span><a href="#local-6989586621679335050"><span class="hs-identifier hs-var">getFromJ</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T4"><span class="hs-identifier hs-var">T4</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335205"><span class="hs-identifier hs-var">e'</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T4"><span class="hs-identifier hs-var">T4</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SMTag -&gt; Smb
</span><a href="#local-6989586621679335043"><span class="hs-identifier hs-var">p4</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T4"><span class="hs-identifier hs-var">T4</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-325"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eQ"><span class="hs-identifier hs-var">eQ</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eR"><span class="hs-identifier hs-var">eR</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eS"><span class="hs-identifier hs-var">eS</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eT"><span class="hs-identifier hs-var">eT</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eU"><span class="hs-identifier hs-var">eU</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#ePd"><span class="hs-identifier hs-var">ePd</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eQd"><span class="hs-identifier hs-var">eQd</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eRd"><span class="hs-identifier hs-var">eRd</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eSd"><span class="hs-identifier hs-var">eSd</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eTd"><span class="hs-identifier hs-var">eTd</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eUd"><span class="hs-identifier hs-var">eUd</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eF%27"><span class="hs-identifier hs-var">eF'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; String
</span><a href="#local-6989586621679335050"><span class="hs-identifier hs-var">getFromJ</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-326"></span><span>            </span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">SMTag -&gt; Smb
</span><a href="#local-6989586621679335042"><span class="hs-identifier hs-var">q4</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T4"><span class="hs-identifier hs-var">T4</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SMTag -&gt; Smb
</span><a href="#local-6989586621679335041"><span class="hs-identifier hs-var">r4</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T4"><span class="hs-identifier hs-var">T4</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SMTag -&gt; Smb
</span><a href="#local-6989586621679335040"><span class="hs-identifier hs-var">s4</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T4"><span class="hs-identifier hs-var">T4</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SMTag -&gt; Smb
</span><a href="#local-6989586621679335039"><span class="hs-identifier hs-var">t4</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T4"><span class="hs-identifier hs-var">T4</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SMTag -&gt; Smb
</span><a href="#local-6989586621679335038"><span class="hs-identifier hs-var">u4</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T4"><span class="hs-identifier hs-var">T4</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SMTag -&gt; Smb
</span><a href="#local-6989586621679335037"><span class="hs-identifier hs-var">pd4</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T4"><span class="hs-identifier hs-var">T4</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SMTag -&gt; Smb
</span><a href="#local-6989586621679335035"><span class="hs-identifier hs-var">qd4</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T4"><span class="hs-identifier hs-var">T4</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SMTag -&gt; Smb
</span><a href="#local-6989586621679335033"><span class="hs-identifier hs-var">rd4</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T4"><span class="hs-identifier hs-var">T4</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SMTag -&gt; Smb
</span><a href="#local-6989586621679335031"><span class="hs-identifier hs-var">sd4</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T4"><span class="hs-identifier hs-var">T4</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SMTag -&gt; Smb
</span><a href="#local-6989586621679335029"><span class="hs-identifier hs-var">td4</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T4"><span class="hs-identifier hs-var">T4</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SMTag -&gt; Smb
</span><a href="#local-6989586621679335027"><span class="hs-identifier hs-var">ud4</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T4"><span class="hs-identifier hs-var">T4</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335217"><span class="hs-identifier hs-var">f'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; String
</span><a href="#local-6989586621679335050"><span class="hs-identifier hs-var">getFromJ</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T4"><span class="hs-identifier hs-var">T4</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-327"></span><span>            </span><span class="annot"><span class="annottext">([(Word, Word)] -&gt; [(Word, Word)])
-&gt; [(Word, Word)] -&gt; [(Word, Word)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[[(Word, Word)]] -&gt; [(Word, Word)]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span>
</span><span id="line-328"></span><span>            </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eE"><span class="hs-identifier hs-var">eE</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335006"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335202"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335006"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T4"><span class="hs-identifier hs-var">T4</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-329"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eX"><span class="hs-identifier hs-var">eX</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335006"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eF"><span class="hs-identifier hs-var">eF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; String
</span><a href="#local-6989586621679335050"><span class="hs-identifier hs-var">getFromJ</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335006"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335006"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eE%27"><span class="hs-identifier hs-var">eE'</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335006"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eP"><span class="hs-identifier hs-var">eP</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335006"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-330"></span><span>            </span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335225"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335006"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T4"><span class="hs-identifier hs-var">T4</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335213"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; String
</span><a href="#local-6989586621679335050"><span class="hs-identifier hs-var">getFromJ</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335006"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335006"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T4"><span class="hs-identifier hs-var">T4</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335205"><span class="hs-identifier hs-var">e'</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335006"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T4"><span class="hs-identifier hs-var">T4</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335199"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335006"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T4"><span class="hs-identifier hs-var">T4</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-331"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eQ"><span class="hs-identifier hs-var">eQ</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335006"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eR"><span class="hs-identifier hs-var">eR</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335006"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eS"><span class="hs-identifier hs-var">eS</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335006"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eT"><span class="hs-identifier hs-var">eT</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335006"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eU"><span class="hs-identifier hs-var">eU</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335006"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#ePd"><span class="hs-identifier hs-var">ePd</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335006"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eQd"><span class="hs-identifier hs-var">eQd</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335006"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eRd"><span class="hs-identifier hs-var">eRd</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335006"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eSd"><span class="hs-identifier hs-var">eSd</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335006"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eTd"><span class="hs-identifier hs-var">eTd</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335006"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eUd"><span class="hs-identifier hs-var">eUd</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335006"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eF%27"><span class="hs-identifier hs-var">eF'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; String
</span><a href="#local-6989586621679335050"><span class="hs-identifier hs-var">getFromJ</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335006"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335006"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-332"></span><span>            </span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335196"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335006"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T4"><span class="hs-identifier hs-var">T4</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335193"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335006"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T4"><span class="hs-identifier hs-var">T4</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335190"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335006"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T4"><span class="hs-identifier hs-var">T4</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335187"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335006"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T4"><span class="hs-identifier hs-var">T4</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335184"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335006"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T4"><span class="hs-identifier hs-var">T4</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335181"><span class="hs-identifier hs-var">pd</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335006"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T4"><span class="hs-identifier hs-var">T4</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335177"><span class="hs-identifier hs-var">qd</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335006"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T4"><span class="hs-identifier hs-var">T4</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335174"><span class="hs-identifier hs-var">rd</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335006"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T4"><span class="hs-identifier hs-var">T4</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335171"><span class="hs-identifier hs-var">sd</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335006"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T4"><span class="hs-identifier hs-var">T4</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335168"><span class="hs-identifier hs-var">td</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335006"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T4"><span class="hs-identifier hs-var">T4</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335165"><span class="hs-identifier hs-var">ud</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335006"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T4"><span class="hs-identifier hs-var">T4</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335217"><span class="hs-identifier hs-var">f'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; String
</span><a href="#local-6989586621679335050"><span class="hs-identifier hs-var">getFromJ</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335006"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335006"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T4"><span class="hs-identifier hs-var">T4</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-333"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679335006"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335006"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; [Int] -&gt; [Int]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335231"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-334"></span><span>
</span><span id="line-335"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679335005"><span class="annot"><span class="annottext">rule4alpha :: SRule
</span><a href="#local-6989586621679335005"><span class="hs-identifier hs-var hs-var">rule4alpha</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-336"></span><span>            </span><span class="annot"><span class="annottext">[(Word, Word)] -&gt; SRule
</span><a href="SMType.html#SRule"><span class="hs-identifier hs-var">SRule</span></a></span><span> </span><span class="annot"><span class="annottext">([(Word, Word)] -&gt; SRule) -&gt; [(Word, Word)] -&gt; SRule
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(Word, Word)] -&gt; [(Word, Word)] -&gt; [(Word, Word)]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">(++)</span></span><span>
</span><span id="line-337"></span><span>            </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335225"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T4"><span class="hs-identifier hs-var">T4</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SMTag -&gt; Smb
</span><a href="#local-6989586621679335207"><span class="hs-identifier hs-var">f0</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T4"><span class="hs-identifier hs-var">T4</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Y -&gt; Smb
</span><a href="SMType.html#SmbY%27"><span class="hs-identifier hs-var">SmbY'</span></a></span><span> </span><span class="annot"><span class="annottext">Y
</span><a href="SMType.html#Alpha"><span class="hs-identifier hs-var">Alpha</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335225"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#TAlpha"><span class="hs-identifier hs-var">TAlpha</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SMTag -&gt; Smb
</span><a href="#local-6989586621679335207"><span class="hs-identifier hs-var">f0</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#TAlpha"><span class="hs-identifier hs-var">TAlpha</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-338"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335205"><span class="hs-identifier hs-var">e'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335231"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T4"><span class="hs-identifier hs-var">T4</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335221"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335231"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T4"><span class="hs-identifier hs-var">T4</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335205"><span class="hs-identifier hs-var">e'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335231"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#TAlpha"><span class="hs-identifier hs-var">TAlpha</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335221"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335231"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#TAlpha"><span class="hs-identifier hs-var">TAlpha</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Y -&gt; Smb
</span><a href="SMType.html#SmbY%27"><span class="hs-identifier hs-var">SmbY'</span></a></span><span> </span><span class="annot"><span class="annottext">Y
</span><a href="SMType.html#Omega"><span class="hs-identifier hs-var">Omega</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-339"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335202"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T4"><span class="hs-identifier hs-var">T4</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335202"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#TAlpha"><span class="hs-identifier hs-var">TAlpha</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-340"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335225"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T4"><span class="hs-identifier hs-var">T4</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335213"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; String
</span><a href="#local-6989586621679335050"><span class="hs-identifier hs-var">getFromJ</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T4"><span class="hs-identifier hs-var">T4</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335205"><span class="hs-identifier hs-var">e'</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T4"><span class="hs-identifier hs-var">T4</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335134"><span class="hs-identifier hs-var">pIndex'</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;1&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T4"><span class="hs-identifier hs-var">T4</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-341"></span><span>            </span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Y -&gt; Smb
</span><a href="SMType.html#SmbY%27"><span class="hs-identifier hs-var">SmbY'</span></a></span><span> </span><span class="annot"><span class="annottext">(Y -&gt; Smb) -&gt; Y -&gt; Smb
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Square -&gt; Y
</span><a href="SMType.html#Y"><span class="hs-identifier hs-var">Y</span></a></span><span> </span><span class="annot"><span class="annottext">Square
</span><a href="#local-6989586621679335053"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335225"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#TAlpha"><span class="hs-identifier hs-var">TAlpha</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335213"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; String
</span><a href="#local-6989586621679335046"><span class="hs-identifier hs-var">getToJ</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#TAlpha"><span class="hs-identifier hs-var">TAlpha</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335205"><span class="hs-identifier hs-var">e'</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#TAlpha"><span class="hs-identifier hs-var">TAlpha</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SMTag -&gt; Smb
</span><a href="#local-6989586621679335043"><span class="hs-identifier hs-var">p4</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#TAlpha"><span class="hs-identifier hs-var">TAlpha</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Y -&gt; Smb
</span><a href="SMType.html#SmbY%27"><span class="hs-identifier hs-var">SmbY'</span></a></span><span> </span><span class="annot"><span class="annottext">Y
</span><a href="SMType.html#Delta"><span class="hs-identifier hs-var">Delta</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-342"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335130"><span class="hs-identifier hs-var">qIndex'</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;1&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T4"><span class="hs-identifier hs-var">T4</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335126"><span class="hs-identifier hs-var">rIndex'</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;1&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T4"><span class="hs-identifier hs-var">T4</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335122"><span class="hs-identifier hs-var">sIndex'</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;1&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T4"><span class="hs-identifier hs-var">T4</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335118"><span class="hs-identifier hs-var">tIndex'</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;1&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T4"><span class="hs-identifier hs-var">T4</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335114"><span class="hs-identifier hs-var">uIndex'</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;1&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T4"><span class="hs-identifier hs-var">T4</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-343"></span><span>            </span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">SMTag -&gt; Smb
</span><a href="#local-6989586621679335042"><span class="hs-identifier hs-var">q4</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#TAlpha"><span class="hs-identifier hs-var">TAlpha</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SMTag -&gt; Smb
</span><a href="#local-6989586621679335041"><span class="hs-identifier hs-var">r4</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#TAlpha"><span class="hs-identifier hs-var">TAlpha</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SMTag -&gt; Smb
</span><a href="#local-6989586621679335040"><span class="hs-identifier hs-var">s4</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#TAlpha"><span class="hs-identifier hs-var">TAlpha</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SMTag -&gt; Smb
</span><a href="#local-6989586621679335039"><span class="hs-identifier hs-var">t4</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#TAlpha"><span class="hs-identifier hs-var">TAlpha</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SMTag -&gt; Smb
</span><a href="#local-6989586621679335038"><span class="hs-identifier hs-var">u4</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#TAlpha"><span class="hs-identifier hs-var">TAlpha</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-344"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335202"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T4"><span class="hs-identifier hs-var">T4</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335202"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#TAlpha"><span class="hs-identifier hs-var">TAlpha</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-345"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">SMTag -&gt; Smb
</span><a href="#local-6989586621679335209"><span class="hs-identifier hs-var">fl'</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T4"><span class="hs-identifier hs-var">T4</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">SMTag -&gt; Smb
</span><a href="#local-6989586621679335209"><span class="hs-identifier hs-var">fl'</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#TAlpha"><span class="hs-identifier hs-var">TAlpha</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-346"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">SMTag -&gt; Smb
</span><a href="#local-6989586621679335037"><span class="hs-identifier hs-var">pd4</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T4"><span class="hs-identifier hs-var">T4</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SMTag -&gt; Smb
</span><a href="#local-6989586621679335035"><span class="hs-identifier hs-var">qd4</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T4"><span class="hs-identifier hs-var">T4</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SMTag -&gt; Smb
</span><a href="#local-6989586621679335033"><span class="hs-identifier hs-var">rd4</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T4"><span class="hs-identifier hs-var">T4</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SMTag -&gt; Smb
</span><a href="#local-6989586621679335031"><span class="hs-identifier hs-var">sd4</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T4"><span class="hs-identifier hs-var">T4</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SMTag -&gt; Smb
</span><a href="#local-6989586621679335029"><span class="hs-identifier hs-var">td4</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T4"><span class="hs-identifier hs-var">T4</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SMTag -&gt; Smb
</span><a href="#local-6989586621679335027"><span class="hs-identifier hs-var">ud4</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T4"><span class="hs-identifier hs-var">T4</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335217"><span class="hs-identifier hs-var">f'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; String
</span><a href="#local-6989586621679335050"><span class="hs-identifier hs-var">getFromJ</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T4"><span class="hs-identifier hs-var">T4</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-347"></span><span>            </span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">SMTag -&gt; Smb
</span><a href="#local-6989586621679335037"><span class="hs-identifier hs-var">pd4</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#TAlpha"><span class="hs-identifier hs-var">TAlpha</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SMTag -&gt; Smb
</span><a href="#local-6989586621679335035"><span class="hs-identifier hs-var">qd4</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#TAlpha"><span class="hs-identifier hs-var">TAlpha</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SMTag -&gt; Smb
</span><a href="#local-6989586621679335033"><span class="hs-identifier hs-var">rd4</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#TAlpha"><span class="hs-identifier hs-var">TAlpha</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SMTag -&gt; Smb
</span><a href="#local-6989586621679335031"><span class="hs-identifier hs-var">sd4</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#TAlpha"><span class="hs-identifier hs-var">TAlpha</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SMTag -&gt; Smb
</span><a href="#local-6989586621679335029"><span class="hs-identifier hs-var">td4</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#TAlpha"><span class="hs-identifier hs-var">TAlpha</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SMTag -&gt; Smb
</span><a href="#local-6989586621679335027"><span class="hs-identifier hs-var">ud4</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#TAlpha"><span class="hs-identifier hs-var">TAlpha</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335217"><span class="hs-identifier hs-var">f'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; String
</span><a href="#local-6989586621679335046"><span class="hs-identifier hs-var">getToJ</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#TAlpha"><span class="hs-identifier hs-var">TAlpha</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-348"></span><span>            </span><span class="annot"><span class="annottext">([(Word, Word)] -&gt; [(Word, Word)])
-&gt; [(Word, Word)] -&gt; [(Word, Word)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[[(Word, Word)]] -&gt; [(Word, Word)]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span>
</span><span id="line-349"></span><span>            </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335202"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335002"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T4"><span class="hs-identifier hs-var">T4</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335202"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335002"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#TAlpha"><span class="hs-identifier hs-var">TAlpha</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-350"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335225"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335002"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T4"><span class="hs-identifier hs-var">T4</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335213"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; String
</span><a href="#local-6989586621679335050"><span class="hs-identifier hs-var">getFromJ</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335002"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335002"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T4"><span class="hs-identifier hs-var">T4</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335205"><span class="hs-identifier hs-var">e'</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335002"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T4"><span class="hs-identifier hs-var">T4</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335199"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335002"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T4"><span class="hs-identifier hs-var">T4</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-351"></span><span>            </span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335225"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335002"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#TAlpha"><span class="hs-identifier hs-var">TAlpha</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335213"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; String
</span><a href="#local-6989586621679335046"><span class="hs-identifier hs-var">getToJ</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335002"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335002"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#TAlpha"><span class="hs-identifier hs-var">TAlpha</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335205"><span class="hs-identifier hs-var">e'</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335002"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#TAlpha"><span class="hs-identifier hs-var">TAlpha</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335199"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335002"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#TAlpha"><span class="hs-identifier hs-var">TAlpha</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-352"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335196"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335002"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T4"><span class="hs-identifier hs-var">T4</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335193"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335002"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T4"><span class="hs-identifier hs-var">T4</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335190"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335002"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T4"><span class="hs-identifier hs-var">T4</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335187"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335002"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T4"><span class="hs-identifier hs-var">T4</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335184"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335002"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T4"><span class="hs-identifier hs-var">T4</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335181"><span class="hs-identifier hs-var">pd</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335002"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T4"><span class="hs-identifier hs-var">T4</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335177"><span class="hs-identifier hs-var">qd</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335002"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T4"><span class="hs-identifier hs-var">T4</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335174"><span class="hs-identifier hs-var">rd</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335002"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T4"><span class="hs-identifier hs-var">T4</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335171"><span class="hs-identifier hs-var">sd</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335002"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T4"><span class="hs-identifier hs-var">T4</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335168"><span class="hs-identifier hs-var">td</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335002"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T4"><span class="hs-identifier hs-var">T4</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335165"><span class="hs-identifier hs-var">ud</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335002"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T4"><span class="hs-identifier hs-var">T4</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335217"><span class="hs-identifier hs-var">f'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; String
</span><a href="#local-6989586621679335050"><span class="hs-identifier hs-var">getFromJ</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335002"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335002"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T4"><span class="hs-identifier hs-var">T4</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-353"></span><span>            </span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335196"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335002"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#TAlpha"><span class="hs-identifier hs-var">TAlpha</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335193"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335002"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#TAlpha"><span class="hs-identifier hs-var">TAlpha</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335190"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335002"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#TAlpha"><span class="hs-identifier hs-var">TAlpha</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335187"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335002"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#TAlpha"><span class="hs-identifier hs-var">TAlpha</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335184"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335002"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#TAlpha"><span class="hs-identifier hs-var">TAlpha</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335181"><span class="hs-identifier hs-var">pd</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335002"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#TAlpha"><span class="hs-identifier hs-var">TAlpha</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335177"><span class="hs-identifier hs-var">qd</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335002"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#TAlpha"><span class="hs-identifier hs-var">TAlpha</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335174"><span class="hs-identifier hs-var">rd</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335002"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#TAlpha"><span class="hs-identifier hs-var">TAlpha</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335171"><span class="hs-identifier hs-var">sd</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335002"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#TAlpha"><span class="hs-identifier hs-var">TAlpha</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335168"><span class="hs-identifier hs-var">td</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335002"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#TAlpha"><span class="hs-identifier hs-var">TAlpha</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335165"><span class="hs-identifier hs-var">ud</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335002"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#TAlpha"><span class="hs-identifier hs-var">TAlpha</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335217"><span class="hs-identifier hs-var">f'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; String
</span><a href="#local-6989586621679335046"><span class="hs-identifier hs-var">getToJ</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335002"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335002"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#TAlpha"><span class="hs-identifier hs-var">TAlpha</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-354"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679335002"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335002"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; [Int] -&gt; [Int]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335231"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-355"></span><span>
</span><span id="line-356"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679335001"><span class="annot"><span class="annottext">changeMachine :: SMTag -&gt; SMTag -&gt; [(Word, Word)]
</span><a href="#local-6989586621679335001"><span class="hs-identifier hs-var hs-var">changeMachine</span></a></span></span><span> </span><span id="local-6989586621679335000"><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335000"><span class="hs-identifier hs-var">from</span></a></span></span><span> </span><span id="local-6989586621679334999"><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679334999"><span class="hs-identifier hs-var">to</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-357"></span><span>            </span><span class="annot"><span class="annottext">[(Word, Word)] -&gt; [(Word, Word)] -&gt; [(Word, Word)]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">(++)</span></span><span>
</span><span id="line-358"></span><span>            </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335202"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335000"><span class="hs-identifier hs-var">from</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335202"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679334999"><span class="hs-identifier hs-var">to</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-359"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335225"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335000"><span class="hs-identifier hs-var">from</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335213"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; String
</span><a href="#local-6989586621679335046"><span class="hs-identifier hs-var">getToJ</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335000"><span class="hs-identifier hs-var">from</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335205"><span class="hs-identifier hs-var">e'</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335000"><span class="hs-identifier hs-var">from</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SMTag -&gt; Smb
</span><a href="#local-6989586621679335043"><span class="hs-identifier hs-var">p4</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335000"><span class="hs-identifier hs-var">from</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-360"></span><span>            </span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335225"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679334999"><span class="hs-identifier hs-var">to</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335213"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; String
</span><a href="#local-6989586621679335046"><span class="hs-identifier hs-var">getToJ</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679334999"><span class="hs-identifier hs-var">to</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335205"><span class="hs-identifier hs-var">e'</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679334999"><span class="hs-identifier hs-var">to</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SMTag -&gt; Smb
</span><a href="#local-6989586621679335043"><span class="hs-identifier hs-var">p4</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679334999"><span class="hs-identifier hs-var">to</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-361"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">SMTag -&gt; Smb
</span><a href="#local-6989586621679335042"><span class="hs-identifier hs-var">q4</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335000"><span class="hs-identifier hs-var">from</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SMTag -&gt; Smb
</span><a href="#local-6989586621679335041"><span class="hs-identifier hs-var">r4</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335000"><span class="hs-identifier hs-var">from</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SMTag -&gt; Smb
</span><a href="#local-6989586621679335040"><span class="hs-identifier hs-var">s4</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335000"><span class="hs-identifier hs-var">from</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SMTag -&gt; Smb
</span><a href="#local-6989586621679335039"><span class="hs-identifier hs-var">t4</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335000"><span class="hs-identifier hs-var">from</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SMTag -&gt; Smb
</span><a href="#local-6989586621679335038"><span class="hs-identifier hs-var">u4</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335000"><span class="hs-identifier hs-var">from</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SMTag -&gt; Smb
</span><a href="#local-6989586621679335037"><span class="hs-identifier hs-var">pd4</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335000"><span class="hs-identifier hs-var">from</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SMTag -&gt; Smb
</span><a href="#local-6989586621679335035"><span class="hs-identifier hs-var">qd4</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335000"><span class="hs-identifier hs-var">from</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SMTag -&gt; Smb
</span><a href="#local-6989586621679335033"><span class="hs-identifier hs-var">rd4</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335000"><span class="hs-identifier hs-var">from</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SMTag -&gt; Smb
</span><a href="#local-6989586621679335031"><span class="hs-identifier hs-var">sd4</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335000"><span class="hs-identifier hs-var">from</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SMTag -&gt; Smb
</span><a href="#local-6989586621679335029"><span class="hs-identifier hs-var">td4</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335000"><span class="hs-identifier hs-var">from</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SMTag -&gt; Smb
</span><a href="#local-6989586621679335027"><span class="hs-identifier hs-var">ud4</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335000"><span class="hs-identifier hs-var">from</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335217"><span class="hs-identifier hs-var">f'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; String
</span><a href="#local-6989586621679335046"><span class="hs-identifier hs-var">getToJ</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335000"><span class="hs-identifier hs-var">from</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-362"></span><span>            </span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">SMTag -&gt; Smb
</span><a href="#local-6989586621679335042"><span class="hs-identifier hs-var">q4</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679334999"><span class="hs-identifier hs-var">to</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SMTag -&gt; Smb
</span><a href="#local-6989586621679335041"><span class="hs-identifier hs-var">r4</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679334999"><span class="hs-identifier hs-var">to</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SMTag -&gt; Smb
</span><a href="#local-6989586621679335040"><span class="hs-identifier hs-var">s4</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679334999"><span class="hs-identifier hs-var">to</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SMTag -&gt; Smb
</span><a href="#local-6989586621679335039"><span class="hs-identifier hs-var">t4</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679334999"><span class="hs-identifier hs-var">to</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SMTag -&gt; Smb
</span><a href="#local-6989586621679335038"><span class="hs-identifier hs-var">u4</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679334999"><span class="hs-identifier hs-var">to</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SMTag -&gt; Smb
</span><a href="#local-6989586621679335037"><span class="hs-identifier hs-var">pd4</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679334999"><span class="hs-identifier hs-var">to</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SMTag -&gt; Smb
</span><a href="#local-6989586621679335035"><span class="hs-identifier hs-var">qd4</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679334999"><span class="hs-identifier hs-var">to</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SMTag -&gt; Smb
</span><a href="#local-6989586621679335033"><span class="hs-identifier hs-var">rd4</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679334999"><span class="hs-identifier hs-var">to</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SMTag -&gt; Smb
</span><a href="#local-6989586621679335031"><span class="hs-identifier hs-var">sd4</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679334999"><span class="hs-identifier hs-var">to</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SMTag -&gt; Smb
</span><a href="#local-6989586621679335029"><span class="hs-identifier hs-var">td4</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679334999"><span class="hs-identifier hs-var">to</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SMTag -&gt; Smb
</span><a href="#local-6989586621679335027"><span class="hs-identifier hs-var">ud4</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679334999"><span class="hs-identifier hs-var">to</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335217"><span class="hs-identifier hs-var">f'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; String
</span><a href="#local-6989586621679335046"><span class="hs-identifier hs-var">getToJ</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679334999"><span class="hs-identifier hs-var">to</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-363"></span><span>            </span><span class="annot"><span class="annottext">([(Word, Word)] -&gt; [(Word, Word)])
-&gt; [(Word, Word)] -&gt; [(Word, Word)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[[(Word, Word)]] -&gt; [(Word, Word)]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span>
</span><span id="line-364"></span><span>            </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335202"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334998"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335000"><span class="hs-identifier hs-var">from</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335202"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334998"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679334999"><span class="hs-identifier hs-var">to</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-365"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335225"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334998"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335000"><span class="hs-identifier hs-var">from</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335213"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; String
</span><a href="#local-6989586621679335046"><span class="hs-identifier hs-var">getToJ</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334998"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334998"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335000"><span class="hs-identifier hs-var">from</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335205"><span class="hs-identifier hs-var">e'</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334998"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335000"><span class="hs-identifier hs-var">from</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335199"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334998"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335000"><span class="hs-identifier hs-var">from</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-366"></span><span>            </span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335225"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334998"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679334999"><span class="hs-identifier hs-var">to</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335213"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; String
</span><a href="#local-6989586621679335046"><span class="hs-identifier hs-var">getToJ</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334998"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334998"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679334999"><span class="hs-identifier hs-var">to</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335205"><span class="hs-identifier hs-var">e'</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334998"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679334999"><span class="hs-identifier hs-var">to</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335199"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334998"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679334999"><span class="hs-identifier hs-var">to</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-367"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335196"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334998"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335000"><span class="hs-identifier hs-var">from</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335193"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334998"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335000"><span class="hs-identifier hs-var">from</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335190"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334998"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335000"><span class="hs-identifier hs-var">from</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335187"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334998"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335000"><span class="hs-identifier hs-var">from</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335184"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334998"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335000"><span class="hs-identifier hs-var">from</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335181"><span class="hs-identifier hs-var">pd</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334998"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335000"><span class="hs-identifier hs-var">from</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335177"><span class="hs-identifier hs-var">qd</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334998"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335000"><span class="hs-identifier hs-var">from</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335174"><span class="hs-identifier hs-var">rd</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334998"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335000"><span class="hs-identifier hs-var">from</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335171"><span class="hs-identifier hs-var">sd</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334998"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335000"><span class="hs-identifier hs-var">from</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335168"><span class="hs-identifier hs-var">td</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334998"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335000"><span class="hs-identifier hs-var">from</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335165"><span class="hs-identifier hs-var">ud</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334998"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335000"><span class="hs-identifier hs-var">from</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335217"><span class="hs-identifier hs-var">f'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; String
</span><a href="#local-6989586621679335046"><span class="hs-identifier hs-var">getToJ</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334998"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334998"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679335000"><span class="hs-identifier hs-var">from</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-368"></span><span>            </span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335196"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334998"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679334999"><span class="hs-identifier hs-var">to</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335193"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334998"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679334999"><span class="hs-identifier hs-var">to</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335190"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334998"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679334999"><span class="hs-identifier hs-var">to</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335187"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334998"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679334999"><span class="hs-identifier hs-var">to</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335184"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334998"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679334999"><span class="hs-identifier hs-var">to</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335181"><span class="hs-identifier hs-var">pd</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334998"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679334999"><span class="hs-identifier hs-var">to</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335177"><span class="hs-identifier hs-var">qd</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334998"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679334999"><span class="hs-identifier hs-var">to</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335174"><span class="hs-identifier hs-var">rd</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334998"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679334999"><span class="hs-identifier hs-var">to</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335171"><span class="hs-identifier hs-var">sd</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334998"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679334999"><span class="hs-identifier hs-var">to</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335168"><span class="hs-identifier hs-var">td</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334998"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679334999"><span class="hs-identifier hs-var">to</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335165"><span class="hs-identifier hs-var">ud</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334998"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679334999"><span class="hs-identifier hs-var">to</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335217"><span class="hs-identifier hs-var">f'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; String
</span><a href="#local-6989586621679335046"><span class="hs-identifier hs-var">getToJ</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334998"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334998"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679334999"><span class="hs-identifier hs-var">to</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-369"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679334998"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334998"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; [Int] -&gt; [Int]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335231"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-370"></span><span>
</span><span id="line-371"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679334997"><span class="annot"><span class="annottext">rulealphaomega :: SRule
</span><a href="#local-6989586621679334997"><span class="hs-identifier hs-var hs-var">rulealphaomega</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-372"></span><span>            </span><span class="annot"><span class="annottext">[(Word, Word)] -&gt; SRule
</span><a href="SMType.html#SRule"><span class="hs-identifier hs-var">SRule</span></a></span><span> </span><span class="annot"><span class="annottext">([(Word, Word)] -&gt; SRule) -&gt; [(Word, Word)] -&gt; SRule
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(Word, Word)] -&gt; [(Word, Word)] -&gt; [(Word, Word)]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">(++)</span></span><span>
</span><span id="line-373"></span><span>            </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335202"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#TAlpha"><span class="hs-identifier hs-var">TAlpha</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335202"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#TOmega"><span class="hs-identifier hs-var">TOmega</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-374"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335138"><span class="hs-identifier hs-var">xIndex</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;2&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#TAlpha"><span class="hs-identifier hs-var">TAlpha</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SMTag -&gt; Smb
</span><a href="#local-6989586621679335207"><span class="hs-identifier hs-var">f0</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#TAlpha"><span class="hs-identifier hs-var">TAlpha</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335225"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#TOmega"><span class="hs-identifier hs-var">TOmega</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SMTag -&gt; Smb
</span><a href="#local-6989586621679335207"><span class="hs-identifier hs-var">f0</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#TOmega"><span class="hs-identifier hs-var">TOmega</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-375"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335205"><span class="hs-identifier hs-var">e'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335231"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#TAlpha"><span class="hs-identifier hs-var">TAlpha</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335221"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335231"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#TAlpha"><span class="hs-identifier hs-var">TAlpha</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335205"><span class="hs-identifier hs-var">e'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335231"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#TOmega"><span class="hs-identifier hs-var">TOmega</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335221"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335231"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#TOmega"><span class="hs-identifier hs-var">TOmega</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-376"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">SMTag -&gt; Smb
</span><a href="#local-6989586621679335209"><span class="hs-identifier hs-var">fl'</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#TAlpha"><span class="hs-identifier hs-var">TAlpha</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">SMTag -&gt; Smb
</span><a href="#local-6989586621679335209"><span class="hs-identifier hs-var">fl'</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#TOmega"><span class="hs-identifier hs-var">TOmega</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-377"></span><span>            </span><span class="annot"><span class="annottext">([(Word, Word)] -&gt; [(Word, Word)])
-&gt; [(Word, Word)] -&gt; [(Word, Word)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SMTag -&gt; SMTag -&gt; [(Word, Word)]
</span><a href="#local-6989586621679335001"><span class="hs-identifier hs-var">changeMachine</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#TAlpha"><span class="hs-identifier hs-var">TAlpha</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#TOmega"><span class="hs-identifier hs-var">TOmega</span></a></span><span>
</span><span id="line-378"></span><span>
</span><span id="line-379"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679334995"><span class="annot"><span class="annottext">ruleomega9 :: SRule
</span><a href="#local-6989586621679334995"><span class="hs-identifier hs-var hs-var">ruleomega9</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-380"></span><span>            </span><span class="annot"><span class="annottext">[(Word, Word)] -&gt; SRule
</span><a href="SMType.html#SRule"><span class="hs-identifier hs-var">SRule</span></a></span><span> </span><span class="annot"><span class="annottext">([(Word, Word)] -&gt; SRule) -&gt; [(Word, Word)] -&gt; SRule
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(Word, Word)] -&gt; [(Word, Word)] -&gt; [(Word, Word)]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">(++)</span></span><span>
</span><span id="line-381"></span><span>            </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335202"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#TOmega"><span class="hs-identifier hs-var">TOmega</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335202"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T9"><span class="hs-identifier hs-var">T9</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-382"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335225"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#TOmega"><span class="hs-identifier hs-var">TOmega</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SMTag -&gt; Smb
</span><a href="#local-6989586621679335207"><span class="hs-identifier hs-var">f0</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#TOmega"><span class="hs-identifier hs-var">TOmega</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335225"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T9"><span class="hs-identifier hs-var">T9</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SMTag -&gt; Smb
</span><a href="#local-6989586621679335207"><span class="hs-identifier hs-var">f0</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T9"><span class="hs-identifier hs-var">T9</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-383"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335205"><span class="hs-identifier hs-var">e'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335231"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#TOmega"><span class="hs-identifier hs-var">TOmega</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335110"><span class="hs-identifier hs-var">xIndex'</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;2&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335231"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#TOmega"><span class="hs-identifier hs-var">TOmega</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335205"><span class="hs-identifier hs-var">e'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335231"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T9"><span class="hs-identifier hs-var">T9</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335221"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335231"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T9"><span class="hs-identifier hs-var">T9</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-384"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">SMTag -&gt; Smb
</span><a href="#local-6989586621679335209"><span class="hs-identifier hs-var">fl'</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#TOmega"><span class="hs-identifier hs-var">TOmega</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">SMTag -&gt; Smb
</span><a href="#local-6989586621679335209"><span class="hs-identifier hs-var">fl'</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T9"><span class="hs-identifier hs-var">T9</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-385"></span><span>            </span><span class="annot"><span class="annottext">([(Word, Word)] -&gt; [(Word, Word)])
-&gt; [(Word, Word)] -&gt; [(Word, Word)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SMTag -&gt; SMTag -&gt; [(Word, Word)]
</span><a href="#local-6989586621679335001"><span class="hs-identifier hs-var">changeMachine</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#TOmega"><span class="hs-identifier hs-var">TOmega</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T9"><span class="hs-identifier hs-var">T9</span></a></span><span>
</span><span id="line-386"></span><span>
</span><span id="line-387"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679334993"><span class="annot"><span class="annottext">rule9 :: SRule
</span><a href="#local-6989586621679334993"><span class="hs-identifier hs-var hs-var">rule9</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-388"></span><span>            </span><span class="annot"><span class="annottext">[(Word, Word)] -&gt; SRule
</span><a href="SMType.html#SRule"><span class="hs-identifier hs-var">SRule</span></a></span><span> </span><span class="annot"><span class="annottext">([(Word, Word)] -&gt; SRule) -&gt; [(Word, Word)] -&gt; SRule
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(Word, Word)] -&gt; [(Word, Word)] -&gt; [(Word, Word)]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">(++)</span></span><span>
</span><span id="line-389"></span><span>            </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335202"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T9"><span class="hs-identifier hs-var">T9</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eE"><span class="hs-identifier hs-var">eE</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-390"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335225"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T9"><span class="hs-identifier hs-var">T9</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SMTag -&gt; Smb
</span><a href="#local-6989586621679335207"><span class="hs-identifier hs-var">f0</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T9"><span class="hs-identifier hs-var">T9</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eX"><span class="hs-identifier hs-var">eX</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span>  </span><span class="annot"><span class="annottext">Smb
</span><a href="#local-6989586621679335230"><span class="hs-identifier hs-var">eF0</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-391"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335205"><span class="hs-identifier hs-var">e'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335231"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T9"><span class="hs-identifier hs-var">T9</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335221"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335231"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T9"><span class="hs-identifier hs-var">T9</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eE%27"><span class="hs-identifier hs-var">eE'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335231"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eX%27"><span class="hs-identifier hs-var">eX'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335231"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-392"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">SMTag -&gt; Smb
</span><a href="#local-6989586621679335209"><span class="hs-identifier hs-var">fl'</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T9"><span class="hs-identifier hs-var">T9</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Smb
</span><a href="#local-6989586621679335228"><span class="hs-identifier hs-var">eFl'</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-393"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335202"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T9"><span class="hs-identifier hs-var">T9</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eE"><span class="hs-identifier hs-var">eE</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-394"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335081"><span class="hs-identifier hs-var">xh</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T9"><span class="hs-identifier hs-var">T9</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335213"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; String
</span><a href="#local-6989586621679335046"><span class="hs-identifier hs-var">getToJ</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T9"><span class="hs-identifier hs-var">T9</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335205"><span class="hs-identifier hs-var">e'</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T9"><span class="hs-identifier hs-var">T9</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335106"><span class="hs-identifier hs-var">phIndex</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;1&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T9"><span class="hs-identifier hs-var">T9</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-395"></span><span>            </span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eX"><span class="hs-identifier hs-var">eX</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eF"><span class="hs-identifier hs-var">eF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; String
</span><a href="#local-6989586621679335046"><span class="hs-identifier hs-var">getToJ</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eE%27"><span class="hs-identifier hs-var">eE'</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eP"><span class="hs-identifier hs-var">eP</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-396"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335101"><span class="hs-identifier hs-var">qhIndex</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;1&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T9"><span class="hs-identifier hs-var">T9</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335097"><span class="hs-identifier hs-var">rhIndex</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;1&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T9"><span class="hs-identifier hs-var">T9</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335093"><span class="hs-identifier hs-var">shIndex</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;1&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T9"><span class="hs-identifier hs-var">T9</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335089"><span class="hs-identifier hs-var">thIndex</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;1&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T9"><span class="hs-identifier hs-var">T9</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335085"><span class="hs-identifier hs-var">uhIndex</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;1&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T9"><span class="hs-identifier hs-var">T9</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335078"><span class="hs-identifier hs-var">phdIndex</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;0&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T9"><span class="hs-identifier hs-var">T9</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335073"><span class="hs-identifier hs-var">qhdIndex</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;0&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T9"><span class="hs-identifier hs-var">T9</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335069"><span class="hs-identifier hs-var">rhdIndex</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;0&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T9"><span class="hs-identifier hs-var">T9</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335065"><span class="hs-identifier hs-var">shdIndex</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;0&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T9"><span class="hs-identifier hs-var">T9</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335061"><span class="hs-identifier hs-var">thdIndex</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;0&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T9"><span class="hs-identifier hs-var">T9</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335057"><span class="hs-identifier hs-var">uhdIndex</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;0&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T9"><span class="hs-identifier hs-var">T9</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335217"><span class="hs-identifier hs-var">f'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; String
</span><a href="#local-6989586621679335046"><span class="hs-identifier hs-var">getToJ</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T9"><span class="hs-identifier hs-var">T9</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-397"></span><span>            </span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eQ"><span class="hs-identifier hs-var">eQ</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eR"><span class="hs-identifier hs-var">eR</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eS"><span class="hs-identifier hs-var">eS</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eT"><span class="hs-identifier hs-var">eT</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eU"><span class="hs-identifier hs-var">eU</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#ePd"><span class="hs-identifier hs-var">ePd</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eQd"><span class="hs-identifier hs-var">eQd</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eRd"><span class="hs-identifier hs-var">eRd</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eSd"><span class="hs-identifier hs-var">eSd</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eTd"><span class="hs-identifier hs-var">eTd</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eUd"><span class="hs-identifier hs-var">eUd</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eF%27"><span class="hs-identifier hs-var">eF'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; String
</span><a href="#local-6989586621679335046"><span class="hs-identifier hs-var">getToJ</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-398"></span><span>            </span><span class="annot"><span class="annottext">([(Word, Word)] -&gt; [(Word, Word)])
-&gt; [(Word, Word)] -&gt; [(Word, Word)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[[(Word, Word)]] -&gt; [(Word, Word)]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span>
</span><span id="line-399"></span><span>            </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335202"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334992"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T9"><span class="hs-identifier hs-var">T9</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eE"><span class="hs-identifier hs-var">eE</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334992"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-400"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335225"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334992"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T9"><span class="hs-identifier hs-var">T9</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335213"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; String
</span><a href="#local-6989586621679335046"><span class="hs-identifier hs-var">getToJ</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334992"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334992"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T9"><span class="hs-identifier hs-var">T9</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335205"><span class="hs-identifier hs-var">e'</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334992"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T9"><span class="hs-identifier hs-var">T9</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335199"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334992"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T9"><span class="hs-identifier hs-var">T9</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-401"></span><span>            </span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eX"><span class="hs-identifier hs-var">eX</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334992"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eF"><span class="hs-identifier hs-var">eF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; String
</span><a href="#local-6989586621679335046"><span class="hs-identifier hs-var">getToJ</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334992"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334992"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eE%27"><span class="hs-identifier hs-var">eE'</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334992"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eP"><span class="hs-identifier hs-var">eP</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334992"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-402"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335196"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334992"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T9"><span class="hs-identifier hs-var">T9</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335193"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334992"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T9"><span class="hs-identifier hs-var">T9</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335190"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334992"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T9"><span class="hs-identifier hs-var">T9</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335187"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334992"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T9"><span class="hs-identifier hs-var">T9</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335184"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334992"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T9"><span class="hs-identifier hs-var">T9</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335181"><span class="hs-identifier hs-var">pd</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334992"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T9"><span class="hs-identifier hs-var">T9</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335177"><span class="hs-identifier hs-var">qd</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334992"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T9"><span class="hs-identifier hs-var">T9</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335174"><span class="hs-identifier hs-var">rd</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334992"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T9"><span class="hs-identifier hs-var">T9</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335171"><span class="hs-identifier hs-var">sd</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334992"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T9"><span class="hs-identifier hs-var">T9</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335168"><span class="hs-identifier hs-var">td</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334992"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T9"><span class="hs-identifier hs-var">T9</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335165"><span class="hs-identifier hs-var">ud</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334992"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T9"><span class="hs-identifier hs-var">T9</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; SMTag -&gt; Smb
</span><a href="#local-6989586621679335217"><span class="hs-identifier hs-var">f'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; String
</span><a href="#local-6989586621679335046"><span class="hs-identifier hs-var">getToJ</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334992"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334992"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T9"><span class="hs-identifier hs-var">T9</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-403"></span><span>            </span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eQ"><span class="hs-identifier hs-var">eQ</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334992"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eR"><span class="hs-identifier hs-var">eR</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334992"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eS"><span class="hs-identifier hs-var">eS</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334992"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eT"><span class="hs-identifier hs-var">eT</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334992"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eU"><span class="hs-identifier hs-var">eU</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334992"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#ePd"><span class="hs-identifier hs-var">ePd</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334992"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eQd"><span class="hs-identifier hs-var">eQd</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334992"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eRd"><span class="hs-identifier hs-var">eRd</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334992"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eSd"><span class="hs-identifier hs-var">eSd</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334992"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eTd"><span class="hs-identifier hs-var">eTd</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334992"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eUd"><span class="hs-identifier hs-var">eUd</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334992"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eF%27"><span class="hs-identifier hs-var">eF'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; String
</span><a href="#local-6989586621679335046"><span class="hs-identifier hs-var">getToJ</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334992"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334992"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-404"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679334992"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334992"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; [Int] -&gt; [Int]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335052"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679335231"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-405"></span><span>
</span><span id="line-406"></span><span>    </span><span class="hs-special">[</span><span class="annot"><span class="annottext">SRule
</span><a href="#local-6989586621679335025"><span class="hs-identifier hs-var">rule4</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SRule
</span><a href="#local-6989586621679335005"><span class="hs-identifier hs-var">rule4alpha</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SRule
</span><a href="#local-6989586621679334997"><span class="hs-identifier hs-var">rulealphaomega</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SRule
</span><a href="#local-6989586621679334995"><span class="hs-identifier hs-var">ruleomega9</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SRule
</span><a href="#local-6989586621679334993"><span class="hs-identifier hs-var">rule9</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-407"></span><span>
</span><span id="line-408"></span><span class="annot"><a href="TM2SM.html#genPos22Rule"><span class="hs-identifier hs-type">genPos22Rule</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="SMType.html#TMCMD"><span class="hs-identifier hs-type">TMCMD</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="SMType.html#SRule"><span class="hs-identifier hs-type">SRule</span></a></span><span>
</span><span id="line-409"></span><span id="genPos22Rule"><span class="annot"><span class="annottext">genPos22Rule :: TMCMD -&gt; SRule
</span><a href="TM2SM.html#genPos22Rule"><span class="hs-identifier hs-var hs-var">genPos22Rule</span></a></span></span><span> </span><span id="local-6989586621679334990"><span class="annot"><span class="annottext">TMCMD
</span><a href="#local-6989586621679334990"><span class="hs-identifier hs-var">cmd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-410"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="SMType.html#Command"><span class="hs-identifier hs-type">Command</span></a></span><span> </span><span id="local-6989586621679334989"><span class="annot"><span class="annottext">[TapeCommand]
</span><a href="#local-6989586621679334989"><span class="hs-identifier hs-var">command</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TMCMD
</span><a href="#local-6989586621679334990"><span class="hs-identifier hs-var">cmd</span></a></span><span>
</span><span id="line-411"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679334988"><span class="annot"><span class="annottext">k :: Int
</span><a href="#local-6989586621679334988"><span class="hs-identifier hs-var hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TapeCommand] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[TapeCommand]
</span><a href="#local-6989586621679334989"><span class="hs-identifier hs-var">command</span></a></span><span>
</span><span id="line-412"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Square
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679334987"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334987"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TapeCommand] -&gt; (Square, Int)
</span><a href="TM2SMHelpers.html#getai"><span class="hs-identifier hs-var">getai</span></a></span><span> </span><span class="annot"><span class="annottext">[TapeCommand]
</span><a href="#local-6989586621679334989"><span class="hs-identifier hs-var">command</span></a></span><span>
</span><span id="line-413"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679334986"><span class="annot"><span class="annottext">getFromJ :: Int -&gt; String
</span><a href="#local-6989586621679334986"><span class="hs-identifier hs-var hs-var">getFromJ</span></a></span></span><span> </span><span id="local-6989586621679334985"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334985"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679334984"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679334984"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679334984"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TapeCommand] -&gt; Int -&gt; (String, String)
</span><a href="TM2SMHelpers.html#getJIdx"><span class="hs-identifier hs-var">getJIdx</span></a></span><span> </span><span class="annot"><span class="annottext">[TapeCommand]
</span><a href="#local-6989586621679334989"><span class="hs-identifier hs-var">command</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334985"><span class="hs-identifier hs-var">j</span></a></span><span>
</span><span id="line-414"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679334983"><span class="annot"><span class="annottext">getToJ :: Int -&gt; String
</span><a href="#local-6989586621679334983"><span class="hs-identifier hs-var hs-var">getToJ</span></a></span></span><span> </span><span id="local-6989586621679334982"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334982"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679334981"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679334981"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679334981"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TapeCommand] -&gt; Int -&gt; (String, String)
</span><a href="TM2SMHelpers.html#getJIdx"><span class="hs-identifier hs-var">getJIdx</span></a></span><span> </span><span class="annot"><span class="annottext">[TapeCommand]
</span><a href="#local-6989586621679334989"><span class="hs-identifier hs-var">command</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334982"><span class="hs-identifier hs-var">j</span></a></span><span>
</span><span id="line-415"></span><span>    </span><span class="annot"><span class="annottext">[(Word, Word)] -&gt; SRule
</span><a href="SMType.html#SRule"><span class="hs-identifier hs-var">SRule</span></a></span><span> </span><span class="annot"><span class="annottext">([(Word, Word)] -&gt; SRule) -&gt; [(Word, Word)] -&gt; SRule
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(Word, Word)] -&gt; [(Word, Word)] -&gt; [(Word, Word)]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">(++)</span></span><span>
</span><span id="line-416"></span><span>        </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eE"><span class="hs-identifier hs-var">eE</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334987"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eX"><span class="hs-identifier hs-var">eX</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334987"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eF"><span class="hs-identifier hs-var">eF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; String
</span><a href="#local-6989586621679334986"><span class="hs-identifier hs-var">getFromJ</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334987"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334987"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eE%27"><span class="hs-identifier hs-var">eE'</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334987"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eP"><span class="hs-identifier hs-var">eP</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334987"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eQ"><span class="hs-identifier hs-var">eQ</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334987"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eR"><span class="hs-identifier hs-var">eR</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334987"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eS"><span class="hs-identifier hs-var">eS</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334987"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eT"><span class="hs-identifier hs-var">eT</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334987"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eU"><span class="hs-identifier hs-var">eU</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334987"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#ePd"><span class="hs-identifier hs-var">ePd</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334987"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eQd"><span class="hs-identifier hs-var">eQd</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334987"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eRd"><span class="hs-identifier hs-var">eRd</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334987"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eSd"><span class="hs-identifier hs-var">eSd</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334987"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eTd"><span class="hs-identifier hs-var">eTd</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334987"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eUd"><span class="hs-identifier hs-var">eUd</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334987"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eF%27"><span class="hs-identifier hs-var">eF'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; String
</span><a href="#local-6989586621679334986"><span class="hs-identifier hs-var">getFromJ</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334987"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334987"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-417"></span><span>        </span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eE"><span class="hs-identifier hs-var">eE</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334987"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eX"><span class="hs-identifier hs-var">eX</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334987"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eF"><span class="hs-identifier hs-var">eF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; String
</span><a href="#local-6989586621679334983"><span class="hs-identifier hs-var">getToJ</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334987"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334987"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eE%27"><span class="hs-identifier hs-var">eE'</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334987"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eP"><span class="hs-identifier hs-var">eP</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334987"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eQ"><span class="hs-identifier hs-var">eQ</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334987"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eR"><span class="hs-identifier hs-var">eR</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334987"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eS"><span class="hs-identifier hs-var">eS</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334987"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eT"><span class="hs-identifier hs-var">eT</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334987"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eU"><span class="hs-identifier hs-var">eU</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334987"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#ePd"><span class="hs-identifier hs-var">ePd</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334987"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eQd"><span class="hs-identifier hs-var">eQd</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334987"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eRd"><span class="hs-identifier hs-var">eRd</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334987"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eSd"><span class="hs-identifier hs-var">eSd</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334987"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eTd"><span class="hs-identifier hs-var">eTd</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334987"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eUd"><span class="hs-identifier hs-var">eUd</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334987"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eF%27"><span class="hs-identifier hs-var">eF'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; String
</span><a href="#local-6989586621679334983"><span class="hs-identifier hs-var">getToJ</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334987"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334987"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-418"></span><span>        </span><span class="annot"><span class="annottext">([(Word, Word)] -&gt; [(Word, Word)])
-&gt; [(Word, Word)] -&gt; [(Word, Word)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[[(Word, Word)]] -&gt; [(Word, Word)]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span>
</span><span id="line-419"></span><span>        </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eF"><span class="hs-identifier hs-var">eF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; String
</span><a href="#local-6989586621679334986"><span class="hs-identifier hs-var">getFromJ</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334980"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334980"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eF"><span class="hs-identifier hs-var">eF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; String
</span><a href="#local-6989586621679334983"><span class="hs-identifier hs-var">getToJ</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334980"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334980"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-420"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eF%27"><span class="hs-identifier hs-var">eF'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; String
</span><a href="#local-6989586621679334986"><span class="hs-identifier hs-var">getFromJ</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334980"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334980"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eF%27"><span class="hs-identifier hs-var">eF'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; String
</span><a href="#local-6989586621679334983"><span class="hs-identifier hs-var">getToJ</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334980"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334980"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-421"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679334980"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334980"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334987"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; [Int] -&gt; [Int]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334987"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334988"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-422"></span><span>
</span><span id="line-423"></span><span class="annot"><a href="TM2SM.html#symSM"><span class="hs-identifier hs-type">symSM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="SMType.html#SRule"><span class="hs-identifier hs-type">SRule</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="SMType.html#SRule"><span class="hs-identifier hs-type">SRule</span></a></span><span>
</span><span id="line-424"></span><span id="symSM"><span class="annot"><span class="annottext">symSM :: SRule -&gt; SRule
</span><a href="TM2SM.html#symSM"><span class="hs-identifier hs-var hs-var">symSM</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="SMType.html#SRule"><span class="hs-identifier hs-type">SRule</span></a></span><span> </span><span id="local-6989586621679334978"><span class="annot"><span class="annottext">[(Word, Word)]
</span><a href="#local-6989586621679334978"><span class="hs-identifier hs-var">wordPairs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-425"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679334977"><span class="annot"><span class="annottext">groupByWord :: [Smb] -&gt; ([Smb], b) -&gt; ([Smb], [Smb])
</span><a href="#local-6989586621679334977"><span class="hs-identifier hs-var hs-var">groupByWord</span></a></span></span><span> </span><span id="local-6989586621679334976"><span class="annot"><span class="annottext">[Smb]
</span><a href="#local-6989586621679334976"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679334975"><span class="annot"><span class="annottext">[Smb]
</span><a href="#local-6989586621679334975"><span class="hs-identifier hs-var">left</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679334974"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679334974"><span class="hs-identifier hs-var">other</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-426"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Smb]
</span><a href="#local-6989586621679334976"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-427"></span><span>                </span><span id="local-6989586621679334973"><span class="annot"><span class="annottext">smb :: Smb
</span><a href="#local-6989586621679334973"><span class="hs-identifier hs-var">smb</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="SMType.html#SmbY"><span class="hs-identifier hs-type">SmbY</span></a></span><span> </span><span class="annot"><span class="annottext">Y
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679334972"><span class="annot"><span class="annottext">[Smb]
</span><a href="#local-6989586621679334972"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Smb] -&gt; ([Smb], b) -&gt; ([Smb], [Smb])
</span><a href="#local-6989586621679334977"><span class="hs-identifier hs-var">groupByWord</span></a></span><span> </span><span class="annot"><span class="annottext">[Smb]
</span><a href="#local-6989586621679334972"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Smb
</span><a href="#local-6989586621679334973"><span class="hs-identifier hs-var">smb</span></a></span><span> </span><span class="annot"><span class="annottext">Smb -&gt; [Smb] -&gt; [Smb]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Smb]
</span><a href="#local-6989586621679334975"><span class="hs-identifier hs-var">left</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679334974"><span class="hs-identifier hs-var">other</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-428"></span><span>                </span><span id="local-6989586621679334971"><span class="annot"><span class="annottext">smb :: Smb
</span><a href="#local-6989586621679334971"><span class="hs-identifier hs-var">smb</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="SMType.html#SmbY%27"><span class="hs-identifier hs-type">SmbY'</span></a></span><span> </span><span class="annot"><span class="annottext">Y
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679334970"><span class="annot"><span class="annottext">[Smb]
</span><a href="#local-6989586621679334970"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Smb] -&gt; ([Smb], b) -&gt; ([Smb], [Smb])
</span><a href="#local-6989586621679334977"><span class="hs-identifier hs-var">groupByWord</span></a></span><span> </span><span class="annot"><span class="annottext">[Smb]
</span><a href="#local-6989586621679334970"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Smb
</span><a href="#local-6989586621679334971"><span class="hs-identifier hs-var">smb</span></a></span><span> </span><span class="annot"><span class="annottext">Smb -&gt; [Smb] -&gt; [Smb]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Smb]
</span><a href="#local-6989586621679334975"><span class="hs-identifier hs-var">left</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679334974"><span class="hs-identifier hs-var">other</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-429"></span><span>                </span><span id="local-6989586621679334969"><span class="annot"><span class="annottext">Smb
</span><a href="#local-6989586621679334969"><span class="hs-identifier hs-var">smb</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679334968"><span class="annot"><span class="annottext">[Smb]
</span><a href="#local-6989586621679334968"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Smb] -&gt; [Smb]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[Smb]
</span><a href="#local-6989586621679334975"><span class="hs-identifier hs-var">left</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Smb
</span><a href="#local-6989586621679334969"><span class="hs-identifier hs-var">smb</span></a></span><span> </span><span class="annot"><span class="annottext">Smb -&gt; [Smb] -&gt; [Smb]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Smb]
</span><a href="#local-6989586621679334968"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-430"></span><span>                </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; ([Smb], [Smb])
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;There is no state in word&quot;</span></span><span>
</span><span id="line-431"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679334966"><span class="annot"><span class="annottext">reverseYs :: Smb -&gt; Smb
</span><a href="#local-6989586621679334966"><span class="hs-identifier hs-var hs-var">reverseYs</span></a></span></span><span> </span><span id="local-6989586621679334965"><span class="annot"><span class="annottext">Smb
</span><a href="#local-6989586621679334965"><span class="hs-identifier hs-var">smb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Smb
</span><a href="#local-6989586621679334965"><span class="hs-identifier hs-var">smb</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-432"></span><span>                            </span><span class="annot"><a href="SMType.html#SmbY"><span class="hs-identifier hs-type">SmbY</span></a></span><span> </span><span id="local-6989586621679334964"><span class="annot"><span class="annottext">Y
</span><a href="#local-6989586621679334964"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Y -&gt; Smb
</span><a href="SMType.html#SmbY%27"><span class="hs-identifier hs-var">SmbY'</span></a></span><span> </span><span class="annot"><span class="annottext">Y
</span><a href="#local-6989586621679334964"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-433"></span><span>                            </span><span class="annot"><a href="SMType.html#SmbY%27"><span class="hs-identifier hs-type">SmbY'</span></a></span><span> </span><span id="local-6989586621679334963"><span class="annot"><span class="annottext">Y
</span><a href="#local-6989586621679334963"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Y -&gt; Smb
</span><a href="SMType.html#SmbY"><span class="hs-identifier hs-var">SmbY</span></a></span><span> </span><span class="annot"><span class="annottext">Y
</span><a href="#local-6989586621679334963"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-434"></span><span>                            </span><span class="annot"><span class="annottext">Smb
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Smb
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Smb -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Smb
</span><a href="#local-6989586621679334965"><span class="hs-identifier hs-var">smb</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-435"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679334962"><span class="annot"><span class="annottext">mapWords :: (Word, Word) -&gt; (Word, Word)
</span><a href="#local-6989586621679334962"><span class="hs-identifier hs-var hs-var">mapWords</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="SMType.html#Word"><span class="hs-identifier hs-type">Word</span></a></span><span> </span><span id="local-6989586621679334961"><span class="annot"><span class="annottext">[Smb]
</span><a href="#local-6989586621679334961"><span class="hs-identifier hs-var">w1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="SMType.html#Word"><span class="hs-identifier hs-type">Word</span></a></span><span> </span><span id="local-6989586621679334960"><span class="annot"><span class="annottext">[Smb]
</span><a href="#local-6989586621679334960"><span class="hs-identifier hs-var">w2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="annot"><span class="annottext">[Smb]
</span><a href="#local-6989586621679334959"><span class="hs-identifier hs-var">midle</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="annot"><span class="annottext">([Smb] -&gt; Word) -&gt; [Smb] -&gt; Word
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Smb]
</span><a href="#local-6989586621679334958"><span class="hs-identifier hs-var">reversedLeftYs</span></a></span><span> </span><span class="annot"><span class="annottext">[Smb] -&gt; [Smb] -&gt; [Smb]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Smb]
</span><a href="#local-6989586621679334961"><span class="hs-identifier hs-var">w1</span></a></span><span> </span><span class="annot"><span class="annottext">[Smb] -&gt; [Smb] -&gt; [Smb]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Smb]
</span><a href="#local-6989586621679334957"><span class="hs-identifier hs-var">reversedRightYs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-436"></span><span>                                        </span><span class="hs-keyword">where</span><span>
</span><span id="line-437"></span><span>                                            </span><span class="hs-special">(</span><span id="local-6989586621679334956"><span class="annot"><span class="annottext">[Smb]
</span><a href="#local-6989586621679334956"><span class="hs-identifier hs-var">left</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679334955"><span class="annot"><span class="annottext">[Smb]
</span><a href="#local-6989586621679334955"><span class="hs-identifier hs-var">other1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Smb] -&gt; ([Smb], [Any]) -&gt; ([Smb], [Smb])
forall b. [Smb] -&gt; ([Smb], b) -&gt; ([Smb], [Smb])
</span><a href="#local-6989586621679334977"><span class="hs-identifier hs-var">groupByWord</span></a></span><span> </span><span class="annot"><span class="annottext">[Smb]
</span><a href="#local-6989586621679334960"><span class="hs-identifier hs-var">w2</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-438"></span><span>                                            </span><span class="hs-special">(</span><span id="local-6989586621679334954"><span class="annot"><span class="annottext">[Smb]
</span><a href="#local-6989586621679334954"><span class="hs-identifier hs-var">right</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679334959"><span class="annot"><span class="annottext">[Smb]
</span><a href="#local-6989586621679334959"><span class="hs-identifier hs-var">midle</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Smb] -&gt; [Smb]) -&gt; ([Smb], [Smb]) -&gt; ([Smb], [Smb])
forall a b. (a -&gt; b) -&gt; (a, a) -&gt; (b, b)
</span><a href="Helpers.html#mapTuple"><span class="hs-identifier hs-var">mapTuple</span></a></span><span> </span><span class="annot"><span class="annottext">[Smb] -&gt; [Smb]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">(([Smb], [Smb]) -&gt; ([Smb], [Smb]))
-&gt; ([Smb], [Smb]) -&gt; ([Smb], [Smb])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Smb] -&gt; ([Smb], [Any]) -&gt; ([Smb], [Smb])
forall b. [Smb] -&gt; ([Smb], b) -&gt; ([Smb], [Smb])
</span><a href="#local-6989586621679334977"><span class="hs-identifier hs-var">groupByWord</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Smb] -&gt; [Smb]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[Smb]
</span><a href="#local-6989586621679334955"><span class="hs-identifier hs-var">other1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-439"></span><span>                                            </span><span id="local-6989586621679334958"><span class="annot"><span class="annottext">reversedLeftYs :: [Smb]
</span><a href="#local-6989586621679334958"><span class="hs-identifier hs-var hs-var">reversedLeftYs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Smb -&gt; Smb) -&gt; [Smb] -&gt; [Smb]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Smb -&gt; Smb
</span><a href="#local-6989586621679334966"><span class="hs-identifier hs-var">reverseYs</span></a></span><span> </span><span class="annot"><span class="annottext">[Smb]
</span><a href="#local-6989586621679334956"><span class="hs-identifier hs-var">left</span></a></span><span>
</span><span id="line-440"></span><span>                                            </span><span id="local-6989586621679334957"><span class="annot"><span class="annottext">reversedRightYs :: [Smb]
</span><a href="#local-6989586621679334957"><span class="hs-identifier hs-var hs-var">reversedRightYs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Smb -&gt; Smb) -&gt; [Smb] -&gt; [Smb]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Smb -&gt; Smb
</span><a href="#local-6989586621679334966"><span class="hs-identifier hs-var">reverseYs</span></a></span><span> </span><span class="annot"><span class="annottext">[Smb]
</span><a href="#local-6989586621679334954"><span class="hs-identifier hs-var">right</span></a></span><span>
</span><span id="line-441"></span><span>
</span><span id="line-442"></span><span>    </span><span class="annot"><span class="annottext">[(Word, Word)] -&gt; SRule
</span><a href="SMType.html#SRule"><span class="hs-identifier hs-var">SRule</span></a></span><span> </span><span class="annot"><span class="annottext">([(Word, Word)] -&gt; SRule) -&gt; [(Word, Word)] -&gt; SRule
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((Word, Word) -&gt; (Word, Word)) -&gt; [(Word, Word)] -&gt; [(Word, Word)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(Word, Word) -&gt; (Word, Word)
</span><a href="#local-6989586621679334962"><span class="hs-identifier hs-var">mapWords</span></a></span><span> </span><span class="annot"><span class="annottext">[(Word, Word)]
</span><a href="#local-6989586621679334978"><span class="hs-identifier hs-var">wordPairs</span></a></span><span>
</span><span id="line-443"></span><span>
</span><span id="line-444"></span><span class="annot"><a href="TM2SM.html#sigmaFunc"><span class="hs-identifier hs-type">sigmaFunc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="TMType.html#State"><span class="hs-identifier hs-type">TMType.State</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="SMType.html#Smb"><span class="hs-identifier hs-type">Smb</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="SMType.html#Word"><span class="hs-identifier hs-type">SMType.Word</span></a></span><span>
</span><span id="line-445"></span><span id="sigmaFunc"><span class="annot"><span class="annottext">sigmaFunc :: [State] -&gt; [[Smb]] -&gt; Word
</span><a href="TM2SM.html#sigmaFunc"><span class="hs-identifier hs-var hs-var">sigmaFunc</span></a></span></span><span> </span><span id="local-6989586621679334951"><span class="annot"><span class="annottext">[State]
</span><a href="#local-6989586621679334951"><span class="hs-identifier hs-var">states</span></a></span></span><span> </span><span id="local-6989586621679334950"><span class="annot"><span class="annottext">[[Smb]]
</span><a href="#local-6989586621679334950"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-446"></span><span>    </span><span class="annot"><span class="annottext">[Smb] -&gt; Word
</span><a href="SMType.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="annot"><span class="annottext">([Smb] -&gt; Word) -&gt; [Smb] -&gt; Word
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-447"></span><span>    </span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eE"><span class="hs-identifier hs-var">eE</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Smb -&gt; [Smb] -&gt; [Smb]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Smb]
</span><a href="#local-6989586621679334949"><span class="hs-identifier hs-var">alphan</span></a></span><span> </span><span class="annot"><span class="annottext">[Smb] -&gt; [Smb] -&gt; [Smb]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eX"><span class="hs-identifier hs-var">eX</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eF"><span class="hs-identifier hs-var">eF</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Smb] -&gt; [Smb] -&gt; [Smb]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-448"></span><span>    </span><span class="annot"><span class="annottext">((Int, State, [Smb], [Smb]) -&gt; [Smb])
-&gt; [(Int, State, [Smb], [Smb])] -&gt; [Smb]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span>
</span><span id="line-449"></span><span>    </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679334947"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334947"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="TMType.html#State"><span class="hs-identifier hs-type">TMType.State</span></a></span><span> </span><span id="local-6989586621679334945"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679334945"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679334944"><span class="annot"><span class="annottext">[Smb]
</span><a href="#local-6989586621679334944"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679334943"><span class="annot"><span class="annottext">[Smb]
</span><a href="#local-6989586621679334943"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-450"></span><span>        </span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eE"><span class="hs-identifier hs-var">eE</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334947"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Smb -&gt; [Smb] -&gt; [Smb]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Smb]
</span><a href="#local-6989586621679334943"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">[Smb] -&gt; [Smb] -&gt; [Smb]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eX"><span class="hs-identifier hs-var">eX</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334947"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eF"><span class="hs-identifier hs-var">eF</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679334945"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334947"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eE%27"><span class="hs-identifier hs-var">eE'</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334947"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eP"><span class="hs-identifier hs-var">eP</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334947"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Smb] -&gt; [Smb] -&gt; [Smb]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Smb]
</span><a href="#local-6989586621679334944"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-451"></span><span>                  </span><span class="annot"><span class="annottext">[Smb] -&gt; [Smb] -&gt; [Smb]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eQ"><span class="hs-identifier hs-var">eQ</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334947"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eR"><span class="hs-identifier hs-var">eR</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334947"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eS"><span class="hs-identifier hs-var">eS</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334947"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eT"><span class="hs-identifier hs-var">eT</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334947"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eU"><span class="hs-identifier hs-var">eU</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334947"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#ePd"><span class="hs-identifier hs-var">ePd</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334947"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eQd"><span class="hs-identifier hs-var">eQd</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334947"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eRd"><span class="hs-identifier hs-var">eRd</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334947"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eSd"><span class="hs-identifier hs-var">eSd</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334947"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eTd"><span class="hs-identifier hs-var">eTd</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334947"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eUd"><span class="hs-identifier hs-var">eUd</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334947"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eF%27"><span class="hs-identifier hs-var">eF'</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679334945"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334947"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Int]
-&gt; [State] -&gt; [[Smb]] -&gt; [[Smb]] -&gt; [(Int, State, [Smb], [Smb])]
forall a b c d. [a] -&gt; [b] -&gt; [c] -&gt; [d] -&gt; [(a, b, c, d)]
</span><span class="hs-identifier hs-var">zip4</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[State]
</span><a href="#local-6989586621679334951"><span class="hs-identifier hs-var">states</span></a></span><span> </span><span class="annot"><span class="annottext">[[Smb]]
</span><a href="#local-6989586621679334942"><span class="hs-identifier hs-var">deltan</span></a></span><span> </span><span class="annot"><span class="annottext">[[Smb]]
</span><a href="#local-6989586621679334950"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Smb] -&gt; [Smb] -&gt; [Smb]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-452"></span><span>    </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eE%27"><span class="hs-identifier hs-var">eE'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334941"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eX%27"><span class="hs-identifier hs-var">eX'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334941"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Smb] -&gt; [Smb] -&gt; [Smb]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Smb]
</span><a href="#local-6989586621679334940"><span class="hs-identifier hs-var">omegan</span></a></span><span> </span><span class="annot"><span class="annottext">[Smb] -&gt; [Smb] -&gt; [Smb]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; Int -&gt; Smb
</span><a href="TM2SMHelpers.html#eF%27"><span class="hs-identifier hs-var">eF'</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334941"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-453"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-454"></span><span>            </span><span id="local-6989586621679334939"><span class="annot"><span class="annottext">un :: [Int]
</span><a href="#local-6989586621679334939"><span class="hs-identifier hs-var hs-var">un</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Smb] -&gt; Int) -&gt; [[Smb]] -&gt; [Int]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">[Smb] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[[Smb]]
</span><a href="#local-6989586621679334950"><span class="hs-identifier hs-var">u</span></a></span><span>
</span><span id="line-455"></span><span>            </span><span id="local-6989586621679334941"><span class="annot"><span class="annottext">k :: Int
</span><a href="#local-6989586621679334941"><span class="hs-identifier hs-var hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[State] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[State]
</span><a href="#local-6989586621679334951"><span class="hs-identifier hs-var">states</span></a></span><span>
</span><span id="line-456"></span><span>            </span><span id="local-6989586621679334938"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679334938"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; Int
forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">sum</span></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679334939"><span class="hs-identifier hs-var">un</span></a></span><span>
</span><span id="line-457"></span><span>            </span><span id="local-6989586621679334949"><span class="annot"><span class="annottext">alphan :: [Smb]
</span><a href="#local-6989586621679334949"><span class="hs-identifier hs-var hs-var">alphan</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Smb -&gt; [Smb]
forall a. Int -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">replicate</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334938"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">(Smb -&gt; [Smb]) -&gt; Smb -&gt; [Smb]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Y -&gt; Smb
</span><a href="SMType.html#SmbY"><span class="hs-identifier hs-var">SmbY</span></a></span><span> </span><span class="annot"><span class="annottext">Y
</span><a href="SMType.html#Alpha"><span class="hs-identifier hs-var">Alpha</span></a></span><span>
</span><span id="line-458"></span><span>            </span><span id="local-6989586621679334940"><span class="annot"><span class="annottext">omegan :: [Smb]
</span><a href="#local-6989586621679334940"><span class="hs-identifier hs-var hs-var">omegan</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Smb -&gt; [Smb]
forall a. Int -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">replicate</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334938"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">(Smb -&gt; [Smb]) -&gt; Smb -&gt; [Smb]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Y -&gt; Smb
</span><a href="SMType.html#SmbY"><span class="hs-identifier hs-var">SmbY</span></a></span><span> </span><span class="annot"><span class="annottext">Y
</span><a href="SMType.html#Omega"><span class="hs-identifier hs-var">Omega</span></a></span><span>
</span><span id="line-459"></span><span>            </span><span id="local-6989586621679334942"><span class="annot"><span class="annottext">deltan :: [[Smb]]
</span><a href="#local-6989586621679334942"><span class="hs-identifier hs-var hs-var">deltan</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; [Smb]) -&gt; [Int] -&gt; [[Smb]]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679334935"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334935"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Smb -&gt; [Smb]
forall a. Int -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">replicate</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334935"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">(Smb -&gt; [Smb]) -&gt; Smb -&gt; [Smb]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Y -&gt; Smb
</span><a href="SMType.html#SmbY"><span class="hs-identifier hs-var">SmbY</span></a></span><span> </span><span class="annot"><span class="annottext">Y
</span><a href="SMType.html#Delta"><span class="hs-identifier hs-var">Delta</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679334939"><span class="hs-identifier hs-var">un</span></a></span><span>
</span><span id="line-460"></span><span>
</span><span id="line-461"></span><span class="annot"><a href="TM2SM.html#renameRightLeftBoundings"><span class="hs-identifier hs-type">renameRightLeftBoundings</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="TMType.html#TapeCommand"><span class="hs-identifier hs-type">TMType.TapeCommand</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="TMType.html#TapeCommand"><span class="hs-identifier hs-type">TMType.TapeCommand</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-462"></span><span id="renameRightLeftBoundings"><span class="annot"><span class="annottext">renameRightLeftBoundings :: [[TapeCommand]] -&gt; [[TapeCommand]]
</span><a href="TM2SM.html#renameRightLeftBoundings"><span class="hs-identifier hs-var hs-var">renameRightLeftBoundings</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([TapeCommand] -&gt; [TapeCommand])
-&gt; [[TapeCommand]] -&gt; [[TapeCommand]]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; [TapeCommand] -&gt; [TapeCommand] -&gt; [TapeCommand]
</span><a href="#local-6989586621679334933"><span class="hs-identifier hs-var">renameRightLeftBoundingsInternal</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-463"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-464"></span><span>        </span><span id="local-6989586621679334932"><span class="annot"><span class="annottext">f :: State -&gt; StateOmega
</span><a href="#local-6989586621679334932"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679334931"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679334931"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State -&gt; StateOmega
</span><a href="TMType.html#StateOmega"><span class="hs-identifier hs-var">TMType.StateOmega</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679334931"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-465"></span><span>        </span><span id="local-6989586621679334933"><span class="annot"><span class="annottext">renameRightLeftBoundingsInternal :: Int -&gt; [TapeCommand] -&gt; [TapeCommand] -&gt; [TapeCommand]
</span><a href="#local-6989586621679334933"><span class="hs-identifier hs-var hs-var">renameRightLeftBoundingsInternal</span></a></span></span><span> </span><span id="local-6989586621679334929"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334929"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679334928"><span class="annot"><span class="annottext">[TapeCommand]
</span><a href="#local-6989586621679334928"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span id="local-6989586621679334927"><span class="annot"><span class="annottext">[TapeCommand]
</span><a href="#local-6989586621679334927"><span class="hs-identifier hs-var">command</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-466"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[TapeCommand]
</span><a href="#local-6989586621679334927"><span class="hs-identifier hs-var">command</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-467"></span><span>                </span><span class="annot"><a href="TMType.html#SingleTapeCommand"><span class="hs-identifier hs-type">TMType.SingleTapeCommand</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679334925"><span class="annot"><span class="annottext">Square
</span><a href="#local-6989586621679334925"><span class="hs-identifier hs-var">l1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679334924"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679334924"><span class="hs-identifier hs-var">s1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Square
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679334923"><span class="annot"><span class="annottext">Square
</span><a href="#local-6989586621679334923"><span class="hs-identifier hs-var">l2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679334922"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679334922"><span class="hs-identifier hs-var">s2</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Square
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679334921"><span class="annot"><span class="annottext">[TapeCommand]
</span><a href="#local-6989586621679334921"><span class="hs-identifier hs-var">t</span></a></span></span><span>
</span><span id="line-468"></span><span>                    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Square
</span><a href="#local-6989586621679334925"><span class="hs-identifier hs-var">l1</span></a></span><span> </span><span class="annot"><span class="annottext">Square -&gt; Square -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Square
</span><a href="TMType.html#LBS"><span class="hs-identifier hs-var">TMType.LBS</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [TapeCommand] -&gt; [TapeCommand] -&gt; [TapeCommand]
</span><a href="#local-6989586621679334933"><span class="hs-identifier hs-var">renameRightLeftBoundingsInternal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334929"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Square, StateOmega), (Square, StateOmega)) -&gt; TapeCommand
</span><a href="TMType.html#PreSMCommand"><span class="hs-identifier hs-var">TMType.PreSMCommand</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Square
</span><a href="#local-6989586621679334919"><span class="hs-identifier hs-var">newRight</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">StateOmega
</span><a href="#local-6989586621679334918"><span class="hs-identifier hs-var">newS1</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Square
</span><a href="#local-6989586621679334919"><span class="hs-identifier hs-var">newRight</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">StateOmega
</span><a href="#local-6989586621679334917"><span class="hs-identifier hs-var">newS2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TapeCommand -&gt; [TapeCommand] -&gt; [TapeCommand]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[TapeCommand]
</span><a href="#local-6989586621679334928"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TapeCommand]
</span><a href="#local-6989586621679334921"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-469"></span><span>                    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [TapeCommand] -&gt; [TapeCommand] -&gt; [TapeCommand]
</span><a href="#local-6989586621679334933"><span class="hs-identifier hs-var">renameRightLeftBoundingsInternal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334929"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Square, StateOmega), (Square, StateOmega)) -&gt; TapeCommand
</span><a href="TMType.html#PreSMCommand"><span class="hs-identifier hs-var">TMType.PreSMCommand</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Square
</span><a href="#local-6989586621679334925"><span class="hs-identifier hs-var">l1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">StateOmega
</span><a href="#local-6989586621679334918"><span class="hs-identifier hs-var">newS1</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Square
</span><a href="#local-6989586621679334923"><span class="hs-identifier hs-var">l2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">StateOmega
</span><a href="#local-6989586621679334917"><span class="hs-identifier hs-var">newS2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TapeCommand -&gt; [TapeCommand] -&gt; [TapeCommand]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[TapeCommand]
</span><a href="#local-6989586621679334928"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TapeCommand]
</span><a href="#local-6989586621679334921"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-470"></span><span>                        </span><span class="hs-keyword">where</span><span>   </span><span id="local-6989586621679334919"><span class="annot"><span class="annottext">newRight :: Square
</span><a href="#local-6989586621679334919"><span class="hs-identifier hs-var hs-var">newRight</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Square
</span><a href="TMType.html#E"><span class="hs-identifier hs-var">TMType.E</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334929"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-471"></span><span>                                </span><span id="local-6989586621679334918"><span class="annot"><span class="annottext">newS1 :: StateOmega
</span><a href="#local-6989586621679334918"><span class="hs-identifier hs-var hs-var">newS1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State -&gt; StateOmega
</span><a href="#local-6989586621679334932"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679334924"><span class="hs-identifier hs-var">s1</span></a></span><span>
</span><span id="line-472"></span><span>                                </span><span id="local-6989586621679334917"><span class="annot"><span class="annottext">newS2 :: StateOmega
</span><a href="#local-6989586621679334917"><span class="hs-identifier hs-var hs-var">newS2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State -&gt; StateOmega
</span><a href="#local-6989586621679334932"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679334922"><span class="hs-identifier hs-var">s2</span></a></span><span>
</span><span id="line-473"></span><span>                </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[TapeCommand] -&gt; [TapeCommand]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[TapeCommand]
</span><a href="#local-6989586621679334928"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-474"></span><span>                </span><span class="annot"><a href="TMType.html#PreSMCommand"><span class="hs-identifier hs-type">TMType.PreSMCommand</span></a></span><span> </span><span class="annot"><span class="annottext">((Square, StateOmega), (Square, StateOmega))
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">[TapeCommand]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; [TapeCommand]
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;PreSMCommand found&quot;</span></span><span>
</span><span id="line-475"></span><span>
</span><span id="line-476"></span><span class="annot"><a href="TM2SM.html#tm2sm"><span class="hs-identifier hs-type">tm2sm</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="TMType.html#TM"><span class="hs-identifier hs-type">TMType.TM</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="SMType.html#SM"><span class="hs-identifier hs-type">SM</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="SMType.html#Word"><span class="hs-identifier hs-type">SMType.Word</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="TMType.html#State"><span class="hs-identifier hs-type">TMType.State</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-477"></span><span id="tm2sm"><span class="annot"><span class="annottext">tm2sm :: TM -&gt; (SM, Word, [State])
</span><a href="TM2SM.html#tm2sm"><span class="hs-identifier hs-var hs-var">tm2sm</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="TMType.html#TM"><span class="hs-identifier hs-type">TMType.TM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">InputAlphabet
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span>
</span><span id="line-478"></span><span>        </span><span id="local-6989586621679334914"><span class="annot"><span class="annottext">[TapeAlphabet]
</span><a href="#local-6989586621679334914"><span class="hs-identifier hs-var">tapeAlphabets</span></a></span></span><span class="hs-special">,</span><span>
</span><span id="line-479"></span><span>        </span><span class="annot"><a href="TMType.html#MultiTapeStates"><span class="hs-identifier hs-type">TMType.MultiTapeStates</span></a></span><span> </span><span id="local-6989586621679334912"><span class="annot"><span class="annottext">[Set State]
</span><a href="#local-6989586621679334912"><span class="hs-identifier hs-var">tapesStates</span></a></span></span><span class="hs-special">,</span><span>
</span><span id="line-480"></span><span>        </span><span class="annot"><a href="TMType.html#Commands"><span class="hs-identifier hs-type">TMType.Commands</span></a></span><span> </span><span id="local-6989586621679334910"><span class="annot"><span class="annottext">Set [TapeCommand]
</span><a href="#local-6989586621679334910"><span class="hs-identifier hs-var">commandsSet</span></a></span></span><span class="hs-special">,</span><span>
</span><span id="line-481"></span><span>        </span><span class="annot"><a href="TMType.html#StartStates"><span class="hs-identifier hs-type">TMType.StartStates</span></a></span><span> </span><span id="local-6989586621679334908"><span class="annot"><span class="annottext">[State]
</span><a href="#local-6989586621679334908"><span class="hs-identifier hs-var">startStates</span></a></span></span><span class="hs-special">,</span><span>
</span><span id="line-482"></span><span>        </span><span class="annot"><a href="TMType.html#AccessStates"><span class="hs-identifier hs-type">TMType.AccessStates</span></a></span><span> </span><span id="local-6989586621679334906"><span class="annot"><span class="annottext">[State]
</span><a href="#local-6989586621679334906"><span class="hs-identifier hs-var">accessStates</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-483"></span><span>        </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-484"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679334905"><span class="annot"><span class="annottext">numOfTapes :: Int
</span><a href="#local-6989586621679334905"><span class="hs-identifier hs-var hs-var">numOfTapes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TapeAlphabet] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[TapeAlphabet]
</span><a href="#local-6989586621679334914"><span class="hs-identifier hs-var">tapeAlphabets</span></a></span><span>
</span><span id="line-485"></span><span>        </span><span id="local-6989586621679334904"><span class="annot"><span class="annottext">gamma :: [SMTag]
</span><a href="#local-6989586621679334904"><span class="hs-identifier hs-var hs-var">gamma</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T4"><span class="hs-identifier hs-var">T4</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#T9"><span class="hs-identifier hs-var">T9</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#TAlpha"><span class="hs-identifier hs-var">TAlpha</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="SMType.html#TOmega"><span class="hs-identifier hs-var">TOmega</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-486"></span><span>        </span><span id="local-6989586621679334903"><span class="annot"><span class="annottext">y :: [[Y]]
</span><a href="#local-6989586621679334903"><span class="hs-identifier hs-var hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TapeAlphabet -&gt; [Y]) -&gt; [TapeAlphabet] -&gt; [[Y]]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="TMType.html#TapeAlphabet"><span class="hs-identifier hs-type">TMType.TapeAlphabet</span></a></span><span> </span><span id="local-6989586621679334901"><span class="annot"><span class="annottext">Set Square
</span><a href="#local-6989586621679334901"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Square -&gt; Y) -&gt; [Square] -&gt; [Y]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Square -&gt; Y
</span><a href="SMType.html#Y"><span class="hs-identifier hs-var">Y</span></a></span><span> </span><span class="annot"><span class="annottext">([Square] -&gt; [Y]) -&gt; [Square] -&gt; [Y]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Set Square -&gt; [Square]
forall a. Set a -&gt; [a]
</span><span class="hs-identifier hs-var">Set.toList</span></span><span> </span><span class="annot"><span class="annottext">Set Square
</span><a href="#local-6989586621679334901"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TapeAlphabet]
</span><a href="#local-6989586621679334914"><span class="hs-identifier hs-var">tapeAlphabets</span></a></span><span>
</span><span id="line-487"></span><span>        </span><span id="local-6989586621679334899"><span class="annot"><span class="annottext">getFinalForTape :: Set Tag -&gt; [[State]]
</span><a href="#local-6989586621679334899"><span class="hs-identifier hs-var hs-var">getFinalForTape</span></a></span></span><span> </span><span id="local-6989586621679334898"><span class="annot"><span class="annottext">Set Tag
</span><a href="#local-6989586621679334898"><span class="hs-identifier hs-var">tag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; [State] -&gt; [State]) -&gt; [Int] -&gt; [[State]] -&gt; [[State]]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679334896"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334896"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679334895"><span class="annot"><span class="annottext">[State]
</span><a href="#local-6989586621679334895"><span class="hs-identifier hs-var">idxs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(State -&gt; State) -&gt; [State] -&gt; [State]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="TMType.html#State"><span class="hs-identifier hs-type">TMType.State</span></a></span><span> </span><span id="local-6989586621679334894"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679334894"><span class="hs-identifier hs-var">idx</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">StateName -&gt; String -&gt; Set Tag -&gt; Maybe StateVal -&gt; State
</span><a href="SMType.html#State"><span class="hs-identifier hs-var">State</span></a></span><span> </span><span class="annot"><span class="annottext">StateName
</span><a href="SMType.html#F"><span class="hs-identifier hs-var">F</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679334894"><span class="hs-identifier hs-var">idx</span></a></span><span> </span><span class="annot"><span class="annottext">Set Tag
</span><a href="#local-6989586621679334898"><span class="hs-identifier hs-var">tag</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe StateVal -&gt; State) -&gt; Maybe StateVal -&gt; State
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Maybe StateVal
</span><a href="TM2SMHelpers.html#standardV"><span class="hs-identifier hs-var">standardV</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334896"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[State]
</span><a href="#local-6989586621679334895"><span class="hs-identifier hs-var">idxs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334905"><span class="hs-identifier hs-var">numOfTapes</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">([[State]] -&gt; [[State]]) -&gt; [[State]] -&gt; [[State]]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Set State -&gt; [State]) -&gt; [Set State] -&gt; [[State]]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Set State -&gt; [State]
forall a. Set a -&gt; [a]
</span><span class="hs-identifier hs-var">Set.toList</span></span><span> </span><span class="annot"><span class="annottext">[Set State]
</span><a href="#local-6989586621679334912"><span class="hs-identifier hs-var">tapesStates</span></a></span><span>
</span><span id="line-488"></span><span>        </span><span id="local-6989586621679334892"><span class="annot"><span class="annottext">standatdState :: StateName -&gt; Set Tag -&gt; [[State]]
</span><a href="#local-6989586621679334892"><span class="hs-identifier hs-var hs-var">standatdState</span></a></span></span><span> </span><span id="local-6989586621679334891"><span class="annot"><span class="annottext">StateName
</span><a href="#local-6989586621679334891"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679334890"><span class="annot"><span class="annottext">Set Tag
</span><a href="#local-6989586621679334890"><span class="hs-identifier hs-var">tags</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><span class="annottext">StateName -&gt; String -&gt; Set Tag -&gt; Maybe StateVal -&gt; State
</span><a href="SMType.html#State"><span class="hs-identifier hs-var">State</span></a></span><span> </span><span class="annot"><span class="annottext">StateName
</span><a href="#local-6989586621679334891"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">Set Tag
</span><a href="#local-6989586621679334890"><span class="hs-identifier hs-var">tags</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Maybe StateVal
</span><a href="TM2SMHelpers.html#standardV"><span class="hs-identifier hs-var">standardV</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334889"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679334889"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334889"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334905"><span class="hs-identifier hs-var">numOfTapes</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-489"></span><span>        </span><span id="local-6989586621679334888"><span class="annot"><span class="annottext">es :: [[State]]
</span><a href="#local-6989586621679334888"><span class="hs-identifier hs-var hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">StateName -&gt; String -&gt; Set Tag -&gt; Maybe StateVal -&gt; State
</span><a href="SMType.html#State"><span class="hs-identifier hs-var">State</span></a></span><span> </span><span class="annot"><span class="annottext">StateName
</span><a href="SMType.html#E"><span class="hs-identifier hs-var">E</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">Set Tag
</span><a href="TM2SMHelpers.html#eTag"><span class="hs-identifier hs-var">eTag</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe StateVal -&gt; State) -&gt; Maybe StateVal -&gt; State
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Maybe StateVal
</span><a href="TM2SMHelpers.html#standardV"><span class="hs-identifier hs-var">standardV</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">([[State]] -&gt; [[State]]) -&gt; [[State]] -&gt; [[State]]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StateName -&gt; Set Tag -&gt; [[State]]
</span><a href="#local-6989586621679334892"><span class="hs-identifier hs-var">standatdState</span></a></span><span> </span><span class="annot"><span class="annottext">StateName
</span><a href="SMType.html#E"><span class="hs-identifier hs-var">E</span></a></span><span> </span><span class="annot"><span class="annottext">Set Tag
</span><a href="TM2SMHelpers.html#eTag"><span class="hs-identifier hs-var">eTag</span></a></span><span>
</span><span id="line-490"></span><span>        </span><span id="local-6989586621679334887"><span class="annot"><span class="annottext">e's :: [[State]]
</span><a href="#local-6989586621679334887"><span class="hs-identifier hs-var hs-var">e's</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateName -&gt; Set Tag -&gt; [[State]]
</span><a href="#local-6989586621679334892"><span class="hs-identifier hs-var">standatdState</span></a></span><span> </span><span class="annot"><span class="annottext">StateName
</span><a href="SMType.html#E"><span class="hs-identifier hs-var">E</span></a></span><span> </span><span class="annot"><span class="annottext">Set Tag
</span><a href="TM2SMHelpers.html#quoteTag"><span class="hs-identifier hs-var">quoteTag</span></a></span><span> </span><span class="annot"><span class="annottext">[[State]] -&gt; [[State]] -&gt; [[State]]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><span class="annottext">StateName -&gt; String -&gt; Set Tag -&gt; Maybe StateVal -&gt; State
</span><a href="SMType.html#State"><span class="hs-identifier hs-var">State</span></a></span><span> </span><span class="annot"><span class="annottext">StateName
</span><a href="SMType.html#E"><span class="hs-identifier hs-var">E</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">Set Tag
</span><a href="TM2SMHelpers.html#quoteTag"><span class="hs-identifier hs-var">quoteTag</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe StateVal -&gt; State)
-&gt; (Int -&gt; Maybe StateVal) -&gt; Int -&gt; State
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Maybe StateVal
</span><a href="TM2SMHelpers.html#standardV"><span class="hs-identifier hs-var">standardV</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; State) -&gt; Int -&gt; State
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334905"><span class="hs-identifier hs-var">numOfTapes</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-491"></span><span>        </span><span id="local-6989586621679334885"><span class="annot"><span class="annottext">fs :: [[State]]
</span><a href="#local-6989586621679334885"><span class="hs-identifier hs-var hs-var">fs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">StateName -&gt; String -&gt; Set Tag -&gt; Maybe StateVal -&gt; State
</span><a href="SMType.html#State"><span class="hs-identifier hs-var">State</span></a></span><span> </span><span class="annot"><span class="annottext">StateName
</span><a href="SMType.html#F"><span class="hs-identifier hs-var">F</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">Set Tag
</span><a href="TM2SMHelpers.html#eTag"><span class="hs-identifier hs-var">eTag</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe StateVal -&gt; State) -&gt; Maybe StateVal -&gt; State
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Maybe StateVal
</span><a href="TM2SMHelpers.html#standardV"><span class="hs-identifier hs-var">standardV</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">([[State]] -&gt; [[State]]) -&gt; [[State]] -&gt; [[State]]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Set Tag -&gt; [[State]]
</span><a href="#local-6989586621679334899"><span class="hs-identifier hs-var">getFinalForTape</span></a></span><span> </span><span class="annot"><span class="annottext">Set Tag
</span><a href="TM2SMHelpers.html#eTag"><span class="hs-identifier hs-var">eTag</span></a></span><span>
</span><span id="line-492"></span><span>        </span><span id="local-6989586621679334884"><span class="annot"><span class="annottext">f's :: [[State]]
</span><a href="#local-6989586621679334884"><span class="hs-identifier hs-var hs-var">f's</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set Tag -&gt; [[State]]
</span><a href="#local-6989586621679334899"><span class="hs-identifier hs-var">getFinalForTape</span></a></span><span> </span><span class="annot"><span class="annottext">Set Tag
</span><a href="TM2SMHelpers.html#quoteTag"><span class="hs-identifier hs-var">quoteTag</span></a></span><span> </span><span class="annot"><span class="annottext">[[State]] -&gt; [[State]] -&gt; [[State]]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><span class="annottext">StateName -&gt; String -&gt; Set Tag -&gt; Maybe StateVal -&gt; State
</span><a href="SMType.html#State"><span class="hs-identifier hs-var">State</span></a></span><span> </span><span class="annot"><span class="annottext">StateName
</span><a href="SMType.html#F"><span class="hs-identifier hs-var">F</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">Set Tag
</span><a href="TM2SMHelpers.html#quoteTag"><span class="hs-identifier hs-var">quoteTag</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe StateVal -&gt; State)
-&gt; (Int -&gt; Maybe StateVal) -&gt; Int -&gt; State
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Maybe StateVal
</span><a href="TM2SMHelpers.html#standardV"><span class="hs-identifier hs-var">standardV</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; State) -&gt; Int -&gt; State
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334905"><span class="hs-identifier hs-var">numOfTapes</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-493"></span><span>        </span><span id="local-6989586621679334883"><span class="annot"><span class="annottext">xs :: [[State]]
</span><a href="#local-6989586621679334883"><span class="hs-identifier hs-var hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><span class="annottext">StateName -&gt; String -&gt; Set Tag -&gt; Maybe StateVal -&gt; State
</span><a href="SMType.html#State"><span class="hs-identifier hs-var">State</span></a></span><span> </span><span class="annot"><span class="annottext">StateName
</span><a href="SMType.html#X"><span class="hs-identifier hs-var">X</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">Set Tag
</span><a href="TM2SMHelpers.html#eTag"><span class="hs-identifier hs-var">eTag</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Maybe StateVal
</span><a href="TM2SMHelpers.html#standardV"><span class="hs-identifier hs-var">standardV</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334882"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679334882"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334882"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334905"><span class="hs-identifier hs-var">numOfTapes</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[[State]] -&gt; [[State]] -&gt; [[State]]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><span class="annottext">StateName -&gt; String -&gt; Set Tag -&gt; Maybe StateVal -&gt; State
</span><a href="SMType.html#State"><span class="hs-identifier hs-var">State</span></a></span><span> </span><span class="annot"><span class="annottext">StateName
</span><a href="SMType.html#X"><span class="hs-identifier hs-var">X</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">Set Tag
</span><a href="TM2SMHelpers.html#quoteTag"><span class="hs-identifier hs-var">quoteTag</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe StateVal -&gt; State)
-&gt; (Int -&gt; Maybe StateVal) -&gt; Int -&gt; State
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Maybe StateVal
</span><a href="TM2SMHelpers.html#standardV"><span class="hs-identifier hs-var">standardV</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; State) -&gt; Int -&gt; State
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334905"><span class="hs-identifier hs-var">numOfTapes</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-494"></span><span>        </span><span class="hs-special">[</span><span id="local-6989586621679334881"><span class="annot"><span class="annottext">[[State]]
</span><a href="#local-6989586621679334881"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679334880"><span class="annot"><span class="annottext">[[State]]
</span><a href="#local-6989586621679334880"><span class="hs-identifier hs-var">qs</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679334879"><span class="annot"><span class="annottext">[[State]]
</span><a href="#local-6989586621679334879"><span class="hs-identifier hs-var">rs</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679334878"><span class="annot"><span class="annottext">[[State]]
</span><a href="#local-6989586621679334878"><span class="hs-identifier hs-var">ss</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679334877"><span class="annot"><span class="annottext">[[State]]
</span><a href="#local-6989586621679334877"><span class="hs-identifier hs-var">ts</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679334876"><span class="annot"><span class="annottext">[[State]]
</span><a href="#local-6989586621679334876"><span class="hs-identifier hs-var">us</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679334875"><span class="annot"><span class="annottext">[[State]]
</span><a href="#local-6989586621679334875"><span class="hs-identifier hs-var">pds</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679334874"><span class="annot"><span class="annottext">[[State]]
</span><a href="#local-6989586621679334874"><span class="hs-identifier hs-var">qds</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679334873"><span class="annot"><span class="annottext">[[State]]
</span><a href="#local-6989586621679334873"><span class="hs-identifier hs-var">rds</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679334872"><span class="annot"><span class="annottext">[[State]]
</span><a href="#local-6989586621679334872"><span class="hs-identifier hs-var">sds</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679334871"><span class="annot"><span class="annottext">[[State]]
</span><a href="#local-6989586621679334871"><span class="hs-identifier hs-var">tds</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679334870"><span class="annot"><span class="annottext">[[State]]
</span><a href="#local-6989586621679334870"><span class="hs-identifier hs-var">uds</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">StateName -&gt; Set Tag -&gt; [[State]]
</span><a href="#local-6989586621679334892"><span class="hs-identifier hs-var">standatdState</span></a></span><span> </span><span class="annot"><span class="annottext">StateName
</span><a href="#local-6989586621679334869"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Set Tag
</span><a href="#local-6989586621679334868"><span class="hs-identifier hs-var">tag</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679334869"><span class="annot"><span class="annottext">StateName
</span><a href="#local-6989586621679334869"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">StateName
</span><a href="SMType.html#P"><span class="hs-identifier hs-var">P</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">StateName
</span><a href="SMType.html#Q"><span class="hs-identifier hs-var">Q</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">StateName
</span><a href="SMType.html#R"><span class="hs-identifier hs-var">R</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">StateName
</span><a href="SMType.html#S"><span class="hs-identifier hs-var">S</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">StateName
</span><a href="SMType.html#T"><span class="hs-identifier hs-var">T</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">StateName
</span><a href="SMType.html#U"><span class="hs-identifier hs-var">U</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679334868"><span class="annot"><span class="annottext">Set Tag
</span><a href="#local-6989586621679334868"><span class="hs-identifier hs-var">tag</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Set Tag
</span><a href="TM2SMHelpers.html#eTag"><span class="hs-identifier hs-var">eTag</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set Tag
</span><a href="TM2SMHelpers.html#dashTag"><span class="hs-identifier hs-var">dashTag</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-495"></span><span>        </span><span id="local-6989586621679334867"><span class="annot"><span class="annottext">standardStates :: [[State]]
</span><a href="#local-6989586621679334867"><span class="hs-identifier hs-var hs-var">standardStates</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[[State]]] -&gt; [[State]]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[[State]]
</span><a href="#local-6989586621679334888"><span class="hs-identifier hs-var">es</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[[State]]
</span><a href="#local-6989586621679334887"><span class="hs-identifier hs-var">e's</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[[State]]
</span><a href="#local-6989586621679334885"><span class="hs-identifier hs-var">fs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[[State]]
</span><a href="#local-6989586621679334884"><span class="hs-identifier hs-var">f's</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[[State]]
</span><a href="#local-6989586621679334883"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[[State]]
</span><a href="#local-6989586621679334881"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[[State]]
</span><a href="#local-6989586621679334880"><span class="hs-identifier hs-var">qs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[[State]]
</span><a href="#local-6989586621679334879"><span class="hs-identifier hs-var">rs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[[State]]
</span><a href="#local-6989586621679334878"><span class="hs-identifier hs-var">ss</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[[State]]
</span><a href="#local-6989586621679334877"><span class="hs-identifier hs-var">ts</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[[State]]
</span><a href="#local-6989586621679334876"><span class="hs-identifier hs-var">us</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[[State]]
</span><a href="#local-6989586621679334875"><span class="hs-identifier hs-var">pds</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[[State]]
</span><a href="#local-6989586621679334874"><span class="hs-identifier hs-var">qds</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[[State]]
</span><a href="#local-6989586621679334873"><span class="hs-identifier hs-var">rds</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[[State]]
</span><a href="#local-6989586621679334872"><span class="hs-identifier hs-var">sds</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[[State]]
</span><a href="#local-6989586621679334871"><span class="hs-identifier hs-var">tds</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[[State]]
</span><a href="#local-6989586621679334870"><span class="hs-identifier hs-var">uds</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-496"></span><span>
</span><span id="line-497"></span><span>        </span><span id="local-6989586621679334866"><span class="annot"><span class="annottext">commands :: [[TapeCommand]]
</span><a href="#local-6989586621679334866"><span class="hs-identifier hs-var hs-var">commands</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[TapeCommand]] -&gt; [[TapeCommand]]
</span><a href="TM2SM.html#renameRightLeftBoundings"><span class="hs-identifier hs-var">renameRightLeftBoundings</span></a></span><span> </span><span class="annot"><span class="annottext">([[TapeCommand]] -&gt; [[TapeCommand]])
-&gt; [[TapeCommand]] -&gt; [[TapeCommand]]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Set [TapeCommand] -&gt; [[TapeCommand]]
forall a. Set a -&gt; [a]
</span><span class="hs-identifier hs-var">Set.toList</span></span><span> </span><span class="annot"><span class="annottext">Set [TapeCommand]
</span><a href="#local-6989586621679334910"><span class="hs-identifier hs-var">commandsSet</span></a></span><span>
</span><span id="line-498"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679334865"><span class="annot"><span class="annottext">[[TapeCommand]]
</span><a href="#local-6989586621679334865"><span class="hs-identifier hs-var">pos21</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679334864"><span class="annot"><span class="annottext">[[TapeCommand]]
</span><a href="#local-6989586621679334864"><span class="hs-identifier hs-var">pos22</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[[TapeCommand]]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[[TapeCommand]]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[TapeCommand]]
-&gt; ([[TapeCommand]], [[TapeCommand]], [[TapeCommand]],
    [[TapeCommand]])
</span><a href="TM2SM.html#splitPosNegCmds"><span class="hs-identifier hs-var">splitPosNegCmds</span></a></span><span> </span><span class="annot"><span class="annottext">[[TapeCommand]]
</span><a href="#local-6989586621679334866"><span class="hs-identifier hs-var">commands</span></a></span><span>
</span><span id="line-499"></span><span>        </span><span id="local-6989586621679334863"><span class="annot"><span class="annottext">sms :: [[SM]]
</span><a href="#local-6989586621679334863"><span class="hs-identifier hs-var hs-var">sms</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><span class="annottext">TMCMD -&gt; SM
</span><a href="#local-6989586621679334862"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(TMCMD -&gt; SM) -&gt; TMCMD -&gt; SM
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[TapeCommand] -&gt; TMCMD
</span><a href="SMType.html#Command"><span class="hs-identifier hs-var">Command</span></a></span><span> </span><span class="annot"><span class="annottext">[TapeCommand]
</span><a href="#local-6989586621679334861"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679334862"><span class="annot"><span class="annottext">TMCMD -&gt; SM
</span><a href="#local-6989586621679334862"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(SM -&gt; SMTag -&gt; TMCMD -&gt; SM) -&gt; [SM] -&gt; [SMTag] -&gt; [TMCMD -&gt; SM]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="annot"><span class="annottext">SM -&gt; SMTag -&gt; TMCMD -&gt; SM
</span><a href="TM2SM.html#copySMForCommand"><span class="hs-identifier hs-var">copySMForCommand</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Y] -&gt; [SM]
</span><a href="TM2SM.html#createSMs"><span class="hs-identifier hs-var">createSMs</span></a></span><span> </span><span class="annot"><span class="annottext">([Y] -&gt; [SM]) -&gt; [Y] -&gt; [SM]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[[Y]] -&gt; Int -&gt; [Y]
forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">(!!)</span></span><span> </span><span class="annot"><span class="annottext">[[Y]]
</span><a href="#local-6989586621679334903"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; [Y]) -&gt; Int -&gt; [Y]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Square, Int) -&gt; Int
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TapeCommand] -&gt; (Square, Int)
</span><a href="TM2SMHelpers.html#getai"><span class="hs-identifier hs-var">getai</span></a></span><span> </span><span class="annot"><span class="annottext">[TapeCommand]
</span><a href="#local-6989586621679334861"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[SMTag]
</span><a href="#local-6989586621679334904"><span class="hs-identifier hs-var">gamma</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679334861"><span class="annot"><span class="annottext">[TapeCommand]
</span><a href="#local-6989586621679334861"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[[TapeCommand]]
</span><a href="#local-6989586621679334865"><span class="hs-identifier hs-var">pos21</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-500"></span><span>        </span><span id="local-6989586621679334859"><span class="annot"><span class="annottext">smsRules :: [SRule]
</span><a href="#local-6989586621679334859"><span class="hs-identifier hs-var hs-var">smsRules</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SM -&gt; [SRule]) -&gt; [SM] -&gt; [SRule]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">SM -&gt; [SRule]
</span><a href="SMType.html#srs"><span class="hs-identifier hs-var hs-var">srs</span></a></span><span> </span><span class="annot"><span class="annottext">([SM] -&gt; [SRule]) -&gt; [SM] -&gt; [SRule]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[[SM]] -&gt; [SM]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">[[SM]]
</span><a href="#local-6989586621679334863"><span class="hs-identifier hs-var">sms</span></a></span><span>
</span><span id="line-501"></span><span>        </span><span id="local-6989586621679334858"><span class="annot"><span class="annottext">groupByStates :: Set State -&gt; Set State -&gt; Bool
</span><a href="#local-6989586621679334858"><span class="hs-identifier hs-var hs-var">groupByStates</span></a></span></span><span> </span><span id="local-6989586621679334857"><span class="annot"><span class="annottext">Set State
</span><a href="#local-6989586621679334857"><span class="hs-identifier hs-var">s1</span></a></span></span><span> </span><span id="local-6989586621679334856"><span class="annot"><span class="annottext">Set State
</span><a href="#local-6989586621679334856"><span class="hs-identifier hs-var">s2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State -&gt; StateName
</span><a href="SMType.html#s_name"><span class="hs-identifier hs-var hs-var">s_name</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679334855"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="annot"><span class="annottext">StateName -&gt; StateName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">State -&gt; StateName
</span><a href="SMType.html#s_name"><span class="hs-identifier hs-var hs-var">s_name</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679334854"><span class="hs-identifier hs-var">e2</span></a></span><span>
</span><span id="line-502"></span><span>                                </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Tag -&gt; Set Tag -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.member</span></span><span> </span><span class="annot"><span class="annottext">Tag
</span><a href="SMType.html#Dash"><span class="hs-identifier hs-var">Dash</span></a></span><span> </span><span class="annot"><span class="annottext">Set Tag
</span><a href="#local-6989586621679334852"><span class="hs-identifier hs-var">tag1</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Tag -&gt; Set Tag -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.member</span></span><span> </span><span class="annot"><span class="annottext">Tag
</span><a href="SMType.html#Dash"><span class="hs-identifier hs-var">Dash</span></a></span><span> </span><span class="annot"><span class="annottext">Set Tag
</span><a href="#local-6989586621679334851"><span class="hs-identifier hs-var">tag2</span></a></span><span>
</span><span id="line-503"></span><span>                                </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334850"><span class="hs-identifier hs-var">id1</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334849"><span class="hs-identifier hs-var">id2</span></a></span><span>
</span><span id="line-504"></span><span>                                </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">State -&gt; StateName
</span><a href="SMType.html#s_name"><span class="hs-identifier hs-var hs-var">s_name</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679334855"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="annot"><span class="annottext">StateName -&gt; StateName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">StateName
</span><a href="SMType.html#E"><span class="hs-identifier hs-var">E</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Set Tag -&gt; Bool
forall a. Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.null</span></span><span> </span><span class="annot"><span class="annottext">Set Tag
</span><a href="#local-6989586621679334852"><span class="hs-identifier hs-var">tag1</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Set Tag -&gt; Bool
forall a. Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.null</span></span><span> </span><span class="annot"><span class="annottext">Set Tag
</span><a href="#local-6989586621679334851"><span class="hs-identifier hs-var">tag2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-505"></span><span>                                </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">State -&gt; StateName
</span><a href="SMType.html#s_name"><span class="hs-identifier hs-var hs-var">s_name</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679334855"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="annot"><span class="annottext">StateName -&gt; StateName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">StateName
</span><a href="SMType.html#F"><span class="hs-identifier hs-var">F</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Set Tag -&gt; Bool
forall a. Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.null</span></span><span> </span><span class="annot"><span class="annottext">Set Tag
</span><a href="#local-6989586621679334852"><span class="hs-identifier hs-var">tag1</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Set Tag -&gt; Bool
forall a. Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.null</span></span><span> </span><span class="annot"><span class="annottext">Set Tag
</span><a href="#local-6989586621679334851"><span class="hs-identifier hs-var">tag2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-506"></span><span>                                </span><span class="hs-keyword">where</span><span>   </span><span id="local-6989586621679334855"><span class="annot"><span class="annottext">e1 :: State
</span><a href="#local-6989586621679334855"><span class="hs-identifier hs-var hs-var">e1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Set State -&gt; State
forall a. Int -&gt; Set a -&gt; a
</span><span class="hs-identifier hs-var">Set.elemAt</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Set State
</span><a href="#local-6989586621679334857"><span class="hs-identifier hs-var">s1</span></a></span><span>
</span><span id="line-507"></span><span>                                        </span><span id="local-6989586621679334854"><span class="annot"><span class="annottext">e2 :: State
</span><a href="#local-6989586621679334854"><span class="hs-identifier hs-var hs-var">e2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Set State -&gt; State
forall a. Int -&gt; Set a -&gt; a
</span><span class="hs-identifier hs-var">Set.elemAt</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Set State
</span><a href="#local-6989586621679334856"><span class="hs-identifier hs-var">s2</span></a></span><span>
</span><span id="line-508"></span><span>                                        </span><span id="local-6989586621679334852"><span class="annot"><span class="annottext">tag1 :: Set Tag
</span><a href="#local-6989586621679334852"><span class="hs-identifier hs-var hs-var">tag1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State -&gt; Set Tag
</span><a href="SMType.html#s_tags"><span class="hs-identifier hs-var hs-var">s_tags</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679334855"><span class="hs-identifier hs-var">e1</span></a></span><span>
</span><span id="line-509"></span><span>                                        </span><span id="local-6989586621679334851"><span class="annot"><span class="annottext">tag2 :: Set Tag
</span><a href="#local-6989586621679334851"><span class="hs-identifier hs-var hs-var">tag2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State -&gt; Set Tag
</span><a href="SMType.html#s_tags"><span class="hs-identifier hs-var hs-var">s_tags</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679334854"><span class="hs-identifier hs-var">e2</span></a></span><span>
</span><span id="line-510"></span><span>                                        </span><span id="local-6989586621679334850"><span class="annot"><span class="annottext">id1 :: Int
</span><a href="#local-6989586621679334850"><span class="hs-identifier hs-var hs-var">id1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateVal -&gt; Int
</span><a href="SMType.html#tape"><span class="hs-identifier hs-var hs-var">tape</span></a></span><span> </span><span class="annot"><span class="annottext">(StateVal -&gt; Int)
-&gt; (Maybe StateVal -&gt; StateVal) -&gt; Maybe StateVal -&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Maybe StateVal -&gt; StateVal
forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromJust</span></span><span> </span><span class="annot"><span class="annottext">(Maybe StateVal -&gt; Int) -&gt; Maybe StateVal -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">State -&gt; Maybe StateVal
</span><a href="SMType.html#s_val"><span class="hs-identifier hs-var hs-var">s_val</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679334855"><span class="hs-identifier hs-var">e1</span></a></span><span>
</span><span id="line-511"></span><span>                                        </span><span id="local-6989586621679334849"><span class="annot"><span class="annottext">id2 :: Int
</span><a href="#local-6989586621679334849"><span class="hs-identifier hs-var hs-var">id2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateVal -&gt; Int
</span><a href="SMType.html#tape"><span class="hs-identifier hs-var hs-var">tape</span></a></span><span> </span><span class="annot"><span class="annottext">(StateVal -&gt; Int)
-&gt; (Maybe StateVal -&gt; StateVal) -&gt; Maybe StateVal -&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Maybe StateVal -&gt; StateVal
forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromJust</span></span><span> </span><span class="annot"><span class="annottext">(Maybe StateVal -&gt; Int) -&gt; Maybe StateVal -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">State -&gt; Maybe StateVal
</span><a href="SMType.html#s_val"><span class="hs-identifier hs-var hs-var">s_val</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679334854"><span class="hs-identifier hs-var">e2</span></a></span><span>
</span><span id="line-512"></span><span>        </span><span id="local-6989586621679334842"><span class="annot"><span class="annottext">sortByNames :: Set State -&gt; Set State -&gt; Ordering
</span><a href="#local-6989586621679334842"><span class="hs-identifier hs-var hs-var">sortByNames</span></a></span></span><span> </span><span id="local-6989586621679334841"><span class="annot"><span class="annottext">Set State
</span><a href="#local-6989586621679334841"><span class="hs-identifier hs-var">s1</span></a></span></span><span> </span><span id="local-6989586621679334840"><span class="annot"><span class="annottext">Set State
</span><a href="#local-6989586621679334840"><span class="hs-identifier hs-var">s2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(StateName, Int, Bool, Bool, Bool)
-&gt; (StateName, Int, Bool, Bool, Bool) -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">State -&gt; StateName
</span><a href="SMType.html#s_name"><span class="hs-identifier hs-var hs-var">s_name</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679334838"><span class="hs-identifier hs-var">e1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334837"><span class="hs-identifier hs-var">id1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Tag -&gt; Set Tag -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.member</span></span><span> </span><span class="annot"><span class="annottext">Tag
</span><a href="SMType.html#Dash"><span class="hs-identifier hs-var">Dash</span></a></span><span> </span><span class="annot"><span class="annottext">Set Tag
</span><a href="#local-6989586621679334836"><span class="hs-identifier hs-var">tag1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679334835"><span class="hs-identifier hs-var">be1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679334834"><span class="hs-identifier hs-var">bf1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">State -&gt; StateName
</span><a href="SMType.html#s_name"><span class="hs-identifier hs-var hs-var">s_name</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679334833"><span class="hs-identifier hs-var">e2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334832"><span class="hs-identifier hs-var">id2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Tag -&gt; Set Tag -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.member</span></span><span> </span><span class="annot"><span class="annottext">Tag
</span><a href="SMType.html#Dash"><span class="hs-identifier hs-var">Dash</span></a></span><span> </span><span class="annot"><span class="annottext">Set Tag
</span><a href="#local-6989586621679334831"><span class="hs-identifier hs-var">tag2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679334830"><span class="hs-identifier hs-var">be2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679334829"><span class="hs-identifier hs-var">bf2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-513"></span><span>                                </span><span class="hs-keyword">where</span><span>   </span><span id="local-6989586621679334838"><span class="annot"><span class="annottext">e1 :: State
</span><a href="#local-6989586621679334838"><span class="hs-identifier hs-var hs-var">e1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Set State -&gt; State
forall a. Int -&gt; Set a -&gt; a
</span><span class="hs-identifier hs-var">Set.elemAt</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Set State
</span><a href="#local-6989586621679334841"><span class="hs-identifier hs-var">s1</span></a></span><span>
</span><span id="line-514"></span><span>                                        </span><span id="local-6989586621679334833"><span class="annot"><span class="annottext">e2 :: State
</span><a href="#local-6989586621679334833"><span class="hs-identifier hs-var hs-var">e2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Set State -&gt; State
forall a. Int -&gt; Set a -&gt; a
</span><span class="hs-identifier hs-var">Set.elemAt</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Set State
</span><a href="#local-6989586621679334840"><span class="hs-identifier hs-var">s2</span></a></span><span>
</span><span id="line-515"></span><span>                                        </span><span id="local-6989586621679334836"><span class="annot"><span class="annottext">tag1 :: Set Tag
</span><a href="#local-6989586621679334836"><span class="hs-identifier hs-var hs-var">tag1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State -&gt; Set Tag
</span><a href="SMType.html#s_tags"><span class="hs-identifier hs-var hs-var">s_tags</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679334838"><span class="hs-identifier hs-var">e1</span></a></span><span>
</span><span id="line-516"></span><span>                                        </span><span id="local-6989586621679334831"><span class="annot"><span class="annottext">tag2 :: Set Tag
</span><a href="#local-6989586621679334831"><span class="hs-identifier hs-var hs-var">tag2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State -&gt; Set Tag
</span><a href="SMType.html#s_tags"><span class="hs-identifier hs-var hs-var">s_tags</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679334833"><span class="hs-identifier hs-var">e2</span></a></span><span>
</span><span id="line-517"></span><span>                                        </span><span id="local-6989586621679334837"><span class="annot"><span class="annottext">id1 :: Int
</span><a href="#local-6989586621679334837"><span class="hs-identifier hs-var hs-var">id1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateVal -&gt; Int
</span><a href="SMType.html#tape"><span class="hs-identifier hs-var hs-var">tape</span></a></span><span> </span><span class="annot"><span class="annottext">(StateVal -&gt; Int)
-&gt; (Maybe StateVal -&gt; StateVal) -&gt; Maybe StateVal -&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Maybe StateVal -&gt; StateVal
forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromJust</span></span><span> </span><span class="annot"><span class="annottext">(Maybe StateVal -&gt; Int) -&gt; Maybe StateVal -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">State -&gt; Maybe StateVal
</span><a href="SMType.html#s_val"><span class="hs-identifier hs-var hs-var">s_val</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679334838"><span class="hs-identifier hs-var">e1</span></a></span><span>
</span><span id="line-518"></span><span>                                        </span><span id="local-6989586621679334832"><span class="annot"><span class="annottext">id2 :: Int
</span><a href="#local-6989586621679334832"><span class="hs-identifier hs-var hs-var">id2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateVal -&gt; Int
</span><a href="SMType.html#tape"><span class="hs-identifier hs-var hs-var">tape</span></a></span><span> </span><span class="annot"><span class="annottext">(StateVal -&gt; Int)
-&gt; (Maybe StateVal -&gt; StateVal) -&gt; Maybe StateVal -&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Maybe StateVal -&gt; StateVal
forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromJust</span></span><span> </span><span class="annot"><span class="annottext">(Maybe StateVal -&gt; Int) -&gt; Maybe StateVal -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">State -&gt; Maybe StateVal
</span><a href="SMType.html#s_val"><span class="hs-identifier hs-var hs-var">s_val</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679334833"><span class="hs-identifier hs-var">e2</span></a></span><span>
</span><span id="line-519"></span><span>                                        </span><span id="local-6989586621679334835"><span class="annot"><span class="annottext">be1 :: Bool
</span><a href="#local-6989586621679334835"><span class="hs-identifier hs-var hs-var">be1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State -&gt; StateName
</span><a href="SMType.html#s_name"><span class="hs-identifier hs-var hs-var">s_name</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679334838"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="annot"><span class="annottext">StateName -&gt; StateName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">StateName
</span><a href="SMType.html#E"><span class="hs-identifier hs-var">E</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Set Tag -&gt; Bool
forall a. Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.null</span></span><span> </span><span class="annot"><span class="annottext">Set Tag
</span><a href="#local-6989586621679334836"><span class="hs-identifier hs-var">tag1</span></a></span><span>
</span><span id="line-520"></span><span>                                        </span><span id="local-6989586621679334830"><span class="annot"><span class="annottext">be2 :: Bool
</span><a href="#local-6989586621679334830"><span class="hs-identifier hs-var hs-var">be2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State -&gt; StateName
</span><a href="SMType.html#s_name"><span class="hs-identifier hs-var hs-var">s_name</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679334833"><span class="hs-identifier hs-var">e2</span></a></span><span> </span><span class="annot"><span class="annottext">StateName -&gt; StateName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">StateName
</span><a href="SMType.html#E"><span class="hs-identifier hs-var">E</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Set Tag -&gt; Bool
forall a. Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.null</span></span><span> </span><span class="annot"><span class="annottext">Set Tag
</span><a href="#local-6989586621679334831"><span class="hs-identifier hs-var">tag2</span></a></span><span>
</span><span id="line-521"></span><span>                                        </span><span id="local-6989586621679334834"><span class="annot"><span class="annottext">bf1 :: Bool
</span><a href="#local-6989586621679334834"><span class="hs-identifier hs-var hs-var">bf1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State -&gt; StateName
</span><a href="SMType.html#s_name"><span class="hs-identifier hs-var hs-var">s_name</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679334838"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="annot"><span class="annottext">StateName -&gt; StateName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">StateName
</span><a href="SMType.html#F"><span class="hs-identifier hs-var">F</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Set Tag -&gt; Bool
forall a. Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.null</span></span><span> </span><span class="annot"><span class="annottext">Set Tag
</span><a href="#local-6989586621679334836"><span class="hs-identifier hs-var">tag1</span></a></span><span>
</span><span id="line-522"></span><span>                                        </span><span id="local-6989586621679334829"><span class="annot"><span class="annottext">bf2 :: Bool
</span><a href="#local-6989586621679334829"><span class="hs-identifier hs-var hs-var">bf2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State -&gt; StateName
</span><a href="SMType.html#s_name"><span class="hs-identifier hs-var hs-var">s_name</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679334833"><span class="hs-identifier hs-var">e2</span></a></span><span> </span><span class="annot"><span class="annottext">StateName -&gt; StateName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">StateName
</span><a href="SMType.html#F"><span class="hs-identifier hs-var">F</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Set Tag -&gt; Bool
forall a. Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.null</span></span><span> </span><span class="annot"><span class="annottext">Set Tag
</span><a href="#local-6989586621679334831"><span class="hs-identifier hs-var">tag2</span></a></span><span>
</span><span id="line-523"></span><span>        </span><span id="local-6989586621679334828"><span class="annot"><span class="annottext">filterSmsStates :: Set State -&gt; Bool
</span><a href="#local-6989586621679334828"><span class="hs-identifier hs-var hs-var">filterSmsStates</span></a></span></span><span> </span><span id="local-6989586621679334827"><span class="annot"><span class="annottext">Set State
</span><a href="#local-6989586621679334827"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State -&gt; StateName
</span><a href="SMType.html#s_name"><span class="hs-identifier hs-var hs-var">s_name</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679334826"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">StateName -&gt; StateName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">StateName
</span><a href="SMType.html#F"><span class="hs-identifier hs-var">F</span></a></span><span>
</span><span id="line-524"></span><span>                                </span><span class="hs-keyword">where</span><span>   </span><span id="local-6989586621679334826"><span class="annot"><span class="annottext">e :: State
</span><a href="#local-6989586621679334826"><span class="hs-identifier hs-var hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Set State -&gt; State
forall a. Int -&gt; Set a -&gt; a
</span><span class="hs-identifier hs-var">Set.elemAt</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Set State
</span><a href="#local-6989586621679334827"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-525"></span><span>        </span><span id="local-6989586621679334825"><span class="annot"><span class="annottext">smsStates :: [Set State]
</span><a href="#local-6989586621679334825"><span class="hs-identifier hs-var hs-var">smsStates</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Set State -&gt; Bool) -&gt; [Set State] -&gt; [Set State]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="annot"><span class="annottext">Set State -&gt; Bool
</span><a href="#local-6989586621679334828"><span class="hs-identifier hs-var">filterSmsStates</span></a></span><span> </span><span class="annot"><span class="annottext">([Set State] -&gt; [Set State])
-&gt; ([[SM]] -&gt; [Set State]) -&gt; [[SM]] -&gt; [Set State]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">([SM] -&gt; [Set State]) -&gt; [[SM]] -&gt; [Set State]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([Set State] -&gt; Set State) -&gt; [[Set State]] -&gt; [Set State]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">[Set State] -&gt; Set State
forall (f :: * -&gt; *) a. (Foldable f, Ord a) =&gt; f (Set a) -&gt; Set a
</span><span class="hs-identifier hs-var">Set.unions</span></span><span> </span><span class="annot"><span class="annottext">([[Set State]] -&gt; [Set State])
-&gt; ([SM] -&gt; [[Set State]]) -&gt; [SM] -&gt; [Set State]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[[Set State]] -&gt; [[Set State]]
forall a. [[a]] -&gt; [[a]]
</span><span class="hs-identifier hs-var">transpose</span></span><span> </span><span class="annot"><span class="annottext">([[Set State]] -&gt; [[Set State]])
-&gt; ([SM] -&gt; [[Set State]]) -&gt; [SM] -&gt; [[Set State]]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(SM -&gt; [Set State]) -&gt; [SM] -&gt; [[Set State]]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">SM -&gt; [Set State]
</span><a href="SMType.html#qn"><span class="hs-identifier hs-var hs-var">qn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([[SM]] -&gt; [Set State]) -&gt; [[SM]] -&gt; [Set State]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[[SM]] -&gt; [[SM]]
forall a. [[a]] -&gt; [[a]]
</span><span class="hs-identifier hs-var">transpose</span></span><span> </span><span class="annot"><span class="annottext">[[SM]]
</span><a href="#local-6989586621679334863"><span class="hs-identifier hs-var">sms</span></a></span><span>
</span><span id="line-526"></span><span>        </span><span id="local-6989586621679334824"><span class="annot"><span class="annottext">otherStates :: [[State]]
</span><a href="#local-6989586621679334824"><span class="hs-identifier hs-var hs-var">otherStates</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679334823"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">s_val :: Maybe StateVal
</span><a href="SMType.html#s_val"><span class="hs-identifier hs-var">s_val</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateVal -&gt; Maybe StateVal
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(StateVal -&gt; Maybe StateVal) -&gt; StateVal -&gt; Maybe StateVal
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe StateVal -&gt; StateVal
forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromJust</span></span><span> </span><span class="annot"><span class="annottext">(Maybe StateVal -&gt; StateVal) -&gt; Maybe StateVal -&gt; StateVal
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">State -&gt; Maybe StateVal
</span><a href="SMType.html#s_val"><span class="hs-identifier hs-var hs-var">s_val</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679334823"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">tmCommand :: Maybe TMCMD
</span><a href="SMType.html#tmCommand"><span class="hs-identifier hs-var">tmCommand</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TMCMD -&gt; Maybe TMCMD
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(TMCMD -&gt; Maybe TMCMD) -&gt; TMCMD -&gt; Maybe TMCMD
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[TapeCommand] -&gt; TMCMD
</span><a href="SMType.html#Command"><span class="hs-identifier hs-var">Command</span></a></span><span> </span><span class="annot"><span class="annottext">[TapeCommand]
</span><a href="#local-6989586621679334821"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">smTag :: Maybe SMTag
</span><a href="SMType.html#smTag"><span class="hs-identifier hs-var">smTag</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SMTag -&gt; Maybe SMTag
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679334819"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">}</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679334823"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679334823"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[State]
</span><a href="#local-6989586621679334818"><span class="hs-identifier hs-var">state</span></a></span><span> </span><span class="hs-special">]</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679334819"><span class="annot"><span class="annottext">SMTag
</span><a href="#local-6989586621679334819"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[SMTag]
</span><a href="#local-6989586621679334904"><span class="hs-identifier hs-var">gamma</span></a></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679334821"><span class="annot"><span class="annottext">[TapeCommand]
</span><a href="#local-6989586621679334821"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[[TapeCommand]]
</span><a href="#local-6989586621679334865"><span class="hs-identifier hs-var">pos21</span></a></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679334818"><span class="annot"><span class="annottext">[State]
</span><a href="#local-6989586621679334818"><span class="hs-identifier hs-var">state</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[[State]]
</span><a href="#local-6989586621679334867"><span class="hs-identifier hs-var">standardStates</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-527"></span><span>        </span><span id="local-6989586621679334817"><span class="annot"><span class="annottext">smsConnectingRules :: [SRule]
</span><a href="#local-6989586621679334817"><span class="hs-identifier hs-var hs-var">smsConnectingRules</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([TapeCommand] -&gt; [SRule]) -&gt; [[TapeCommand]] -&gt; [SRule]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TMCMD -&gt; [SRule]
</span><a href="TM2SM.html#genConnectingRules"><span class="hs-identifier hs-var">genConnectingRules</span></a></span><span> </span><span class="annot"><span class="annottext">(TMCMD -&gt; [SRule])
-&gt; ([TapeCommand] -&gt; TMCMD) -&gt; [TapeCommand] -&gt; [SRule]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[TapeCommand] -&gt; TMCMD
</span><a href="SMType.html#Command"><span class="hs-identifier hs-var">Command</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[[TapeCommand]]
</span><a href="#local-6989586621679334865"><span class="hs-identifier hs-var">pos21</span></a></span><span>
</span><span id="line-528"></span><span>        </span><span id="local-6989586621679334816"><span class="annot"><span class="annottext">crStates :: [[State]]
</span><a href="#local-6989586621679334816"><span class="hs-identifier hs-var hs-var">crStates</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(State -&gt; State -&gt; Bool) -&gt; [State] -&gt; [[State]]
forall a. (a -&gt; a -&gt; Bool) -&gt; [a] -&gt; [[a]]
</span><span class="hs-identifier hs-var">groupBy</span></span><span> </span><span class="annot"><span class="annottext">State -&gt; State -&gt; Bool
</span><a href="#local-6989586621679334815"><span class="hs-identifier hs-var">groupByStatesFunc</span></a></span><span> </span><span class="annot"><span class="annottext">([State] -&gt; [[State]])
-&gt; ([SRule] -&gt; [State]) -&gt; [SRule] -&gt; [[State]]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(State -&gt; State -&gt; Ordering) -&gt; [State] -&gt; [State]
forall a. (a -&gt; a -&gt; Ordering) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">sortBy</span></span><span> </span><span class="annot"><span class="annottext">State -&gt; State -&gt; Ordering
</span><a href="#local-6989586621679334814"><span class="hs-identifier hs-var">sortByNamesStates</span></a></span><span> </span><span class="annot"><span class="annottext">([State] -&gt; [State]) -&gt; ([SRule] -&gt; [State]) -&gt; [SRule] -&gt; [State]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(SRule -&gt; [State]) -&gt; [SRule] -&gt; [State]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">SRule -&gt; [State]
</span><a href="#local-6989586621679334813"><span class="hs-identifier hs-var">getStatesFromRule</span></a></span><span> </span><span class="annot"><span class="annottext">([SRule] -&gt; [[State]]) -&gt; [SRule] -&gt; [[State]]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[SRule]
</span><a href="#local-6989586621679334817"><span class="hs-identifier hs-var">smsConnectingRules</span></a></span><span>
</span><span id="line-529"></span><span>                </span><span class="hs-keyword">where</span><span>
</span><span id="line-530"></span><span>                        </span><span id="local-6989586621679334812"><span class="annot"><span class="annottext">getStatesFromWord :: Smb -&gt; Maybe State
</span><a href="#local-6989586621679334812"><span class="hs-identifier hs-var hs-var">getStatesFromWord</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="SMType.html#SmbQ"><span class="hs-identifier hs-type">SmbQ</span></a></span><span> </span><span id="local-6989586621679334811"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679334811"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State -&gt; Maybe State
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679334811"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-531"></span><span>                        </span><span class="annot"><a href="#local-6989586621679334812"><span class="hs-identifier hs-var">getStatesFromWord</span></a></span><span> </span><span class="annot"><span class="annottext">Smb
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe State
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-532"></span><span>                        </span><span id="local-6989586621679334810"><span class="annot"><span class="annottext">getStatesFromWords :: (Word, Word) -&gt; [State]
</span><a href="#local-6989586621679334810"><span class="hs-identifier hs-var hs-var">getStatesFromWords</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="SMType.html#Word"><span class="hs-identifier hs-type">Word</span></a></span><span> </span><span id="local-6989586621679334809"><span class="annot"><span class="annottext">[Smb]
</span><a href="#local-6989586621679334809"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="SMType.html#Word"><span class="hs-identifier hs-type">Word</span></a></span><span> </span><span id="local-6989586621679334808"><span class="annot"><span class="annottext">[Smb]
</span><a href="#local-6989586621679334808"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Smb -&gt; Maybe State) -&gt; [Smb] -&gt; [State]
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">mapMaybe</span></span><span> </span><span class="annot"><span class="annottext">Smb -&gt; Maybe State
</span><a href="#local-6989586621679334812"><span class="hs-identifier hs-var">getStatesFromWord</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Smb]
</span><a href="#local-6989586621679334809"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">[Smb] -&gt; [Smb] -&gt; [Smb]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Smb]
</span><a href="#local-6989586621679334808"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-533"></span><span>                        </span><span id="local-6989586621679334813"><span class="annot"><span class="annottext">getStatesFromRule :: SRule -&gt; [State]
</span><a href="#local-6989586621679334813"><span class="hs-identifier hs-var hs-var">getStatesFromRule</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="SMType.html#SRule"><span class="hs-identifier hs-type">SRule</span></a></span><span> </span><span id="local-6989586621679334807"><span class="annot"><span class="annottext">[(Word, Word)]
</span><a href="#local-6989586621679334807"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Word, Word) -&gt; [State]) -&gt; [(Word, Word)] -&gt; [State]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">(Word, Word) -&gt; [State]
</span><a href="#local-6989586621679334810"><span class="hs-identifier hs-var">getStatesFromWords</span></a></span><span> </span><span class="annot"><span class="annottext">[(Word, Word)]
</span><a href="#local-6989586621679334807"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-534"></span><span>                        </span><span id="local-6989586621679334815"><span class="annot"><span class="annottext">groupByStatesFunc :: State -&gt; State -&gt; Bool
</span><a href="#local-6989586621679334815"><span class="hs-identifier hs-var hs-var">groupByStatesFunc</span></a></span></span><span> </span><span id="local-6989586621679334806"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679334806"><span class="hs-identifier hs-var">s1</span></a></span></span><span> </span><span id="local-6989586621679334805"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679334805"><span class="hs-identifier hs-var">s2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State -&gt; StateName
</span><a href="SMType.html#s_name"><span class="hs-identifier hs-var hs-var">s_name</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679334806"><span class="hs-identifier hs-var">s1</span></a></span><span> </span><span class="annot"><span class="annottext">StateName -&gt; StateName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">State -&gt; StateName
</span><a href="SMType.html#s_name"><span class="hs-identifier hs-var hs-var">s_name</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679334805"><span class="hs-identifier hs-var">s2</span></a></span><span>
</span><span id="line-535"></span><span>                                            </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Tag -&gt; Set Tag -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.member</span></span><span> </span><span class="annot"><span class="annottext">Tag
</span><a href="SMType.html#Dash"><span class="hs-identifier hs-var">Dash</span></a></span><span> </span><span class="annot"><span class="annottext">Set Tag
</span><a href="#local-6989586621679334804"><span class="hs-identifier hs-var">tag1</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Tag -&gt; Set Tag -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.member</span></span><span> </span><span class="annot"><span class="annottext">Tag
</span><a href="SMType.html#Dash"><span class="hs-identifier hs-var">Dash</span></a></span><span> </span><span class="annot"><span class="annottext">Set Tag
</span><a href="#local-6989586621679334803"><span class="hs-identifier hs-var">tag2</span></a></span><span>
</span><span id="line-536"></span><span>                                            </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334802"><span class="hs-identifier hs-var">id1</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334801"><span class="hs-identifier hs-var">id2</span></a></span><span>
</span><span id="line-537"></span><span>                                            </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">State -&gt; StateName
</span><a href="SMType.html#s_name"><span class="hs-identifier hs-var hs-var">s_name</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679334806"><span class="hs-identifier hs-var">s1</span></a></span><span> </span><span class="annot"><span class="annottext">StateName -&gt; StateName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">StateName
</span><a href="SMType.html#E"><span class="hs-identifier hs-var">E</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Set Tag -&gt; Bool
forall a. Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.null</span></span><span> </span><span class="annot"><span class="annottext">Set Tag
</span><a href="#local-6989586621679334804"><span class="hs-identifier hs-var">tag1</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Set Tag -&gt; Bool
forall a. Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.null</span></span><span> </span><span class="annot"><span class="annottext">Set Tag
</span><a href="#local-6989586621679334803"><span class="hs-identifier hs-var">tag2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-538"></span><span>                                            </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">State -&gt; StateName
</span><a href="SMType.html#s_name"><span class="hs-identifier hs-var hs-var">s_name</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679334806"><span class="hs-identifier hs-var">s1</span></a></span><span> </span><span class="annot"><span class="annottext">StateName -&gt; StateName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">StateName
</span><a href="SMType.html#F"><span class="hs-identifier hs-var">F</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Set Tag -&gt; Bool
forall a. Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.null</span></span><span> </span><span class="annot"><span class="annottext">Set Tag
</span><a href="#local-6989586621679334804"><span class="hs-identifier hs-var">tag1</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Set Tag -&gt; Bool
forall a. Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.null</span></span><span> </span><span class="annot"><span class="annottext">Set Tag
</span><a href="#local-6989586621679334803"><span class="hs-identifier hs-var">tag2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-539"></span><span>                                            </span><span class="hs-keyword">where</span><span>   </span><span id="local-6989586621679334804"><span class="annot"><span class="annottext">tag1 :: Set Tag
</span><a href="#local-6989586621679334804"><span class="hs-identifier hs-var hs-var">tag1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State -&gt; Set Tag
</span><a href="SMType.html#s_tags"><span class="hs-identifier hs-var hs-var">s_tags</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679334806"><span class="hs-identifier hs-var">s1</span></a></span><span>
</span><span id="line-540"></span><span>                                                    </span><span id="local-6989586621679334803"><span class="annot"><span class="annottext">tag2 :: Set Tag
</span><a href="#local-6989586621679334803"><span class="hs-identifier hs-var hs-var">tag2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State -&gt; Set Tag
</span><a href="SMType.html#s_tags"><span class="hs-identifier hs-var hs-var">s_tags</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679334805"><span class="hs-identifier hs-var">s2</span></a></span><span>
</span><span id="line-541"></span><span>                                                    </span><span id="local-6989586621679334802"><span class="annot"><span class="annottext">id1 :: Int
</span><a href="#local-6989586621679334802"><span class="hs-identifier hs-var hs-var">id1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateVal -&gt; Int
</span><a href="SMType.html#tape"><span class="hs-identifier hs-var hs-var">tape</span></a></span><span> </span><span class="annot"><span class="annottext">(StateVal -&gt; Int)
-&gt; (Maybe StateVal -&gt; StateVal) -&gt; Maybe StateVal -&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Maybe StateVal -&gt; StateVal
forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromJust</span></span><span> </span><span class="annot"><span class="annottext">(Maybe StateVal -&gt; Int) -&gt; Maybe StateVal -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">State -&gt; Maybe StateVal
</span><a href="SMType.html#s_val"><span class="hs-identifier hs-var hs-var">s_val</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679334806"><span class="hs-identifier hs-var">s1</span></a></span><span>
</span><span id="line-542"></span><span>                                                    </span><span id="local-6989586621679334801"><span class="annot"><span class="annottext">id2 :: Int
</span><a href="#local-6989586621679334801"><span class="hs-identifier hs-var hs-var">id2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateVal -&gt; Int
</span><a href="SMType.html#tape"><span class="hs-identifier hs-var hs-var">tape</span></a></span><span> </span><span class="annot"><span class="annottext">(StateVal -&gt; Int)
-&gt; (Maybe StateVal -&gt; StateVal) -&gt; Maybe StateVal -&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Maybe StateVal -&gt; StateVal
forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromJust</span></span><span> </span><span class="annot"><span class="annottext">(Maybe StateVal -&gt; Int) -&gt; Maybe StateVal -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">State -&gt; Maybe StateVal
</span><a href="SMType.html#s_val"><span class="hs-identifier hs-var hs-var">s_val</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679334805"><span class="hs-identifier hs-var">s2</span></a></span><span>
</span><span id="line-543"></span><span>                        </span><span id="local-6989586621679334814"><span class="annot"><span class="annottext">sortByNamesStates :: State -&gt; State -&gt; Ordering
</span><a href="#local-6989586621679334814"><span class="hs-identifier hs-var hs-var">sortByNamesStates</span></a></span></span><span> </span><span id="local-6989586621679334800"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679334800"><span class="hs-identifier hs-var">s1</span></a></span></span><span> </span><span id="local-6989586621679334799"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679334799"><span class="hs-identifier hs-var">s2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(StateName, Int, Bool, Bool, Bool)
-&gt; (StateName, Int, Bool, Bool, Bool) -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">State -&gt; StateName
</span><a href="SMType.html#s_name"><span class="hs-identifier hs-var hs-var">s_name</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679334800"><span class="hs-identifier hs-var">s1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334798"><span class="hs-identifier hs-var">id1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Tag -&gt; Set Tag -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.member</span></span><span> </span><span class="annot"><span class="annottext">Tag
</span><a href="SMType.html#Dash"><span class="hs-identifier hs-var">Dash</span></a></span><span> </span><span class="annot"><span class="annottext">Set Tag
</span><a href="#local-6989586621679334797"><span class="hs-identifier hs-var">tag1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679334796"><span class="hs-identifier hs-var">be1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679334795"><span class="hs-identifier hs-var">bf1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">State -&gt; StateName
</span><a href="SMType.html#s_name"><span class="hs-identifier hs-var hs-var">s_name</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679334799"><span class="hs-identifier hs-var">s2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334794"><span class="hs-identifier hs-var">id2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Tag -&gt; Set Tag -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.member</span></span><span> </span><span class="annot"><span class="annottext">Tag
</span><a href="SMType.html#Dash"><span class="hs-identifier hs-var">Dash</span></a></span><span> </span><span class="annot"><span class="annottext">Set Tag
</span><a href="#local-6989586621679334793"><span class="hs-identifier hs-var">tag2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679334792"><span class="hs-identifier hs-var">be2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679334791"><span class="hs-identifier hs-var">bf2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-544"></span><span>                                            </span><span class="hs-keyword">where</span><span>   </span><span id="local-6989586621679334797"><span class="annot"><span class="annottext">tag1 :: Set Tag
</span><a href="#local-6989586621679334797"><span class="hs-identifier hs-var hs-var">tag1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State -&gt; Set Tag
</span><a href="SMType.html#s_tags"><span class="hs-identifier hs-var hs-var">s_tags</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679334800"><span class="hs-identifier hs-var">s1</span></a></span><span>
</span><span id="line-545"></span><span>                                                    </span><span id="local-6989586621679334793"><span class="annot"><span class="annottext">tag2 :: Set Tag
</span><a href="#local-6989586621679334793"><span class="hs-identifier hs-var hs-var">tag2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State -&gt; Set Tag
</span><a href="SMType.html#s_tags"><span class="hs-identifier hs-var hs-var">s_tags</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679334799"><span class="hs-identifier hs-var">s2</span></a></span><span>
</span><span id="line-546"></span><span>                                                    </span><span id="local-6989586621679334798"><span class="annot"><span class="annottext">id1 :: Int
</span><a href="#local-6989586621679334798"><span class="hs-identifier hs-var hs-var">id1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateVal -&gt; Int
</span><a href="SMType.html#tape"><span class="hs-identifier hs-var hs-var">tape</span></a></span><span> </span><span class="annot"><span class="annottext">(StateVal -&gt; Int)
-&gt; (Maybe StateVal -&gt; StateVal) -&gt; Maybe StateVal -&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Maybe StateVal -&gt; StateVal
forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromJust</span></span><span> </span><span class="annot"><span class="annottext">(Maybe StateVal -&gt; Int) -&gt; Maybe StateVal -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">State -&gt; Maybe StateVal
</span><a href="SMType.html#s_val"><span class="hs-identifier hs-var hs-var">s_val</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679334800"><span class="hs-identifier hs-var">s1</span></a></span><span>
</span><span id="line-547"></span><span>                                                    </span><span id="local-6989586621679334794"><span class="annot"><span class="annottext">id2 :: Int
</span><a href="#local-6989586621679334794"><span class="hs-identifier hs-var hs-var">id2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateVal -&gt; Int
</span><a href="SMType.html#tape"><span class="hs-identifier hs-var hs-var">tape</span></a></span><span> </span><span class="annot"><span class="annottext">(StateVal -&gt; Int)
-&gt; (Maybe StateVal -&gt; StateVal) -&gt; Maybe StateVal -&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Maybe StateVal -&gt; StateVal
forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromJust</span></span><span> </span><span class="annot"><span class="annottext">(Maybe StateVal -&gt; Int) -&gt; Maybe StateVal -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">State -&gt; Maybe StateVal
</span><a href="SMType.html#s_val"><span class="hs-identifier hs-var hs-var">s_val</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679334799"><span class="hs-identifier hs-var">s2</span></a></span><span>
</span><span id="line-548"></span><span>                                                    </span><span id="local-6989586621679334796"><span class="annot"><span class="annottext">be1 :: Bool
</span><a href="#local-6989586621679334796"><span class="hs-identifier hs-var hs-var">be1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State -&gt; StateName
</span><a href="SMType.html#s_name"><span class="hs-identifier hs-var hs-var">s_name</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679334800"><span class="hs-identifier hs-var">s1</span></a></span><span> </span><span class="annot"><span class="annottext">StateName -&gt; StateName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">StateName
</span><a href="SMType.html#E"><span class="hs-identifier hs-var">E</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Set Tag -&gt; Bool
forall a. Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.null</span></span><span> </span><span class="annot"><span class="annottext">Set Tag
</span><a href="#local-6989586621679334797"><span class="hs-identifier hs-var">tag1</span></a></span><span>
</span><span id="line-549"></span><span>                                                    </span><span id="local-6989586621679334792"><span class="annot"><span class="annottext">be2 :: Bool
</span><a href="#local-6989586621679334792"><span class="hs-identifier hs-var hs-var">be2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State -&gt; StateName
</span><a href="SMType.html#s_name"><span class="hs-identifier hs-var hs-var">s_name</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679334799"><span class="hs-identifier hs-var">s2</span></a></span><span> </span><span class="annot"><span class="annottext">StateName -&gt; StateName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">StateName
</span><a href="SMType.html#E"><span class="hs-identifier hs-var">E</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Set Tag -&gt; Bool
forall a. Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.null</span></span><span> </span><span class="annot"><span class="annottext">Set Tag
</span><a href="#local-6989586621679334793"><span class="hs-identifier hs-var">tag2</span></a></span><span>
</span><span id="line-550"></span><span>                                                    </span><span id="local-6989586621679334795"><span class="annot"><span class="annottext">bf1 :: Bool
</span><a href="#local-6989586621679334795"><span class="hs-identifier hs-var hs-var">bf1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State -&gt; StateName
</span><a href="SMType.html#s_name"><span class="hs-identifier hs-var hs-var">s_name</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679334800"><span class="hs-identifier hs-var">s1</span></a></span><span> </span><span class="annot"><span class="annottext">StateName -&gt; StateName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">StateName
</span><a href="SMType.html#F"><span class="hs-identifier hs-var">F</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Set Tag -&gt; Bool
forall a. Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.null</span></span><span> </span><span class="annot"><span class="annottext">Set Tag
</span><a href="#local-6989586621679334797"><span class="hs-identifier hs-var">tag1</span></a></span><span>
</span><span id="line-551"></span><span>                                                    </span><span id="local-6989586621679334791"><span class="annot"><span class="annottext">bf2 :: Bool
</span><a href="#local-6989586621679334791"><span class="hs-identifier hs-var hs-var">bf2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State -&gt; StateName
</span><a href="SMType.html#s_name"><span class="hs-identifier hs-var hs-var">s_name</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679334799"><span class="hs-identifier hs-var">s2</span></a></span><span> </span><span class="annot"><span class="annottext">StateName -&gt; StateName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">StateName
</span><a href="SMType.html#F"><span class="hs-identifier hs-var">F</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Set Tag -&gt; Bool
forall a. Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.null</span></span><span> </span><span class="annot"><span class="annottext">Set Tag
</span><a href="#local-6989586621679334793"><span class="hs-identifier hs-var">tag2</span></a></span><span>
</span><span id="line-552"></span><span>        </span><span id="local-6989586621679334790"><span class="annot"><span class="annottext">finalSmStates :: [Set State]
</span><a href="#local-6989586621679334790"><span class="hs-identifier hs-var hs-var">finalSmStates</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Set State] -&gt; Set State) -&gt; [[Set State]] -&gt; [Set State]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">[Set State] -&gt; Set State
forall (f :: * -&gt; *) a. (Foldable f, Ord a) =&gt; f (Set a) -&gt; Set a
</span><span class="hs-identifier hs-var">Set.unions</span></span><span> </span><span class="annot"><span class="annottext">([[Set State]] -&gt; [Set State])
-&gt; ([Set State] -&gt; [[Set State]]) -&gt; [Set State] -&gt; [Set State]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Set State -&gt; Set State -&gt; Bool) -&gt; [Set State] -&gt; [[Set State]]
forall a. (a -&gt; a -&gt; Bool) -&gt; [a] -&gt; [[a]]
</span><span class="hs-identifier hs-var">groupBy</span></span><span> </span><span class="annot"><span class="annottext">Set State -&gt; Set State -&gt; Bool
</span><a href="#local-6989586621679334858"><span class="hs-identifier hs-var">groupByStates</span></a></span><span> </span><span class="annot"><span class="annottext">([Set State] -&gt; [[Set State]])
-&gt; ([Set State] -&gt; [Set State]) -&gt; [Set State] -&gt; [[Set State]]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Set State -&gt; Set State -&gt; Ordering) -&gt; [Set State] -&gt; [Set State]
forall a. (a -&gt; a -&gt; Ordering) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">sortBy</span></span><span> </span><span class="annot"><span class="annottext">Set State -&gt; Set State -&gt; Ordering
</span><a href="#local-6989586621679334842"><span class="hs-identifier hs-var">sortByNames</span></a></span><span> </span><span class="annot"><span class="annottext">([Set State] -&gt; [Set State]) -&gt; [Set State] -&gt; [Set State]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">([State] -&gt; Set State) -&gt; [[State]] -&gt; [Set State]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">[State] -&gt; Set State
forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">Set.fromList</span></span><span> </span><span class="annot"><span class="annottext">[[State]]
</span><a href="#local-6989586621679334867"><span class="hs-identifier hs-var">standardStates</span></a></span><span> </span><span class="annot"><span class="annottext">[Set State] -&gt; [Set State] -&gt; [Set State]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">([State] -&gt; Set State) -&gt; [[State]] -&gt; [Set State]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">[State] -&gt; Set State
forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">Set.fromList</span></span><span> </span><span class="annot"><span class="annottext">[[State]]
</span><a href="#local-6989586621679334824"><span class="hs-identifier hs-var">otherStates</span></a></span><span> </span><span class="annot"><span class="annottext">[Set State] -&gt; [Set State] -&gt; [Set State]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Set State]
</span><a href="#local-6989586621679334825"><span class="hs-identifier hs-var">smsStates</span></a></span><span> </span><span class="annot"><span class="annottext">[Set State] -&gt; [Set State] -&gt; [Set State]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">([State] -&gt; Set State) -&gt; [[State]] -&gt; [Set State]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">[State] -&gt; Set State
forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">Set.fromList</span></span><span> </span><span class="annot"><span class="annottext">[[State]]
</span><a href="#local-6989586621679334816"><span class="hs-identifier hs-var">crStates</span></a></span><span>
</span><span id="line-553"></span><span>        </span><span id="local-6989586621679334789"><span class="annot"><span class="annottext">smsPos22Rules :: [SRule]
</span><a href="#local-6989586621679334789"><span class="hs-identifier hs-var hs-var">smsPos22Rules</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([TapeCommand] -&gt; SRule) -&gt; [[TapeCommand]] -&gt; [SRule]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TMCMD -&gt; SRule
</span><a href="TM2SM.html#genPos22Rule"><span class="hs-identifier hs-var">genPos22Rule</span></a></span><span> </span><span class="annot"><span class="annottext">(TMCMD -&gt; SRule)
-&gt; ([TapeCommand] -&gt; TMCMD) -&gt; [TapeCommand] -&gt; SRule
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[TapeCommand] -&gt; TMCMD
</span><a href="SMType.html#Command"><span class="hs-identifier hs-var">Command</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[[TapeCommand]]
</span><a href="#local-6989586621679334864"><span class="hs-identifier hs-var">pos22</span></a></span><span>
</span><span id="line-554"></span><span>
</span><span id="line-555"></span><span>        </span><span id="local-6989586621679334788"><span class="annot"><span class="annottext">finalSmRules :: [SRule]
</span><a href="#local-6989586621679334788"><span class="hs-identifier hs-var hs-var">finalSmRules</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[SRule]
</span><a href="#local-6989586621679334859"><span class="hs-identifier hs-var">smsRules</span></a></span><span> </span><span class="annot"><span class="annottext">[SRule] -&gt; [SRule] -&gt; [SRule]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[SRule]
</span><a href="#local-6989586621679334817"><span class="hs-identifier hs-var">smsConnectingRules</span></a></span><span> </span><span class="annot"><span class="annottext">[SRule] -&gt; [SRule] -&gt; [SRule]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[SRule]
</span><a href="#local-6989586621679334789"><span class="hs-identifier hs-var">smsPos22Rules</span></a></span><span>
</span><span id="line-556"></span><span>        </span><span class="hs-comment">--symmFinalSmRules = (++) finalSmRules $ map symSM finalSmRules</span><span>
</span><span id="line-557"></span><span>
</span><span id="line-558"></span><span>    </span><span class="hs-keyword">in</span><span>
</span><span id="line-559"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[[Y]] -&gt; [Set State] -&gt; [SRule] -&gt; SM
</span><a href="SMType.html#SM"><span class="hs-identifier hs-var">SM</span></a></span><span> </span><span class="annot"><span class="annottext">[[Y]]
</span><a href="#local-6989586621679334903"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">[Set State]
</span><a href="#local-6989586621679334790"><span class="hs-identifier hs-var">finalSmStates</span></a></span><span> </span><span class="annot"><span class="annottext">[SRule]
</span><a href="#local-6989586621679334788"><span class="hs-identifier hs-var">finalSmRules</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[State] -&gt; [[Smb]] -&gt; Word
</span><a href="TM2SM.html#sigmaFunc"><span class="hs-identifier hs-var">sigmaFunc</span></a></span><span> </span><span class="annot"><span class="annottext">[State]
</span><a href="#local-6989586621679334906"><span class="hs-identifier hs-var">accessStates</span></a></span><span> </span><span class="annot"><span class="annottext">([[Smb]] -&gt; Word) -&gt; [[Smb]] -&gt; Word
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Smb] -&gt; [[Smb]]
forall a. Int -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">replicate</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679334905"><span class="hs-identifier hs-var">numOfTapes</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[State]
</span><a href="#local-6989586621679334908"><span class="hs-identifier hs-var">startStates</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-560"></span></pre></body></html>
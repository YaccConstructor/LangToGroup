<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE TupleSections #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase #-}</span><span>
</span><span id="line-3"></span><span>
</span><span id="line-4"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Boolean2TMHelpers</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-5"></span><span>
</span><span id="line-6"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GrammarType.html"><span class="hs-identifier">GrammarType</span></a></span><span>
</span><span id="line-7"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="DebuggingTMTypes.html"><span class="hs-identifier">DebuggingTMTypes</span></a></span><span>
</span><span id="line-8"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Ord</span></span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span>
</span><span id="line-13"></span><span>
</span><span id="line-14"></span><span class="annot"><a href="Boolean2TMHelpers.html#calculateMaxNumberOfRulesForNonterminal"><span class="hs-identifier hs-type">calculateMaxNumberOfRulesForNonterminal</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GrammarType.html#Grammar"><span class="hs-identifier hs-type">Grammar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-15"></span><span id="calculateMaxNumberOfRulesForNonterminal"><span class="annot"><span class="annottext">calculateMaxNumberOfRulesForNonterminal :: Grammar -&gt; Int
</span><a href="Boolean2TMHelpers.html#calculateMaxNumberOfRulesForNonterminal"><span class="hs-identifier hs-var hs-var">calculateMaxNumberOfRulesForNonterminal</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GrammarType.html#Grammar"><span class="hs-identifier hs-type">Grammar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set Nonterminal
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set Terminal
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679339991"><span class="annot"><span class="annottext">Set Relation
</span><a href="#local-6989586621679339991"><span class="hs-identifier hs-var">relations</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Nonterminal
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span>
</span><span id="line-16"></span><span>    </span><span id="local-6989586621679339990"><span class="annot"><span class="annottext">listRelations :: [Relation]
</span><a href="#local-6989586621679339990"><span class="hs-identifier hs-var hs-var">listRelations</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set Relation -&gt; [Relation]
forall a. Set a -&gt; [a]
</span><span class="hs-identifier hs-var">Set.toList</span></span><span> </span><span class="annot"><span class="annottext">Set Relation
</span><a href="#local-6989586621679339991"><span class="hs-identifier hs-var">relations</span></a></span><span>
</span><span id="line-17"></span><span>    </span><span id="local-6989586621679339988"><span class="annot"><span class="annottext">groupedRelations :: Map Nonterminal [[Conj]]
</span><a href="#local-6989586621679339988"><span class="hs-identifier hs-var hs-var">groupedRelations</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Relation] -&gt; Map Nonterminal [[Conj]]
</span><a href="Boolean2TMHelpers.html#calculateGroupRelationsByNonterminals"><span class="hs-identifier hs-var">calculateGroupRelationsByNonterminals</span></a></span><span> </span><span class="annot"><span class="annottext">[Relation]
</span><a href="#local-6989586621679339990"><span class="hs-identifier hs-var">listRelations</span></a></span><span>
</span><span id="line-18"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Nonterminal, Int) -&gt; Int
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((Nonterminal, Int) -&gt; Int) -&gt; (Nonterminal, Int) -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((Nonterminal, Int) -&gt; (Nonterminal, Int) -&gt; Ordering)
-&gt; [(Nonterminal, Int)] -&gt; (Nonterminal, Int)
forall (t :: * -&gt; *) a.
Foldable t =&gt;
(a -&gt; a -&gt; Ordering) -&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">maximumBy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Nonterminal, Int) -&gt; Int)
-&gt; (Nonterminal, Int) -&gt; (Nonterminal, Int) -&gt; Ordering
forall a b. Ord a =&gt; (b -&gt; a) -&gt; b -&gt; b -&gt; Ordering
</span><span class="hs-identifier hs-var">comparing</span></span><span> </span><span class="annot"><span class="annottext">(Nonterminal, Int) -&gt; Int
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Nonterminal Int -&gt; [(Nonterminal, Int)]
forall k a. Map k a -&gt; [(k, a)]
</span><span class="hs-identifier hs-var">Map.toList</span></span><span> </span><span class="annot"><span class="annottext">(Map Nonterminal Int -&gt; [(Nonterminal, Int)])
-&gt; Map Nonterminal Int -&gt; [(Nonterminal, Int)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">([[Conj]] -&gt; Int)
-&gt; Map Nonterminal [[Conj]] -&gt; Map Nonterminal Int
forall a b k. (a -&gt; b) -&gt; Map k a -&gt; Map k b
</span><span class="hs-identifier hs-var">Map.map</span></span><span> </span><span class="annot"><span class="annottext">[[Conj]] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">Map Nonterminal [[Conj]]
</span><a href="#local-6989586621679339988"><span class="hs-identifier hs-var">groupedRelations</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span>
</span><span id="line-21"></span><span class="annot"><a href="Boolean2TMHelpers.html#calculateGroupRelationsByNonterminals"><span class="hs-identifier hs-type">calculateGroupRelationsByNonterminals</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GrammarType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span><span> </span><span class="annot"><a href="GrammarType.html#Nonterminal"><span class="hs-identifier hs-type">Nonterminal</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="GrammarType.html#Conj"><span class="hs-identifier hs-type">Conj</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-22"></span><span id="calculateGroupRelationsByNonterminals"><span class="annot"><span class="annottext">calculateGroupRelationsByNonterminals :: [Relation] -&gt; Map Nonterminal [[Conj]]
</span><a href="Boolean2TMHelpers.html#calculateGroupRelationsByNonterminals"><span class="hs-identifier hs-var hs-var">calculateGroupRelationsByNonterminals</span></a></span></span><span> </span><span id="local-6989586621679339981"><span class="annot"><span class="annottext">[Relation]
</span><a href="#local-6989586621679339981"><span class="hs-identifier hs-var">relations</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span>
</span><span id="line-23"></span><span>    </span><span id="local-6989586621679339980"><span class="annot"><span class="annottext">relations' :: [Relation]
</span><a href="#local-6989586621679339980"><span class="hs-identifier hs-var hs-var">relations'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Relation -&gt; Relation) -&gt; [Relation] -&gt; [Relation]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-24"></span><span>        </span><span class="annot"><a href="GrammarType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679339978"><span class="annot"><span class="annottext">Nonterminal
</span><a href="#local-6989586621679339978"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679339977"><span class="annot"><span class="annottext">[Symbol]
</span><a href="#local-6989586621679339977"><span class="hs-identifier hs-var">cfgRightPart</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Nonterminal, [Conj]) -&gt; Relation
</span><a href="GrammarType.html#BooleanRelation"><span class="hs-identifier hs-var">BooleanRelation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Nonterminal
</span><a href="#local-6989586621679339978"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Symbol] -&gt; Conj
</span><a href="GrammarType.html#PosConj"><span class="hs-identifier hs-var">PosConj</span></a></span><span> </span><span class="annot"><span class="annottext">[Symbol]
</span><a href="#local-6989586621679339977"><span class="hs-identifier hs-var">cfgRightPart</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span>        </span><span id="local-6989586621679339974"><span class="annot"><span class="annottext">Relation
</span><a href="#local-6989586621679339974"><span class="hs-identifier hs-var">boolRel</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Relation
</span><a href="#local-6989586621679339974"><span class="hs-identifier hs-var">boolRel</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Relation]
</span><a href="#local-6989586621679339981"><span class="hs-identifier hs-var">relations</span></a></span><span>
</span><span id="line-26"></span><span>
</span><span id="line-27"></span><span>    </span><span id="local-6989586621679339973"><span class="annot"><span class="annottext">mapWithReversedRelationsOrder :: Map Nonterminal [[Conj]]
</span><a href="#local-6989586621679339973"><span class="hs-identifier hs-var hs-var">mapWithReversedRelationsOrder</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([[Conj]] -&gt; [[Conj]] -&gt; [[Conj]])
-&gt; [(Nonterminal, [[Conj]])] -&gt; Map Nonterminal [[Conj]]
forall k a. Ord k =&gt; (a -&gt; a -&gt; a) -&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.fromListWith</span></span><span> </span><span class="annot"><span class="annottext">[[Conj]] -&gt; [[Conj]] -&gt; [[Conj]]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">(++)</span></span><span>
</span><span id="line-28"></span><span>        </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Nonterminal
</span><a href="#local-6989586621679339971"><span class="hs-identifier hs-var">nonterminal</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Conj]
</span><a href="#local-6989586621679339970"><span class="hs-identifier hs-var">conjs</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GrammarType.html#BooleanRelation"><span class="hs-identifier hs-type">BooleanRelation</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679339971"><span class="annot"><span class="annottext">Nonterminal
</span><a href="#local-6989586621679339971"><span class="hs-identifier hs-var">nonterminal</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679339970"><span class="annot"><span class="annottext">[Conj]
</span><a href="#local-6989586621679339970"><span class="hs-identifier hs-var">conjs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Relation]
</span><a href="#local-6989586621679339980"><span class="hs-identifier hs-var">relations'</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-29"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">([[Conj]] -&gt; [[Conj]])
-&gt; Map Nonterminal [[Conj]] -&gt; Map Nonterminal [[Conj]]
forall a b k. (a -&gt; b) -&gt; Map k a -&gt; Map k b
</span><span class="hs-identifier hs-var">Map.map</span></span><span> </span><span class="annot"><span class="annottext">[[Conj]] -&gt; [[Conj]]
forall a. Ord a =&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">sort</span></span><span> </span><span class="annot"><span class="annottext">Map Nonterminal [[Conj]]
</span><a href="#local-6989586621679339973"><span class="hs-identifier hs-var">mapWithReversedRelationsOrder</span></a></span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span class="hs-comment">-- Helpers for working with conjunctions</span><span>
</span><span id="line-32"></span><span>
</span><span id="line-33"></span><span class="annot"><a href="Boolean2TMHelpers.html#calculateNextConjunctionInSameRule"><span class="hs-identifier hs-type">calculateNextConjunctionInSameRule</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GrammarType.html#Grammar"><span class="hs-identifier hs-type">Grammar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="DebuggingTMTypes.html#SymbolsPair"><span class="hs-identifier hs-type">SymbolsPair</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="DebuggingTMTypes.html#SymbolsPair"><span class="hs-identifier hs-type">SymbolsPair</span></a></span><span>
</span><span id="line-34"></span><span id="calculateNextConjunctionInSameRule"><span class="annot"><span class="annottext">calculateNextConjunctionInSameRule :: Grammar -&gt; SymbolsPair -&gt; Maybe SymbolsPair
</span><a href="Boolean2TMHelpers.html#calculateNextConjunctionInSameRule"><span class="hs-identifier hs-var hs-var">calculateNextConjunctionInSameRule</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GrammarType.html#Grammar"><span class="hs-identifier hs-type">Grammar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set Nonterminal
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set Terminal
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679339967"><span class="annot"><span class="annottext">Set Relation
</span><a href="#local-6989586621679339967"><span class="hs-identifier hs-var">relations</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Nonterminal
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="DebuggingTMTypes.html#SymbolsPair"><span class="hs-identifier hs-type">SymbolsPair</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679339965"><span class="annot"><span class="annottext">Nonterminal
</span><a href="#local-6989586621679339965"><span class="hs-identifier hs-var">nonterminal</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679339964"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679339964"><span class="hs-identifier hs-var">relNumber</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679339963"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679339963"><span class="hs-identifier hs-var">hasNeg</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GrammarType.html#N"><span class="hs-identifier hs-type">N</span></a></span><span> </span><span id="local-6989586621679339961"><span class="annot"><span class="annottext">Nonterminal
</span><a href="#local-6989586621679339961"><span class="hs-identifier hs-var">nonterminal1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GrammarType.html#N"><span class="hs-identifier hs-type">N</span></a></span><span> </span><span id="local-6989586621679339960"><span class="annot"><span class="annottext">Nonterminal
</span><a href="#local-6989586621679339960"><span class="hs-identifier hs-var">nonterminal2</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span>
</span><span id="line-36"></span><span>    </span><span id="local-6989586621679339959"><span class="annot"><span class="annottext">groupedRelations :: Map Nonterminal [[Conj]]
</span><a href="#local-6989586621679339959"><span class="hs-identifier hs-var hs-var">groupedRelations</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Relation] -&gt; Map Nonterminal [[Conj]]
</span><a href="Boolean2TMHelpers.html#calculateGroupRelationsByNonterminals"><span class="hs-identifier hs-var">calculateGroupRelationsByNonterminals</span></a></span><span> </span><span class="annot"><span class="annottext">([Relation] -&gt; Map Nonterminal [[Conj]])
-&gt; [Relation] -&gt; Map Nonterminal [[Conj]]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Set Relation -&gt; [Relation]
forall a. Set a -&gt; [a]
</span><span class="hs-identifier hs-var">Set.toList</span></span><span> </span><span class="annot"><span class="annottext">Set Relation
</span><a href="#local-6989586621679339967"><span class="hs-identifier hs-var">relations</span></a></span><span>
</span><span id="line-37"></span><span>    </span><span id="local-6989586621679339958"><span class="annot"><span class="annottext">relationsForNonterminal :: [[Conj]]
</span><a href="#local-6989586621679339958"><span class="hs-identifier hs-var hs-var">relationsForNonterminal</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map Nonterminal [[Conj]]
</span><a href="#local-6989586621679339959"><span class="hs-identifier hs-var">groupedRelations</span></a></span><span> </span><span class="annot"><span class="annottext">Map Nonterminal [[Conj]] -&gt; Nonterminal -&gt; [[Conj]]
forall k a. Ord k =&gt; Map k a -&gt; k -&gt; a
</span><span class="hs-operator hs-var">Map.!</span></span><span> </span><span class="annot"><span class="annottext">Nonterminal
</span><a href="#local-6989586621679339965"><span class="hs-identifier hs-var">nonterminal</span></a></span><span>
</span><span id="line-38"></span><span>    </span><span id="local-6989586621679339956"><span class="annot"><span class="annottext">conjs :: [Conj]
</span><a href="#local-6989586621679339956"><span class="hs-identifier hs-var hs-var">conjs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[Conj]]
</span><a href="#local-6989586621679339958"><span class="hs-identifier hs-var">relationsForNonterminal</span></a></span><span> </span><span class="annot"><span class="annottext">[[Conj]] -&gt; Int -&gt; [Conj]
forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679339964"><span class="hs-identifier hs-var">relNumber</span></a></span><span>
</span><span id="line-39"></span><span>    </span><span id="local-6989586621679339954"><span class="annot"><span class="annottext">list :: Conj
</span><a href="#local-6989586621679339954"><span class="hs-identifier hs-var hs-var">list</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679339963"><span class="hs-identifier hs-var">hasNeg</span></a></span><span>
</span><span id="line-40"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[Symbol] -&gt; Conj
</span><a href="GrammarType.html#NegConj"><span class="hs-identifier hs-var">NegConj</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Nonterminal -&gt; Symbol
</span><a href="GrammarType.html#N"><span class="hs-identifier hs-var">N</span></a></span><span> </span><span class="annot"><span class="annottext">Nonterminal
</span><a href="#local-6989586621679339961"><span class="hs-identifier hs-var">nonterminal1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Nonterminal -&gt; Symbol
</span><a href="GrammarType.html#N"><span class="hs-identifier hs-var">N</span></a></span><span> </span><span class="annot"><span class="annottext">Nonterminal
</span><a href="#local-6989586621679339960"><span class="hs-identifier hs-var">nonterminal2</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-41"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[Symbol] -&gt; Conj
</span><a href="GrammarType.html#PosConj"><span class="hs-identifier hs-var">PosConj</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Nonterminal -&gt; Symbol
</span><a href="GrammarType.html#N"><span class="hs-identifier hs-var">N</span></a></span><span> </span><span class="annot"><span class="annottext">Nonterminal
</span><a href="#local-6989586621679339961"><span class="hs-identifier hs-var">nonterminal1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Nonterminal -&gt; Symbol
</span><a href="GrammarType.html#N"><span class="hs-identifier hs-var">N</span></a></span><span> </span><span class="annot"><span class="annottext">Nonterminal
</span><a href="#local-6989586621679339960"><span class="hs-identifier hs-var">nonterminal2</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-42"></span><span>    </span><span id="local-6989586621679339952"><span class="annot"><span class="annottext">conjPairIndex :: Maybe Int
</span><a href="#local-6989586621679339952"><span class="hs-identifier hs-var hs-var">conjPairIndex</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Conj -&gt; [Conj] -&gt; Maybe Int
forall a. Eq a =&gt; a -&gt; [a] -&gt; Maybe Int
</span><span class="hs-identifier hs-var">elemIndex</span></span><span> </span><span class="annot"><span class="annottext">Conj
</span><a href="#local-6989586621679339954"><span class="hs-identifier hs-var">list</span></a></span><span> </span><span class="annot"><span class="annottext">[Conj]
</span><a href="#local-6989586621679339956"><span class="hs-identifier hs-var">conjs</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-43"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679339952"><span class="hs-identifier hs-var">conjPairIndex</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-44"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679339950"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679339950"><span class="hs-identifier hs-var">index</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679339950"><span class="hs-identifier hs-var">index</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Conj] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Conj]
</span><a href="#local-6989586621679339956"><span class="hs-identifier hs-var">conjs</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe SymbolsPair
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-45"></span><span>                   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679339949"><span class="annot"><span class="annottext">conj :: Conj
</span><a href="#local-6989586621679339949"><span class="hs-identifier hs-var hs-var">conj</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Conj]
</span><a href="#local-6989586621679339956"><span class="hs-identifier hs-var">conjs</span></a></span><span> </span><span class="annot"><span class="annottext">[Conj] -&gt; Int -&gt; Conj
forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679339950"><span class="hs-identifier hs-var">index</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-46"></span><span>                        </span><span class="annot"><span class="annottext">SymbolsPair -&gt; Maybe SymbolsPair
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(SymbolsPair -&gt; Maybe SymbolsPair)
-&gt; SymbolsPair -&gt; Maybe SymbolsPair
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Nonterminal -&gt; Int -&gt; Conj -&gt; SymbolsPair
</span><a href="Boolean2TMHelpers.html#convertListToConjunctionPair"><span class="hs-identifier hs-var">convertListToConjunctionPair</span></a></span><span> </span><span class="annot"><span class="annottext">Nonterminal
</span><a href="#local-6989586621679339965"><span class="hs-identifier hs-var">nonterminal</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679339964"><span class="hs-identifier hs-var">relNumber</span></a></span><span> </span><span class="annot"><span class="annottext">Conj
</span><a href="#local-6989586621679339949"><span class="hs-identifier hs-var">conj</span></a></span><span>
</span><span id="line-47"></span><span>        </span><span class="annot"><span class="annottext">Maybe Int
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Maybe SymbolsPair
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;No such conjunction in given rule. &quot;</span></span><span>
</span><span id="line-48"></span><span class="annot"><a href="Boolean2TMHelpers.html#calculateNextConjunctionInSameRule"><span class="hs-identifier hs-var">calculateNextConjunctionInSameRule</span></a></span><span> </span><span class="annot"><span class="annottext">Grammar
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SymbolsPair
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Maybe SymbolsPair
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Conjunction must be pair of nonterminals. &quot;</span></span><span>
</span><span id="line-49"></span><span>
</span><span id="line-50"></span><span class="annot"><a href="Boolean2TMHelpers.html#calculateFirstConjunctionInNextRule"><span class="hs-identifier hs-type">calculateFirstConjunctionInNextRule</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GrammarType.html#Grammar"><span class="hs-identifier hs-type">Grammar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="DebuggingTMTypes.html#SymbolsPair"><span class="hs-identifier hs-type">SymbolsPair</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="DebuggingTMTypes.html#SymbolsPair"><span class="hs-identifier hs-type">SymbolsPair</span></a></span><span>
</span><span id="line-51"></span><span id="calculateFirstConjunctionInNextRule"><span class="annot"><span class="annottext">calculateFirstConjunctionInNextRule :: Grammar -&gt; SymbolsPair -&gt; Maybe SymbolsPair
</span><a href="Boolean2TMHelpers.html#calculateFirstConjunctionInNextRule"><span class="hs-identifier hs-var hs-var">calculateFirstConjunctionInNextRule</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GrammarType.html#Grammar"><span class="hs-identifier hs-type">Grammar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set Nonterminal
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set Terminal
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679339944"><span class="annot"><span class="annottext">Set Relation
</span><a href="#local-6989586621679339944"><span class="hs-identifier hs-var">relations</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Nonterminal
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="DebuggingTMTypes.html#SymbolsPair"><span class="hs-identifier hs-type">SymbolsPair</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679339943"><span class="annot"><span class="annottext">Nonterminal
</span><a href="#local-6989586621679339943"><span class="hs-identifier hs-var">nonterminal</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679339942"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679339942"><span class="hs-identifier hs-var">relationNumber</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Symbol
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Symbol
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-53"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679339941"><span class="annot"><span class="annottext">groupedRelations :: Map Nonterminal [[Conj]]
</span><a href="#local-6989586621679339941"><span class="hs-identifier hs-var hs-var">groupedRelations</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Relation] -&gt; Map Nonterminal [[Conj]]
</span><a href="Boolean2TMHelpers.html#calculateGroupRelationsByNonterminals"><span class="hs-identifier hs-var">calculateGroupRelationsByNonterminals</span></a></span><span> </span><span class="annot"><span class="annottext">([Relation] -&gt; Map Nonterminal [[Conj]])
-&gt; [Relation] -&gt; Map Nonterminal [[Conj]]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Set Relation -&gt; [Relation]
forall a. Set a -&gt; [a]
</span><span class="hs-identifier hs-var">Set.toList</span></span><span> </span><span class="annot"><span class="annottext">Set Relation
</span><a href="#local-6989586621679339944"><span class="hs-identifier hs-var">relations</span></a></span><span>
</span><span id="line-54"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679339940"><span class="annot"><span class="annottext">relationsForNonterminal :: [[Conj]]
</span><a href="#local-6989586621679339940"><span class="hs-identifier hs-var hs-var">relationsForNonterminal</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map Nonterminal [[Conj]]
</span><a href="#local-6989586621679339941"><span class="hs-identifier hs-var">groupedRelations</span></a></span><span> </span><span class="annot"><span class="annottext">Map Nonterminal [[Conj]] -&gt; Nonterminal -&gt; [[Conj]]
forall k a. Ord k =&gt; Map k a -&gt; k -&gt; a
</span><span class="hs-operator hs-var">Map.!</span></span><span> </span><span class="annot"><span class="annottext">Nonterminal
</span><a href="#local-6989586621679339943"><span class="hs-identifier hs-var">nonterminal</span></a></span><span>
</span><span id="line-55"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679339939"><span class="annot"><span class="annottext">nextRelationNumber :: Int
</span><a href="#local-6989586621679339939"><span class="hs-identifier hs-var hs-var">nextRelationNumber</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679339942"><span class="hs-identifier hs-var">relationNumber</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-56"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679339939"><span class="hs-identifier hs-var">nextRelationNumber</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">[[Conj]] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[[Conj]]
</span><a href="#local-6989586621679339940"><span class="hs-identifier hs-var">relationsForNonterminal</span></a></span><span>
</span><span id="line-57"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Maybe SymbolsPair
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-58"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679339938"><span class="annot"><span class="annottext">conjs :: [Conj]
</span><a href="#local-6989586621679339938"><span class="hs-identifier hs-var hs-var">conjs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[Conj]]
</span><a href="#local-6989586621679339940"><span class="hs-identifier hs-var">relationsForNonterminal</span></a></span><span> </span><span class="annot"><span class="annottext">[[Conj]] -&gt; Int -&gt; [Conj]
forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679339939"><span class="hs-identifier hs-var">nextRelationNumber</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-59"></span><span>        </span><span class="annot"><span class="annottext">SymbolsPair -&gt; Maybe SymbolsPair
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(SymbolsPair -&gt; Maybe SymbolsPair)
-&gt; SymbolsPair -&gt; Maybe SymbolsPair
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Nonterminal -&gt; Int -&gt; Conj -&gt; SymbolsPair
</span><a href="Boolean2TMHelpers.html#convertListToConjunctionPair"><span class="hs-identifier hs-var">convertListToConjunctionPair</span></a></span><span> </span><span class="annot"><span class="annottext">Nonterminal
</span><a href="#local-6989586621679339943"><span class="hs-identifier hs-var">nonterminal</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679339939"><span class="hs-identifier hs-var">nextRelationNumber</span></a></span><span> </span><span class="annot"><span class="annottext">(Conj -&gt; SymbolsPair) -&gt; Conj -&gt; SymbolsPair
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Conj] -&gt; Conj
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">[Conj]
</span><a href="#local-6989586621679339938"><span class="hs-identifier hs-var">conjs</span></a></span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span class="annot"><a href="Boolean2TMHelpers.html#getFstConjInKthRel"><span class="hs-identifier hs-type">getFstConjInKthRel</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GrammarType.html#Grammar"><span class="hs-identifier hs-type">Grammar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="DebuggingTMTypes.html#SymbolsPair"><span class="hs-identifier hs-type">SymbolsPair</span></a></span><span>
</span><span id="line-62"></span><span id="getFstConjInKthRel"><span class="annot"><span class="annottext">getFstConjInKthRel :: Grammar -&gt; [Char] -&gt; [Char] -&gt; SymbolsPair
</span><a href="Boolean2TMHelpers.html#getFstConjInKthRel"><span class="hs-identifier hs-var hs-var">getFstConjInKthRel</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GrammarType.html#Grammar"><span class="hs-identifier hs-type">Grammar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set Nonterminal
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set Terminal
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679339934"><span class="annot"><span class="annottext">Set Relation
</span><a href="#local-6989586621679339934"><span class="hs-identifier hs-var">relations</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Nonterminal
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679339933"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679339933"><span class="hs-identifier hs-var">nontermVal</span></a></span></span><span> </span><span id="local-6989586621679339932"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679339932"><span class="hs-identifier hs-var">number</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span>
</span><span id="line-63"></span><span>    </span><span id="local-6989586621679339931"><span class="annot"><span class="annottext">number' :: Int
</span><a href="#local-6989586621679339931"><span class="hs-identifier hs-var hs-var">number'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Int
forall a. Read a =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">read</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679339932"><span class="hs-identifier hs-var">number</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-64"></span><span>    </span><span id="local-6989586621679339929"><span class="annot"><span class="annottext">nonterminal :: Nonterminal
</span><a href="#local-6989586621679339929"><span class="hs-identifier hs-var hs-var">nonterminal</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Nonterminal
</span><a href="GrammarType.html#Nonterminal"><span class="hs-identifier hs-var">Nonterminal</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679339933"><span class="hs-identifier hs-var">nontermVal</span></a></span><span>
</span><span id="line-65"></span><span>    </span><span id="local-6989586621679339927"><span class="annot"><span class="annottext">groupedRelations :: Map Nonterminal [[Conj]]
</span><a href="#local-6989586621679339927"><span class="hs-identifier hs-var hs-var">groupedRelations</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Relation] -&gt; Map Nonterminal [[Conj]]
</span><a href="Boolean2TMHelpers.html#calculateGroupRelationsByNonterminals"><span class="hs-identifier hs-var">calculateGroupRelationsByNonterminals</span></a></span><span> </span><span class="annot"><span class="annottext">([Relation] -&gt; Map Nonterminal [[Conj]])
-&gt; [Relation] -&gt; Map Nonterminal [[Conj]]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Set Relation -&gt; [Relation]
forall a. Set a -&gt; [a]
</span><span class="hs-identifier hs-var">Set.toList</span></span><span> </span><span class="annot"><span class="annottext">Set Relation
</span><a href="#local-6989586621679339934"><span class="hs-identifier hs-var">relations</span></a></span><span>
</span><span id="line-66"></span><span>    </span><span id="local-6989586621679339926"><span class="annot"><span class="annottext">relationsForNonterminal :: [[Conj]]
</span><a href="#local-6989586621679339926"><span class="hs-identifier hs-var hs-var">relationsForNonterminal</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map Nonterminal [[Conj]]
</span><a href="#local-6989586621679339927"><span class="hs-identifier hs-var">groupedRelations</span></a></span><span> </span><span class="annot"><span class="annottext">Map Nonterminal [[Conj]] -&gt; Nonterminal -&gt; [[Conj]]
forall k a. Ord k =&gt; Map k a -&gt; k -&gt; a
</span><span class="hs-operator hs-var">Map.!</span></span><span> </span><span class="annot"><span class="annottext">Nonterminal
</span><a href="#local-6989586621679339929"><span class="hs-identifier hs-var">nonterminal</span></a></span><span>
</span><span id="line-67"></span><span>    </span><span id="local-6989586621679339925"><span class="annot"><span class="annottext">conjs :: [Conj]
</span><a href="#local-6989586621679339925"><span class="hs-identifier hs-var hs-var">conjs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[Conj]]
</span><a href="#local-6989586621679339926"><span class="hs-identifier hs-var">relationsForNonterminal</span></a></span><span> </span><span class="annot"><span class="annottext">[[Conj]] -&gt; Int -&gt; [Conj]
forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679339931"><span class="hs-identifier hs-var">number'</span></a></span><span>
</span><span id="line-68"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Nonterminal -&gt; Int -&gt; Conj -&gt; SymbolsPair
</span><a href="Boolean2TMHelpers.html#convertListToConjunctionPair"><span class="hs-identifier hs-var">convertListToConjunctionPair</span></a></span><span> </span><span class="annot"><span class="annottext">Nonterminal
</span><a href="#local-6989586621679339929"><span class="hs-identifier hs-var">nonterminal</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679339931"><span class="hs-identifier hs-var">number'</span></a></span><span> </span><span class="annot"><span class="annottext">(Conj -&gt; SymbolsPair) -&gt; Conj -&gt; SymbolsPair
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Conj] -&gt; Conj
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">[Conj]
</span><a href="#local-6989586621679339925"><span class="hs-identifier hs-var">conjs</span></a></span><span>
</span><span id="line-69"></span><span>
</span><span id="line-70"></span><span class="hs-comment">-- Helpers for working with long/short relations</span><span>
</span><span id="line-71"></span><span>
</span><span id="line-72"></span><span class="annot"><a href="Boolean2TMHelpers.html#getLongRels"><span class="hs-identifier hs-type">getLongRels</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GrammarType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GrammarType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-73"></span><span id="getLongRels"><span class="annot"><span class="annottext">getLongRels :: [Relation] -&gt; [Relation]
</span><a href="Boolean2TMHelpers.html#getLongRels"><span class="hs-identifier hs-var hs-var">getLongRels</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Relation -&gt; Bool) -&gt; [Relation] -&gt; [Relation]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; (Relation -&gt; Bool) -&gt; Relation -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Relation -&gt; Bool
</span><a href="Boolean2TMHelpers.html#relationHasOneTerminalInRightPart"><span class="hs-identifier hs-var">relationHasOneTerminalInRightPart</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-74"></span><span>                    </span><span>
</span><span id="line-75"></span><span class="annot"><a href="Boolean2TMHelpers.html#getShortRightParts"><span class="hs-identifier hs-type">getShortRightParts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GrammarType.html#Nonterminal"><span class="hs-identifier hs-type">Nonterminal</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="GrammarType.html#Conj"><span class="hs-identifier hs-type">Conj</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span>
</span><span id="line-76"></span><span id="getShortRightParts"><span class="annot"><span class="annottext">getShortRightParts :: Nonterminal -&gt; [[Conj]] -&gt; [[Char]]
</span><a href="Boolean2TMHelpers.html#getShortRightParts"><span class="hs-identifier hs-var hs-var">getShortRightParts</span></a></span></span><span> </span><span id="local-6989586621679339919"><span class="annot"><span class="annottext">Nonterminal
</span><a href="#local-6989586621679339919"><span class="hs-identifier hs-var">nonterminal</span></a></span></span><span> </span><span id="local-6989586621679339918"><span class="annot"><span class="annottext">[[Conj]]
</span><a href="#local-6989586621679339918"><span class="hs-identifier hs-var">rightParts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span>
</span><span id="line-77"></span><span>    </span><span id="local-6989586621679339917"><span class="annot"><span class="annottext">shortOrNotRels :: [(Maybe Int, Bool)]
</span><a href="#local-6989586621679339917"><span class="hs-identifier hs-var hs-var">shortOrNotRels</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Conj] -&gt; (Maybe Int, Bool)) -&gt; [[Conj]] -&gt; [(Maybe Int, Bool)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679339916"><span class="annot"><span class="annottext">[Conj]
</span><a href="#local-6989586621679339916"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-78"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Conj] -&gt; [[Conj]] -&gt; Maybe Int
forall a. Eq a =&gt; a -&gt; [a] -&gt; Maybe Int
</span><span class="hs-identifier hs-var">elemIndex</span></span><span> </span><span class="annot"><span class="annottext">[Conj]
</span><a href="#local-6989586621679339916"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">[[Conj]]
</span><a href="#local-6989586621679339918"><span class="hs-identifier hs-var">rightParts</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-79"></span><span>        </span><span class="annot"><span class="annottext">Relation -&gt; Bool
</span><a href="Boolean2TMHelpers.html#relationHasOneTerminalInRightPart"><span class="hs-identifier hs-var">relationHasOneTerminalInRightPart</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Nonterminal, [Conj]) -&gt; Relation
</span><a href="GrammarType.html#BooleanRelation"><span class="hs-identifier hs-var">BooleanRelation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Nonterminal
</span><a href="#local-6989586621679339919"><span class="hs-identifier hs-var">nonterminal</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Conj]
</span><a href="#local-6989586621679339916"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[[Conj]]
</span><a href="#local-6989586621679339918"><span class="hs-identifier hs-var">rightParts</span></a></span><span>
</span><span id="line-80"></span><span>    </span><span id="local-6989586621679339915"><span class="annot"><span class="annottext">indices' :: [Maybe Int]
</span><a href="#local-6989586621679339915"><span class="hs-identifier hs-var hs-var">indices'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Maybe Int, Bool) -&gt; Maybe Int)
-&gt; [(Maybe Int, Bool)] -&gt; [Maybe Int]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679339914"><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679339914"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679339913"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679339913"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679339913"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679339914"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Maybe Int
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Maybe Int, Bool)]
</span><a href="#local-6989586621679339917"><span class="hs-identifier hs-var">shortOrNotRels</span></a></span><span>
</span><span id="line-81"></span><span>    </span><span id="local-6989586621679339912"><span class="annot"><span class="annottext">indices :: [[Char]]
</span><a href="#local-6989586621679339912"><span class="hs-identifier hs-var hs-var">indices</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; [Char]) -&gt; [Int] -&gt; [[Char]]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">([Int] -&gt; [[Char]]) -&gt; [Int] -&gt; [[Char]]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Maybe Int] -&gt; [Int]
forall a. [Maybe a] -&gt; [a]
</span><span class="hs-identifier hs-var">catMaybes</span></span><span> </span><span class="annot"><span class="annottext">[Maybe Int]
</span><a href="#local-6989586621679339915"><span class="hs-identifier hs-var">indices'</span></a></span><span>
</span><span id="line-82"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[[Char]]
</span><a href="#local-6989586621679339912"><span class="hs-identifier hs-var">indices</span></a></span><span>
</span><span id="line-83"></span><span>    </span><span>
</span><span id="line-84"></span><span class="hs-comment">-- short relation is relation with one terminal in right part</span><span>
</span><span id="line-85"></span><span class="annot"><a href="Boolean2TMHelpers.html#getNumbersOfShortRelations"><span class="hs-identifier hs-type">getNumbersOfShortRelations</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GrammarType.html#Grammar"><span class="hs-identifier hs-type">Grammar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span><span> </span><span class="annot"><a href="GrammarType.html#Nonterminal"><span class="hs-identifier hs-type">Nonterminal</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span>
</span><span id="line-86"></span><span id="getNumbersOfShortRelations"><span class="annot"><span class="annottext">getNumbersOfShortRelations :: Grammar -&gt; Map Nonterminal [[Char]]
</span><a href="Boolean2TMHelpers.html#getNumbersOfShortRelations"><span class="hs-identifier hs-var hs-var">getNumbersOfShortRelations</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GrammarType.html#Grammar"><span class="hs-identifier hs-type">Grammar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set Nonterminal
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set Terminal
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679339908"><span class="annot"><span class="annottext">Set Relation
</span><a href="#local-6989586621679339908"><span class="hs-identifier hs-var">relations</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Nonterminal
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-87"></span><span>    </span><span class="annot"><span class="annottext">(Nonterminal -&gt; [[Conj]] -&gt; [[Char]])
-&gt; Map Nonterminal [[Conj]] -&gt; Map Nonterminal [[Char]]
forall k a b. (k -&gt; a -&gt; b) -&gt; Map k a -&gt; Map k b
</span><span class="hs-identifier hs-var">Map.mapWithKey</span></span><span> </span><span class="annot"><span class="annottext">Nonterminal -&gt; [[Conj]] -&gt; [[Char]]
</span><a href="Boolean2TMHelpers.html#getShortRightParts"><span class="hs-identifier hs-var">getShortRightParts</span></a></span><span> </span><span class="annot"><span class="annottext">(Map Nonterminal [[Conj]] -&gt; Map Nonterminal [[Char]])
-&gt; Map Nonterminal [[Conj]] -&gt; Map Nonterminal [[Char]]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Relation] -&gt; Map Nonterminal [[Conj]]
</span><a href="Boolean2TMHelpers.html#calculateGroupRelationsByNonterminals"><span class="hs-identifier hs-var">calculateGroupRelationsByNonterminals</span></a></span><span> </span><span class="annot"><span class="annottext">([Relation] -&gt; Map Nonterminal [[Conj]])
-&gt; [Relation] -&gt; Map Nonterminal [[Conj]]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Set Relation -&gt; [Relation]
forall a. Set a -&gt; [a]
</span><span class="hs-identifier hs-var">Set.toList</span></span><span> </span><span class="annot"><span class="annottext">Set Relation
</span><a href="#local-6989586621679339908"><span class="hs-identifier hs-var">relations</span></a></span><span>
</span><span id="line-88"></span><span>
</span><span id="line-89"></span><span class="hs-comment">-- Helpers for building conjunctions</span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span class="hs-comment">-- grammar -&gt; string (nonterminal in left part)</span><span>
</span><span id="line-92"></span><span class="hs-comment">--         -&gt; string (number of relation) -&gt; list of first nonterminals</span><span>
</span><span id="line-93"></span><span class="annot"><a href="Boolean2TMHelpers.html#getFstNonterminalsInConjsOfGivenRel"><span class="hs-identifier hs-type">getFstNonterminalsInConjsOfGivenRel</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GrammarType.html#Grammar"><span class="hs-identifier hs-type">Grammar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span>
</span><span id="line-94"></span><span id="getFstNonterminalsInConjsOfGivenRel"><span class="annot"><span class="annottext">getFstNonterminalsInConjsOfGivenRel :: Grammar -&gt; [Char] -&gt; [Char] -&gt; [[Char]]
</span><a href="Boolean2TMHelpers.html#getFstNonterminalsInConjsOfGivenRel"><span class="hs-identifier hs-var hs-var">getFstNonterminalsInConjsOfGivenRel</span></a></span></span><span>
</span><span id="line-95"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="GrammarType.html#Grammar"><span class="hs-identifier hs-type">Grammar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set Nonterminal
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set Terminal
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679339905"><span class="annot"><span class="annottext">Set Relation
</span><a href="#local-6989586621679339905"><span class="hs-identifier hs-var">rels</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Nonterminal
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679339904"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679339904"><span class="hs-identifier hs-var">nonterminal</span></a></span></span><span> </span><span id="local-6989586621679339903"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679339903"><span class="hs-identifier hs-var">number</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-96"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679339902"><span class="annot"><span class="annottext">groupedRelations :: Map Nonterminal [[Conj]]
</span><a href="#local-6989586621679339902"><span class="hs-identifier hs-var hs-var">groupedRelations</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Relation] -&gt; Map Nonterminal [[Conj]]
</span><a href="Boolean2TMHelpers.html#calculateGroupRelationsByNonterminals"><span class="hs-identifier hs-var">calculateGroupRelationsByNonterminals</span></a></span><span> </span><span class="annot"><span class="annottext">([Relation] -&gt; Map Nonterminal [[Conj]])
-&gt; [Relation] -&gt; Map Nonterminal [[Conj]]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Set Relation -&gt; [Relation]
forall a. Set a -&gt; [a]
</span><span class="hs-identifier hs-var">Set.toList</span></span><span> </span><span class="annot"><span class="annottext">Set Relation
</span><a href="#local-6989586621679339905"><span class="hs-identifier hs-var">rels</span></a></span><span>
</span><span id="line-97"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679339901"><span class="annot"><span class="annottext">conjs :: [Conj]
</span><a href="#local-6989586621679339901"><span class="hs-identifier hs-var hs-var">conjs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Nonterminal [[Conj]]
</span><a href="#local-6989586621679339902"><span class="hs-identifier hs-var">groupedRelations</span></a></span><span> </span><span class="annot"><span class="annottext">Map Nonterminal [[Conj]] -&gt; Nonterminal -&gt; [[Conj]]
forall k a. Ord k =&gt; Map k a -&gt; k -&gt; a
</span><span class="hs-operator hs-var">Map.!</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Nonterminal
</span><a href="GrammarType.html#Nonterminal"><span class="hs-identifier hs-var">Nonterminal</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679339904"><span class="hs-identifier hs-var">nonterminal</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[[Conj]] -&gt; Int -&gt; [Conj]
forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; Int
forall a. Read a =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">read</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679339903"><span class="hs-identifier hs-var">number</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-98"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Relation -&gt; Bool
</span><a href="Boolean2TMHelpers.html#relationHasOneTerminalInRightPart"><span class="hs-identifier hs-var">relationHasOneTerminalInRightPart</span></a></span><span> </span><span class="annot"><span class="annottext">(Relation -&gt; Bool) -&gt; Relation -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Nonterminal, [Conj]) -&gt; Relation
</span><a href="GrammarType.html#BooleanRelation"><span class="hs-identifier hs-var">BooleanRelation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; Nonterminal
</span><a href="GrammarType.html#Nonterminal"><span class="hs-identifier hs-var">Nonterminal</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679339904"><span class="hs-identifier hs-var">nonterminal</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Conj]
</span><a href="#local-6989586621679339901"><span class="hs-identifier hs-var">conjs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-100"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">let</span><span>
</span><span id="line-101"></span><span>        </span><span id="local-6989586621679339900"><span class="annot"><span class="annottext">firstSymbolsInConjunctions :: [Symbol]
</span><a href="#local-6989586621679339900"><span class="hs-identifier hs-var hs-var">firstSymbolsInConjunctions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Symbol] -&gt; Symbol) -&gt; [[Symbol]] -&gt; [Symbol]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">[Symbol] -&gt; Symbol
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">([[Symbol]] -&gt; [Symbol]) -&gt; [[Symbol]] -&gt; [Symbol]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Conj -&gt; [Symbol]) -&gt; [Conj] -&gt; [[Symbol]]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Conj -&gt; [Symbol]
</span><a href="GrammarType.html#symbols"><span class="hs-identifier hs-var hs-var">symbols</span></a></span><span> </span><span class="annot"><span class="annottext">[Conj]
</span><a href="#local-6989586621679339901"><span class="hs-identifier hs-var">conjs</span></a></span><span>
</span><span id="line-102"></span><span>        </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(Symbol -&gt; [Char]) -&gt; [Symbol] -&gt; [[Char]]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Symbol -&gt; [Char]
</span><a href="Boolean2TMHelpers.html#refineSymbolInConjunctionToNonterminal"><span class="hs-identifier hs-var">refineSymbolInConjunctionToNonterminal</span></a></span><span> </span><span class="annot"><span class="annottext">[Symbol]
</span><a href="#local-6989586621679339900"><span class="hs-identifier hs-var">firstSymbolsInConjunctions</span></a></span><span>
</span><span id="line-103"></span><span>
</span><span id="line-104"></span><span class="hs-comment">-- grammar -&gt; string (nonterminal in left part) -&gt; string (number of relation)</span><span>
</span><span id="line-105"></span><span class="hs-comment">--         -&gt; string (first nonterminal in conjunction) -&gt; list of first nonterminals</span><span>
</span><span id="line-106"></span><span class="annot"><a href="Boolean2TMHelpers.html#getSndNonterminalsInConjsOfGivenRel"><span class="hs-identifier hs-type">getSndNonterminalsInConjsOfGivenRel</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GrammarType.html#Grammar"><span class="hs-identifier hs-type">Grammar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span>
</span><span id="line-107"></span><span id="getSndNonterminalsInConjsOfGivenRel"><span class="annot"><span class="annottext">getSndNonterminalsInConjsOfGivenRel :: Grammar -&gt; [Char] -&gt; [Char] -&gt; [Char] -&gt; [[Char]]
</span><a href="Boolean2TMHelpers.html#getSndNonterminalsInConjsOfGivenRel"><span class="hs-identifier hs-var hs-var">getSndNonterminalsInConjsOfGivenRel</span></a></span></span><span>
</span><span id="line-108"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="GrammarType.html#Grammar"><span class="hs-identifier hs-type">Grammar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set Nonterminal
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set Terminal
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679339896"><span class="annot"><span class="annottext">Set Relation
</span><a href="#local-6989586621679339896"><span class="hs-identifier hs-var">rels</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Nonterminal
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679339895"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679339895"><span class="hs-identifier hs-var">leftNonterminal</span></a></span></span><span> </span><span id="local-6989586621679339894"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679339894"><span class="hs-identifier hs-var">number</span></a></span></span><span> </span><span id="local-6989586621679339893"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679339893"><span class="hs-identifier hs-var">fstNontermInConj</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span>
</span><span id="line-109"></span><span>    </span><span id="local-6989586621679339892"><span class="annot"><span class="annottext">groupedRelations :: Map Nonterminal [[Conj]]
</span><a href="#local-6989586621679339892"><span class="hs-identifier hs-var hs-var">groupedRelations</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Relation] -&gt; Map Nonterminal [[Conj]]
</span><a href="Boolean2TMHelpers.html#calculateGroupRelationsByNonterminals"><span class="hs-identifier hs-var">calculateGroupRelationsByNonterminals</span></a></span><span> </span><span class="annot"><span class="annottext">([Relation] -&gt; Map Nonterminal [[Conj]])
-&gt; [Relation] -&gt; Map Nonterminal [[Conj]]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Set Relation -&gt; [Relation]
forall a. Set a -&gt; [a]
</span><span class="hs-identifier hs-var">Set.toList</span></span><span> </span><span class="annot"><span class="annottext">Set Relation
</span><a href="#local-6989586621679339896"><span class="hs-identifier hs-var">rels</span></a></span><span>
</span><span id="line-110"></span><span>    </span><span id="local-6989586621679339891"><span class="annot"><span class="annottext">conjs :: [Conj]
</span><a href="#local-6989586621679339891"><span class="hs-identifier hs-var hs-var">conjs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Nonterminal [[Conj]]
</span><a href="#local-6989586621679339892"><span class="hs-identifier hs-var">groupedRelations</span></a></span><span> </span><span class="annot"><span class="annottext">Map Nonterminal [[Conj]] -&gt; Nonterminal -&gt; [[Conj]]
forall k a. Ord k =&gt; Map k a -&gt; k -&gt; a
</span><span class="hs-operator hs-var">Map.!</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Nonterminal
</span><a href="GrammarType.html#Nonterminal"><span class="hs-identifier hs-var">Nonterminal</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679339895"><span class="hs-identifier hs-var">leftNonterminal</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[[Conj]] -&gt; Int -&gt; [Conj]
forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; Int
forall a. Read a =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">read</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679339894"><span class="hs-identifier hs-var">number</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-111"></span><span>    </span><span id="local-6989586621679339890"><span class="annot"><span class="annottext">symbol :: Symbol
</span><a href="#local-6989586621679339890"><span class="hs-identifier hs-var hs-var">symbol</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Nonterminal -&gt; Symbol
</span><a href="GrammarType.html#N"><span class="hs-identifier hs-var">N</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; Nonterminal
</span><a href="GrammarType.html#Nonterminal"><span class="hs-identifier hs-var">Nonterminal</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679339893"><span class="hs-identifier hs-var">fstNontermInConj</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-112"></span><span>    </span><span id="local-6989586621679339889"><span class="annot"><span class="annottext">possibleConjs :: [Conj]
</span><a href="#local-6989586621679339889"><span class="hs-identifier hs-var hs-var">possibleConjs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Conj -&gt; Bool) -&gt; [Conj] -&gt; [Conj]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679339888"><span class="annot"><span class="annottext">Conj
</span><a href="#local-6989586621679339888"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Symbol
</span><a href="#local-6989586621679339890"><span class="hs-identifier hs-var">symbol</span></a></span><span> </span><span class="annot"><span class="annottext">Symbol -&gt; Symbol -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">[Symbol] -&gt; Symbol
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Conj -&gt; [Symbol]
</span><a href="GrammarType.html#symbols"><span class="hs-identifier hs-var hs-var">symbols</span></a></span><span> </span><span class="annot"><span class="annottext">Conj
</span><a href="#local-6989586621679339888"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Conj]
</span><a href="#local-6989586621679339891"><span class="hs-identifier hs-var">conjs</span></a></span><span>
</span><span id="line-113"></span><span>    </span><span id="local-6989586621679339887"><span class="annot"><span class="annottext">possibleSndNonterminals :: [Symbol]
</span><a href="#local-6989586621679339887"><span class="hs-identifier hs-var hs-var">possibleSndNonterminals</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Conj -&gt; Symbol) -&gt; [Conj] -&gt; [Symbol]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679339886"><span class="annot"><span class="annottext">Conj
</span><a href="#local-6989586621679339886"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Conj -&gt; [Symbol]
</span><a href="GrammarType.html#symbols"><span class="hs-identifier hs-var hs-var">symbols</span></a></span><span> </span><span class="annot"><span class="annottext">Conj
</span><a href="#local-6989586621679339886"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">[Symbol] -&gt; Int -&gt; Symbol
forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Conj]
</span><a href="#local-6989586621679339889"><span class="hs-identifier hs-var">possibleConjs</span></a></span><span>
</span><span id="line-114"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(Symbol -&gt; [Char]) -&gt; [Symbol] -&gt; [[Char]]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Symbol -&gt; [Char]
</span><a href="Boolean2TMHelpers.html#refineSymbolInConjunctionToNonterminal"><span class="hs-identifier hs-var">refineSymbolInConjunctionToNonterminal</span></a></span><span> </span><span class="annot"><span class="annottext">[Symbol]
</span><a href="#local-6989586621679339887"><span class="hs-identifier hs-var">possibleSndNonterminals</span></a></span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span class="hs-comment">-- Helpers for generating quads and triplets</span><span>
</span><span id="line-117"></span><span>
</span><span id="line-118"></span><span class="annot"><a href="Boolean2TMHelpers.html#calculateTriplets"><span class="hs-identifier hs-type">calculateTriplets</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GrammarType.html#Grammar"><span class="hs-identifier hs-type">Grammar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-119"></span><span id="calculateTriplets"><span class="annot"><span class="annottext">calculateTriplets :: Grammar -&gt; [Char] -&gt; [[Char]] -&gt; [([Char], [Char], [Char])]
</span><a href="Boolean2TMHelpers.html#calculateTriplets"><span class="hs-identifier hs-var hs-var">calculateTriplets</span></a></span></span><span> </span><span id="local-6989586621679339884"><span class="annot"><span class="annottext">Grammar
</span><a href="#local-6989586621679339884"><span class="hs-identifier hs-var">grammar</span></a></span></span><span> </span><span id="local-6989586621679339883"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679339883"><span class="hs-identifier hs-var">number</span></a></span></span><span>
</span><span id="line-120"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; [([Char], [Char], [Char])])
-&gt; [[Char]] -&gt; [([Char], [Char], [Char])]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679339881"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679339881"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span>
</span><span id="line-121"></span><span>        </span><span id="local-6989586621679339880"><span class="annot"><span class="annottext">firstNonterminals :: [[Char]]
</span><a href="#local-6989586621679339880"><span class="hs-identifier hs-var hs-var">firstNonterminals</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Grammar -&gt; [Char] -&gt; [Char] -&gt; [[Char]]
</span><a href="Boolean2TMHelpers.html#getFstNonterminalsInConjsOfGivenRel"><span class="hs-identifier hs-var">getFstNonterminalsInConjsOfGivenRel</span></a></span><span> </span><span class="annot"><span class="annottext">Grammar
</span><a href="#local-6989586621679339884"><span class="hs-identifier hs-var">grammar</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679339881"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679339883"><span class="hs-identifier hs-var">number</span></a></span><span>
</span><span id="line-122"></span><span>        </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; ([Char], [Char], [Char]))
-&gt; [[Char]] -&gt; [([Char], [Char], [Char])]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679339883"><span class="hs-identifier hs-var">number</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679339881"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[[Char]]
</span><a href="#local-6989586621679339880"><span class="hs-identifier hs-var">firstNonterminals</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-123"></span><span>
</span><span id="line-124"></span><span class="annot"><a href="Boolean2TMHelpers.html#calculateQuads%27"><span class="hs-identifier hs-type">calculateQuads'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GrammarType.html#Grammar"><span class="hs-identifier hs-type">Grammar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-125"></span><span id="calculateQuads%27"><span class="annot"><span class="annottext">calculateQuads' :: Grammar
-&gt; [([Char], [Char], [Char])]
-&gt; [([Char], [Char], [Char], [[Char]])]
</span><a href="Boolean2TMHelpers.html#calculateQuads%27"><span class="hs-identifier hs-var hs-var">calculateQuads'</span></a></span></span><span> </span><span id="local-6989586621679339878"><span class="annot"><span class="annottext">Grammar
</span><a href="#local-6989586621679339878"><span class="hs-identifier hs-var">grammar</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(([Char], [Char], [Char]) -&gt; ([Char], [Char], [Char], [[Char]]))
-&gt; [([Char], [Char], [Char])]
-&gt; [([Char], [Char], [Char], [[Char]])]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679339877"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679339877"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679339876"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679339876"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679339875"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679339875"><span class="hs-identifier hs-var">j</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-126"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679339877"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679339876"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679339875"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Grammar -&gt; [Char] -&gt; [Char] -&gt; [Char] -&gt; [[Char]]
</span><a href="Boolean2TMHelpers.html#getSndNonterminalsInConjsOfGivenRel"><span class="hs-identifier hs-var">getSndNonterminalsInConjsOfGivenRel</span></a></span><span> </span><span class="annot"><span class="annottext">Grammar
</span><a href="#local-6989586621679339878"><span class="hs-identifier hs-var">grammar</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679339876"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679339877"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679339875"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-127"></span><span>
</span><span id="line-128"></span><span class="annot"><a href="Boolean2TMHelpers.html#calculateQuads"><span class="hs-identifier hs-type">calculateQuads</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GrammarType.html#Grammar"><span class="hs-identifier hs-type">Grammar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-129"></span><span id="calculateQuads"><span class="annot"><span class="annottext">calculateQuads :: Grammar -&gt; [Char] -&gt; [[Char]] -&gt; [([Char], [Char], [Char], [Char])]
</span><a href="Boolean2TMHelpers.html#calculateQuads"><span class="hs-identifier hs-var hs-var">calculateQuads</span></a></span></span><span> </span><span id="local-6989586621679339873"><span class="annot"><span class="annottext">Grammar
</span><a href="#local-6989586621679339873"><span class="hs-identifier hs-var">grammar</span></a></span></span><span> </span><span id="local-6989586621679339872"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679339872"><span class="hs-identifier hs-var">k'</span></a></span></span><span> </span><span id="local-6989586621679339871"><span class="annot"><span class="annottext">[[Char]]
</span><a href="#local-6989586621679339871"><span class="hs-identifier hs-var">nonterminalsWithKthRel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span>
</span><span id="line-130"></span><span>    </span><span id="local-6989586621679339870"><span class="annot"><span class="annottext">triplets :: [([Char], [Char], [Char])]
</span><a href="#local-6989586621679339870"><span class="hs-identifier hs-var hs-var">triplets</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Grammar -&gt; [Char] -&gt; [[Char]] -&gt; [([Char], [Char], [Char])]
</span><a href="Boolean2TMHelpers.html#calculateTriplets"><span class="hs-identifier hs-var">calculateTriplets</span></a></span><span> </span><span class="annot"><span class="annottext">Grammar
</span><a href="#local-6989586621679339873"><span class="hs-identifier hs-var">grammar</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679339872"><span class="hs-identifier hs-var">k'</span></a></span><span> </span><span class="annot"><span class="annottext">[[Char]]
</span><a href="#local-6989586621679339871"><span class="hs-identifier hs-var">nonterminalsWithKthRel</span></a></span><span>
</span><span id="line-131"></span><span>    </span><span id="local-6989586621679339869"><span class="annot"><span class="annottext">quads' :: [([Char], [Char], [Char], [[Char]])]
</span><a href="#local-6989586621679339869"><span class="hs-identifier hs-var hs-var">quads'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Grammar
-&gt; [([Char], [Char], [Char])]
-&gt; [([Char], [Char], [Char], [[Char]])]
</span><a href="Boolean2TMHelpers.html#calculateQuads%27"><span class="hs-identifier hs-var">calculateQuads'</span></a></span><span> </span><span class="annot"><span class="annottext">Grammar
</span><a href="#local-6989586621679339873"><span class="hs-identifier hs-var">grammar</span></a></span><span> </span><span class="annot"><span class="annottext">[([Char], [Char], [Char])]
</span><a href="#local-6989586621679339870"><span class="hs-identifier hs-var">triplets</span></a></span><span>
</span><span id="line-132"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(([Char], [Char], [Char], [[Char]])
 -&gt; [([Char], [Char], [Char], [Char])])
-&gt; [([Char], [Char], [Char], [[Char]])]
-&gt; [([Char], [Char], [Char], [Char])]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679339868"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679339868"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679339867"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679339867"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679339866"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679339866"><span class="hs-identifier hs-var">j</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679339865"><span class="annot"><span class="annottext">[[Char]]
</span><a href="#local-6989586621679339865"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; ([Char], [Char], [Char], [Char]))
-&gt; [[Char]] -&gt; [([Char], [Char], [Char], [Char])]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679339868"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679339867"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679339866"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[[Char]]
</span><a href="#local-6989586621679339865"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[([Char], [Char], [Char], [[Char]])]
</span><a href="#local-6989586621679339869"><span class="hs-identifier hs-var">quads'</span></a></span><span>
</span><span id="line-133"></span><span>
</span><span id="line-134"></span><span class="annot"><a href="Boolean2TMHelpers.html#calculateAllQuads"><span class="hs-identifier hs-type">calculateAllQuads</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GrammarType.html#Grammar"><span class="hs-identifier hs-type">Grammar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-135"></span><span id="calculateAllQuads"><span class="annot"><span class="annottext">calculateAllQuads :: Grammar -&gt; [([Char], [Char], [Char], [Char])]
</span><a href="Boolean2TMHelpers.html#calculateAllQuads"><span class="hs-identifier hs-var hs-var">calculateAllQuads</span></a></span></span><span> </span><span id="local-6989586621679339863"><span class="annot"><span class="annottext">gr :: Grammar
</span><a href="#local-6989586621679339863"><span class="hs-identifier hs-var">gr</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GrammarType.html#Grammar"><span class="hs-identifier hs-type">Grammar</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679339862"><span class="annot"><span class="annottext">Set Nonterminal
</span><a href="#local-6989586621679339862"><span class="hs-identifier hs-var">nonterminals</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set Terminal
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679339861"><span class="annot"><span class="annottext">Set Relation
</span><a href="#local-6989586621679339861"><span class="hs-identifier hs-var">rels</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Nonterminal
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span>
</span><span id="line-136"></span><span>    </span><span id="local-6989586621679339860"><span class="annot"><span class="annottext">maxNumber :: Int
</span><a href="#local-6989586621679339860"><span class="hs-identifier hs-var hs-var">maxNumber</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Grammar -&gt; Int
</span><a href="Boolean2TMHelpers.html#calculateMaxNumberOfRulesForNonterminal"><span class="hs-identifier hs-var">calculateMaxNumberOfRulesForNonterminal</span></a></span><span> </span><span class="annot"><span class="annottext">Grammar
</span><a href="#local-6989586621679339863"><span class="hs-identifier hs-var">gr</span></a></span><span>
</span><span id="line-137"></span><span>    </span><span id="local-6989586621679339859"><span class="annot"><span class="annottext">indices :: [[Char]]
</span><a href="#local-6989586621679339859"><span class="hs-identifier hs-var hs-var">indices</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; [Char]) -&gt; [Int] -&gt; [[Char]]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679339860"><span class="hs-identifier hs-var">maxNumber</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-138"></span><span>    </span><span id="local-6989586621679339858"><span class="annot"><span class="annottext">nonterminalsList :: [[Char]]
</span><a href="#local-6989586621679339858"><span class="hs-identifier hs-var hs-var">nonterminalsList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Nonterminal -&gt; [Char]) -&gt; [Nonterminal] -&gt; [[Char]]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Nonterminal -&gt; [Char]
</span><a href="GrammarType.html#nonterminalValue"><span class="hs-identifier hs-var hs-var">nonterminalValue</span></a></span><span> </span><span class="annot"><span class="annottext">([Nonterminal] -&gt; [[Char]]) -&gt; [Nonterminal] -&gt; [[Char]]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Set Nonterminal -&gt; [Nonterminal]
forall a. Set a -&gt; [a]
</span><span class="hs-identifier hs-var">Set.toList</span></span><span> </span><span class="annot"><span class="annottext">Set Nonterminal
</span><a href="#local-6989586621679339862"><span class="hs-identifier hs-var">nonterminals</span></a></span><span>
</span><span id="line-139"></span><span>    </span><span id="local-6989586621679339856"><span class="annot"><span class="annottext">indicesWithNonterms :: [([Char], [[Char]])]
</span><a href="#local-6989586621679339856"><span class="hs-identifier hs-var hs-var">indicesWithNonterms</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; ([Char], [[Char]])) -&gt; [[Char]] -&gt; [([Char], [[Char]])]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679339855"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679339855"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679339855"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; Bool) -&gt; [[Char]] -&gt; [[Char]]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679339854"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679339854"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-140"></span><span>        </span><span class="annot"><span class="annottext">[Relation] -&gt; [Char] -&gt; [Char] -&gt; Bool
</span><a href="Boolean2TMHelpers.html#kthRelForNonterminalLong"><span class="hs-identifier hs-var">kthRelForNonterminalLong</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set Relation -&gt; [Relation]
forall a. Set a -&gt; [a]
</span><span class="hs-identifier hs-var">Set.toList</span></span><span> </span><span class="annot"><span class="annottext">Set Relation
</span><a href="#local-6989586621679339861"><span class="hs-identifier hs-var">rels</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679339854"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679339855"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[[Char]]
</span><a href="#local-6989586621679339858"><span class="hs-identifier hs-var">nonterminalsList</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[[Char]]
</span><a href="#local-6989586621679339859"><span class="hs-identifier hs-var">indices</span></a></span><span>
</span><span id="line-141"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(([Char], [[Char]]) -&gt; [([Char], [Char], [Char], [Char])])
-&gt; [([Char], [[Char]])] -&gt; [([Char], [Char], [Char], [Char])]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([Char] -&gt; [[Char]] -&gt; [([Char], [Char], [Char], [Char])])
-&gt; ([Char], [[Char]]) -&gt; [([Char], [Char], [Char], [Char])]
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="annot"><span class="annottext">(([Char] -&gt; [[Char]] -&gt; [([Char], [Char], [Char], [Char])])
 -&gt; ([Char], [[Char]]) -&gt; [([Char], [Char], [Char], [Char])])
-&gt; ([Char] -&gt; [[Char]] -&gt; [([Char], [Char], [Char], [Char])])
-&gt; ([Char], [[Char]])
-&gt; [([Char], [Char], [Char], [Char])]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Grammar -&gt; [Char] -&gt; [[Char]] -&gt; [([Char], [Char], [Char], [Char])]
</span><a href="Boolean2TMHelpers.html#calculateQuads"><span class="hs-identifier hs-var">calculateQuads</span></a></span><span> </span><span class="annot"><span class="annottext">Grammar
</span><a href="#local-6989586621679339863"><span class="hs-identifier hs-var">gr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[([Char], [[Char]])]
</span><a href="#local-6989586621679339856"><span class="hs-identifier hs-var">indicesWithNonterms</span></a></span><span>
</span><span id="line-142"></span><span>
</span><span id="line-143"></span><span class="hs-comment">-- Helpers which check sth</span><span>
</span><span id="line-144"></span><span>
</span><span id="line-145"></span><span class="annot"><a href="Boolean2TMHelpers.html#checkIfConjHasNeg"><span class="hs-identifier hs-type">checkIfConjHasNeg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GrammarType.html#Grammar"><span class="hs-identifier hs-type">Grammar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-146"></span><span id="checkIfConjHasNeg"><span class="annot"><span class="annottext">checkIfConjHasNeg :: Grammar -&gt; ([Char], [Char], [Char], [Char]) -&gt; Bool
</span><a href="Boolean2TMHelpers.html#checkIfConjHasNeg"><span class="hs-identifier hs-var hs-var">checkIfConjHasNeg</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GrammarType.html#Grammar"><span class="hs-identifier hs-type">Grammar</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set Nonterminal
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set Terminal
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679339850"><span class="annot"><span class="annottext">Set Relation
</span><a href="#local-6989586621679339850"><span class="hs-identifier hs-var">relations</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Nonterminal
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679339849"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679339849"><span class="hs-identifier hs-var">number</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679339848"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679339848"><span class="hs-identifier hs-var">leftN</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679339847"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679339847"><span class="hs-identifier hs-var">fstN</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679339846"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679339846"><span class="hs-identifier hs-var">sndN</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-147"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679339845"><span class="annot"><span class="annottext">listRelations :: [Relation]
</span><a href="#local-6989586621679339845"><span class="hs-identifier hs-var hs-var">listRelations</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set Relation -&gt; [Relation]
forall a. Set a -&gt; [a]
</span><span class="hs-identifier hs-var">Set.toList</span></span><span> </span><span class="annot"><span class="annottext">Set Relation
</span><a href="#local-6989586621679339850"><span class="hs-identifier hs-var">relations</span></a></span><span>
</span><span id="line-148"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679339844"><span class="annot"><span class="annottext">groupedRelations :: Map Nonterminal [[Conj]]
</span><a href="#local-6989586621679339844"><span class="hs-identifier hs-var hs-var">groupedRelations</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Relation] -&gt; Map Nonterminal [[Conj]]
</span><a href="Boolean2TMHelpers.html#calculateGroupRelationsByNonterminals"><span class="hs-identifier hs-var">calculateGroupRelationsByNonterminals</span></a></span><span> </span><span class="annot"><span class="annottext">[Relation]
</span><a href="#local-6989586621679339845"><span class="hs-identifier hs-var">listRelations</span></a></span><span>
</span><span id="line-149"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679339843"><span class="annot"><span class="annottext">relsForNonterminal :: [[Conj]]
</span><a href="#local-6989586621679339843"><span class="hs-identifier hs-var hs-var">relsForNonterminal</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map Nonterminal [[Conj]]
</span><a href="#local-6989586621679339844"><span class="hs-identifier hs-var">groupedRelations</span></a></span><span> </span><span class="annot"><span class="annottext">Map Nonterminal [[Conj]] -&gt; Nonterminal -&gt; [[Conj]]
forall k a. Ord k =&gt; Map k a -&gt; k -&gt; a
</span><span class="hs-operator hs-var">Map.!</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Nonterminal
</span><a href="GrammarType.html#Nonterminal"><span class="hs-identifier hs-var">Nonterminal</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679339848"><span class="hs-identifier hs-var">leftN</span></a></span><span>
</span><span id="line-150"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679339842"><span class="annot"><span class="annottext">conjs :: [Conj]
</span><a href="#local-6989586621679339842"><span class="hs-identifier hs-var hs-var">conjs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[Conj]]
</span><a href="#local-6989586621679339843"><span class="hs-identifier hs-var">relsForNonterminal</span></a></span><span> </span><span class="annot"><span class="annottext">[[Conj]] -&gt; Int -&gt; [Conj]
forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; Int
forall a. Read a =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">read</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679339849"><span class="hs-identifier hs-var">number</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-151"></span><span>    </span><span class="annot"><span class="annottext">(Conj -&gt; Bool) -&gt; [Conj] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679339840"><span class="annot"><span class="annottext">Conj
</span><a href="#local-6989586621679339840"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Conj
</span><a href="#local-6989586621679339840"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Conj -&gt; Conj -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">[Symbol] -&gt; Conj
</span><a href="GrammarType.html#NegConj"><span class="hs-identifier hs-var">NegConj</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Nonterminal -&gt; Symbol
</span><a href="GrammarType.html#N"><span class="hs-identifier hs-var">N</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; Nonterminal
</span><a href="GrammarType.html#Nonterminal"><span class="hs-identifier hs-var">Nonterminal</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679339847"><span class="hs-identifier hs-var">fstN</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Nonterminal -&gt; Symbol
</span><a href="GrammarType.html#N"><span class="hs-identifier hs-var">N</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; Nonterminal
</span><a href="GrammarType.html#Nonterminal"><span class="hs-identifier hs-var">Nonterminal</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679339846"><span class="hs-identifier hs-var">sndN</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Conj]
</span><a href="#local-6989586621679339842"><span class="hs-identifier hs-var">conjs</span></a></span><span>
</span><span id="line-152"></span><span>        </span><span>
</span><span id="line-153"></span><span class="annot"><a href="Boolean2TMHelpers.html#kthRelForNonterminalLong"><span class="hs-identifier hs-type">kthRelForNonterminalLong</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GrammarType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-154"></span><span id="kthRelForNonterminalLong"><span class="annot"><span class="annottext">kthRelForNonterminalLong :: [Relation] -&gt; [Char] -&gt; [Char] -&gt; Bool
</span><a href="Boolean2TMHelpers.html#kthRelForNonterminalLong"><span class="hs-identifier hs-var hs-var">kthRelForNonterminalLong</span></a></span></span><span> </span><span id="local-6989586621679339839"><span class="annot"><span class="annottext">[Relation]
</span><a href="#local-6989586621679339839"><span class="hs-identifier hs-var">relations</span></a></span></span><span> </span><span id="local-6989586621679339838"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679339838"><span class="hs-identifier hs-var">nontermVal</span></a></span></span><span> </span><span id="local-6989586621679339837"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679339837"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-155"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679339836"><span class="annot"><span class="annottext">k' :: Int
</span><a href="#local-6989586621679339836"><span class="hs-identifier hs-var hs-var">k'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Int
forall a. Read a =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">read</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679339837"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-156"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679339835"><span class="annot"><span class="annottext">groupedRelations :: Map Nonterminal [[Conj]]
</span><a href="#local-6989586621679339835"><span class="hs-identifier hs-var hs-var">groupedRelations</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Relation] -&gt; Map Nonterminal [[Conj]]
</span><a href="Boolean2TMHelpers.html#calculateGroupRelationsByNonterminals"><span class="hs-identifier hs-var">calculateGroupRelationsByNonterminals</span></a></span><span> </span><span class="annot"><span class="annottext">[Relation]
</span><a href="#local-6989586621679339839"><span class="hs-identifier hs-var">relations</span></a></span><span>
</span><span id="line-157"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679339834"><span class="annot"><span class="annottext">nonterminal :: Nonterminal
</span><a href="#local-6989586621679339834"><span class="hs-identifier hs-var hs-var">nonterminal</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Nonterminal
</span><a href="GrammarType.html#Nonterminal"><span class="hs-identifier hs-var">Nonterminal</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679339838"><span class="hs-identifier hs-var">nontermVal</span></a></span><span>
</span><span id="line-158"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679339833"><span class="annot"><span class="annottext">relationsForNonterm :: [[Conj]]
</span><a href="#local-6989586621679339833"><span class="hs-identifier hs-var hs-var">relationsForNonterm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map Nonterminal [[Conj]]
</span><a href="#local-6989586621679339835"><span class="hs-identifier hs-var">groupedRelations</span></a></span><span> </span><span class="annot"><span class="annottext">Map Nonterminal [[Conj]] -&gt; Nonterminal -&gt; [[Conj]]
forall k a. Ord k =&gt; Map k a -&gt; k -&gt; a
</span><span class="hs-operator hs-var">Map.!</span></span><span> </span><span class="annot"><span class="annottext">Nonterminal
</span><a href="#local-6989586621679339834"><span class="hs-identifier hs-var">nonterminal</span></a></span><span>
</span><span id="line-159"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679339832"><span class="annot"><span class="annottext">relation :: Relation
</span><a href="#local-6989586621679339832"><span class="hs-identifier hs-var hs-var">relation</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Nonterminal, [Conj]) -&gt; Relation
</span><a href="GrammarType.html#BooleanRelation"><span class="hs-identifier hs-var">BooleanRelation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Nonterminal
</span><a href="#local-6989586621679339834"><span class="hs-identifier hs-var">nonterminal</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[[Conj]]
</span><a href="#local-6989586621679339833"><span class="hs-identifier hs-var">relationsForNonterm</span></a></span><span> </span><span class="annot"><span class="annottext">[[Conj]] -&gt; Int -&gt; [Conj]
forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679339836"><span class="hs-identifier hs-var">k'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-160"></span><span>    </span><span class="annot"><span class="annottext">[[Conj]] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[[Conj]]
</span><a href="#local-6989586621679339833"><span class="hs-identifier hs-var">relationsForNonterm</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679339836"><span class="hs-identifier hs-var">k'</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span>
</span><span id="line-161"></span><span>        </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Relation -&gt; Bool
</span><a href="Boolean2TMHelpers.html#relationHasOneTerminalInRightPart"><span class="hs-identifier hs-var">relationHasOneTerminalInRightPart</span></a></span><span> </span><span class="annot"><span class="annottext">Relation
</span><a href="#local-6989586621679339832"><span class="hs-identifier hs-var">relation</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-162"></span><span>
</span><span id="line-163"></span><span class="annot"><a href="Boolean2TMHelpers.html#relationHasOneTerminalInRightPart"><span class="hs-identifier hs-type">relationHasOneTerminalInRightPart</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GrammarType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-164"></span><span id="relationHasOneTerminalInRightPart"><span class="annot"><span class="annottext">relationHasOneTerminalInRightPart :: Relation -&gt; Bool
</span><a href="Boolean2TMHelpers.html#relationHasOneTerminalInRightPart"><span class="hs-identifier hs-var hs-var">relationHasOneTerminalInRightPart</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GrammarType.html#Relation"><span class="hs-identifier hs-type">Relation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Nonterminal
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GrammarType.html#T"><span class="hs-identifier hs-type">T</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GrammarType.html#Terminal"><span class="hs-identifier hs-type">Terminal</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-165"></span><span class="annot"><a href="Boolean2TMHelpers.html#relationHasOneTerminalInRightPart"><span class="hs-identifier hs-var">relationHasOneTerminalInRightPart</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GrammarType.html#BooleanRelation"><span class="hs-identifier hs-type">BooleanRelation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Nonterminal
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GrammarType.html#PosConj"><span class="hs-identifier hs-type">PosConj</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GrammarType.html#T"><span class="hs-identifier hs-type">T</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GrammarType.html#Terminal"><span class="hs-identifier hs-type">Terminal</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-166"></span><span class="annot"><a href="Boolean2TMHelpers.html#relationHasOneTerminalInRightPart"><span class="hs-identifier hs-var">relationHasOneTerminalInRightPart</span></a></span><span> </span><span class="annot"><span class="annottext">Relation
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-167"></span><span>
</span><span id="line-168"></span><span class="annot"><a href="Boolean2TMHelpers.html#symbolAcceptedByNonterminal"><span class="hs-identifier hs-type">symbolAcceptedByNonterminal</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GrammarType.html#Grammar"><span class="hs-identifier hs-type">Grammar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-169"></span><span id="symbolAcceptedByNonterminal"><span class="annot"><span class="annottext">symbolAcceptedByNonterminal :: Grammar -&gt; [Char] -&gt; [Char] -&gt; Bool
</span><a href="Boolean2TMHelpers.html#symbolAcceptedByNonterminal"><span class="hs-identifier hs-var hs-var">symbolAcceptedByNonterminal</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GrammarType.html#Grammar"><span class="hs-identifier hs-type">Grammar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set Nonterminal
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set Terminal
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679339826"><span class="annot"><span class="annottext">Set Relation
</span><a href="#local-6989586621679339826"><span class="hs-identifier hs-var">relations</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Nonterminal
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679339825"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679339825"><span class="hs-identifier hs-var">nontermValue</span></a></span></span><span> </span><span id="local-6989586621679339824"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679339824"><span class="hs-identifier hs-var">symbol</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span>
</span><span id="line-170"></span><span>    </span><span id="local-6989586621679339823"><span class="annot"><span class="annottext">groupedRelations :: Map Nonterminal [[Conj]]
</span><a href="#local-6989586621679339823"><span class="hs-identifier hs-var hs-var">groupedRelations</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Relation] -&gt; Map Nonterminal [[Conj]]
</span><a href="Boolean2TMHelpers.html#calculateGroupRelationsByNonterminals"><span class="hs-identifier hs-var">calculateGroupRelationsByNonterminals</span></a></span><span> </span><span class="annot"><span class="annottext">([Relation] -&gt; Map Nonterminal [[Conj]])
-&gt; [Relation] -&gt; Map Nonterminal [[Conj]]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Set Relation -&gt; [Relation]
forall a. Set a -&gt; [a]
</span><span class="hs-identifier hs-var">Set.toList</span></span><span> </span><span class="annot"><span class="annottext">Set Relation
</span><a href="#local-6989586621679339826"><span class="hs-identifier hs-var">relations</span></a></span><span>
</span><span id="line-171"></span><span>    </span><span id="local-6989586621679339822"><span class="annot"><span class="annottext">nonterminal :: Nonterminal
</span><a href="#local-6989586621679339822"><span class="hs-identifier hs-var hs-var">nonterminal</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Nonterminal
</span><a href="GrammarType.html#Nonterminal"><span class="hs-identifier hs-var">Nonterminal</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679339825"><span class="hs-identifier hs-var">nontermValue</span></a></span><span>
</span><span id="line-172"></span><span>    </span><span id="local-6989586621679339821"><span class="annot"><span class="annottext">nontermRels :: [[Conj]]
</span><a href="#local-6989586621679339821"><span class="hs-identifier hs-var hs-var">nontermRels</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map Nonterminal [[Conj]]
</span><a href="#local-6989586621679339823"><span class="hs-identifier hs-var">groupedRelations</span></a></span><span> </span><span class="annot"><span class="annottext">Map Nonterminal [[Conj]] -&gt; Nonterminal -&gt; [[Conj]]
forall k a. Ord k =&gt; Map k a -&gt; k -&gt; a
</span><span class="hs-operator hs-var">Map.!</span></span><span> </span><span class="annot"><span class="annottext">Nonterminal
</span><a href="#local-6989586621679339822"><span class="hs-identifier hs-var">nonterminal</span></a></span><span>
</span><span id="line-173"></span><span>    </span><span id="local-6989586621679339820"><span class="annot"><span class="annottext">terminalsInRightPart' :: [Maybe Symbol]
</span><a href="#local-6989586621679339820"><span class="hs-identifier hs-var hs-var">terminalsInRightPart'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Conj] -&gt; Maybe Symbol) -&gt; [[Conj]] -&gt; [Maybe Symbol]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679339819"><span class="annot"><span class="annottext">[Conj]
</span><a href="#local-6989586621679339819"><span class="hs-identifier hs-var">conjs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-174"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Relation -&gt; Bool
</span><a href="Boolean2TMHelpers.html#relationHasOneTerminalInRightPart"><span class="hs-identifier hs-var">relationHasOneTerminalInRightPart</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Nonterminal, [Conj]) -&gt; Relation
</span><a href="GrammarType.html#BooleanRelation"><span class="hs-identifier hs-var">BooleanRelation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Nonterminal
</span><a href="#local-6989586621679339822"><span class="hs-identifier hs-var">nonterminal</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Conj]
</span><a href="#local-6989586621679339819"><span class="hs-identifier hs-var">conjs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-175"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Symbol -&gt; Maybe Symbol
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Symbol -&gt; Maybe Symbol) -&gt; Symbol -&gt; Maybe Symbol
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Symbol] -&gt; Symbol
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">([Symbol] -&gt; Symbol) -&gt; [Symbol] -&gt; Symbol
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Conj -&gt; [Symbol]
</span><a href="GrammarType.html#symbols"><span class="hs-identifier hs-var hs-var">symbols</span></a></span><span> </span><span class="annot"><span class="annottext">(Conj -&gt; [Symbol]) -&gt; Conj -&gt; [Symbol]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Conj] -&gt; Conj
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">[Conj]
</span><a href="#local-6989586621679339819"><span class="hs-identifier hs-var">conjs</span></a></span><span>
</span><span id="line-176"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Maybe Symbol
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[[Conj]]
</span><a href="#local-6989586621679339821"><span class="hs-identifier hs-var">nontermRels</span></a></span><span>
</span><span id="line-177"></span><span>    </span><span id="local-6989586621679339818"><span class="annot"><span class="annottext">terminalsInRightPart :: [Symbol]
</span><a href="#local-6989586621679339818"><span class="hs-identifier hs-var hs-var">terminalsInRightPart</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Maybe Symbol] -&gt; [Symbol]
forall a. [Maybe a] -&gt; [a]
</span><span class="hs-identifier hs-var">catMaybes</span></span><span> </span><span class="annot"><span class="annottext">[Maybe Symbol]
</span><a href="#local-6989586621679339820"><span class="hs-identifier hs-var">terminalsInRightPart'</span></a></span><span>
</span><span id="line-178"></span><span>    </span><span id="local-6989586621679339817"><span class="annot"><span class="annottext">terminalsValues :: [[Char]]
</span><a href="#local-6989586621679339817"><span class="hs-identifier hs-var hs-var">terminalsValues</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Symbol -&gt; [Char]) -&gt; [Symbol] -&gt; [[Char]]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Symbol -&gt; [Char]
</span><a href="Boolean2TMHelpers.html#refineSymbolToTerminalValue"><span class="hs-identifier hs-var">refineSymbolToTerminalValue</span></a></span><span> </span><span class="annot"><span class="annottext">[Symbol]
</span><a href="#local-6989586621679339818"><span class="hs-identifier hs-var">terminalsInRightPart</span></a></span><span>
</span><span id="line-179"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [[Char]] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">elem</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679339824"><span class="hs-identifier hs-var">symbol</span></a></span><span> </span><span class="annot"><span class="annottext">[[Char]]
</span><a href="#local-6989586621679339817"><span class="hs-identifier hs-var">terminalsValues</span></a></span><span>    </span><span>
</span><span id="line-180"></span><span>
</span><span id="line-181"></span><span class="hs-comment">-- Helpers for converting/refining sth to sth</span><span>
</span><span id="line-182"></span><span>
</span><span id="line-183"></span><span class="annot"><a href="Boolean2TMHelpers.html#refineSymbolInConjunctionToNonterminal"><span class="hs-identifier hs-type">refineSymbolInConjunctionToNonterminal</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GrammarType.html#Symbol"><span class="hs-identifier hs-type">GrammarType.Symbol</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-184"></span><span id="refineSymbolInConjunctionToNonterminal"><span class="annot"><span class="annottext">refineSymbolInConjunctionToNonterminal :: Symbol -&gt; [Char]
</span><a href="Boolean2TMHelpers.html#refineSymbolInConjunctionToNonterminal"><span class="hs-identifier hs-var hs-var">refineSymbolInConjunctionToNonterminal</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GrammarType.html#N"><span class="hs-identifier hs-type">N</span></a></span><span> </span><span id="local-6989586621679339814"><span class="annot"><span class="annottext">Nonterminal
</span><a href="#local-6989586621679339814"><span class="hs-identifier hs-var">nonterminal</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Nonterminal -&gt; [Char]
</span><a href="GrammarType.html#nonterminalValue"><span class="hs-identifier hs-var hs-var">nonterminalValue</span></a></span><span> </span><span class="annot"><span class="annottext">Nonterminal
</span><a href="#local-6989586621679339814"><span class="hs-identifier hs-var">nonterminal</span></a></span><span>
</span><span id="line-185"></span><span class="annot"><a href="Boolean2TMHelpers.html#refineSymbolInConjunctionToNonterminal"><span class="hs-identifier hs-var">refineSymbolInConjunctionToNonterminal</span></a></span><span> </span><span class="annot"><span class="annottext">Symbol
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char]
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Not a nonterminal, conjunction pair must be a pair of nonterminals&quot;</span></span><span>
</span><span id="line-186"></span><span>
</span><span id="line-187"></span><span id="local-6989586621679339996"><span id="local-6989586621679339997"><span class="annot"><a href="Boolean2TMHelpers.html#addCollectionToMap"><span class="hs-identifier hs-type">addCollectionToMap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679339997"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679339997"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679339996"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679339997"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679339996"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679339997"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679339996"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-188"></span><span id="addCollectionToMap"><span class="annot"><span class="annottext">addCollectionToMap :: [(k, a)] -&gt; Map k a -&gt; Map k a
</span><a href="Boolean2TMHelpers.html#addCollectionToMap"><span class="hs-identifier hs-var hs-var">addCollectionToMap</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679339812"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679339812"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679339811"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679339811"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679339810"><span class="annot"><span class="annottext">[(k, a)]
</span><a href="#local-6989586621679339810"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679339809"><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621679339809"><span class="hs-identifier hs-var">myMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(k, a)] -&gt; Map k a -&gt; Map k a
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a -&gt; Map k a
</span><a href="Boolean2TMHelpers.html#addCollectionToMap"><span class="hs-identifier hs-var">addCollectionToMap</span></a></span><span> </span><span class="annot"><span class="annottext">[(k, a)]
</span><a href="#local-6989586621679339810"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">(Map k a -&gt; Map k a) -&gt; Map k a -&gt; Map k a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">k -&gt; a -&gt; Map k a -&gt; Map k a
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.insert</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679339812"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679339811"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621679339809"><span class="hs-identifier hs-var">myMap</span></a></span><span>
</span><span id="line-189"></span><span class="annot"><a href="Boolean2TMHelpers.html#addCollectionToMap"><span class="hs-identifier hs-var">addCollectionToMap</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621679339807"><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621679339807"><span class="hs-identifier hs-var">myMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621679339807"><span class="hs-identifier hs-var">myMap</span></a></span><span>
</span><span id="line-190"></span><span>
</span><span id="line-191"></span><span class="annot"><a href="Boolean2TMHelpers.html#refineSymbolToTerminalValue"><span class="hs-identifier hs-type">refineSymbolToTerminalValue</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GrammarType.html#Symbol"><span class="hs-identifier hs-type">GrammarType.Symbol</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-192"></span><span id="refineSymbolToTerminalValue"><span class="annot"><span class="annottext">refineSymbolToTerminalValue :: Symbol -&gt; [Char]
</span><a href="Boolean2TMHelpers.html#refineSymbolToTerminalValue"><span class="hs-identifier hs-var hs-var">refineSymbolToTerminalValue</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GrammarType.html#T"><span class="hs-identifier hs-type">T</span></a></span><span> </span><span id="local-6989586621679339806"><span class="annot"><span class="annottext">Terminal
</span><a href="#local-6989586621679339806"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Terminal -&gt; [Char]
</span><a href="GrammarType.html#terminalValue"><span class="hs-identifier hs-var hs-var">terminalValue</span></a></span><span> </span><span class="annot"><span class="annottext">Terminal
</span><a href="#local-6989586621679339806"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-193"></span><span class="annot"><a href="Boolean2TMHelpers.html#refineSymbolToTerminalValue"><span class="hs-identifier hs-var">refineSymbolToTerminalValue</span></a></span><span> </span><span class="annot"><span class="annottext">Symbol
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char]
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Given symbol is not terminal&quot;</span></span><span>
</span><span id="line-194"></span><span>
</span><span id="line-195"></span><span class="annot"><a href="Boolean2TMHelpers.html#constructSymbolsPairByQuad"><span class="hs-identifier hs-type">constructSymbolsPairByQuad</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="DebuggingTMTypes.html#SymbolsPair"><span class="hs-identifier hs-type">SymbolsPair</span></a></span><span>
</span><span id="line-196"></span><span id="constructSymbolsPairByQuad"><span class="annot"><span class="annottext">constructSymbolsPairByQuad :: ([Char], [Char], [Char], [Char]) -&gt; Bool -&gt; SymbolsPair
</span><a href="Boolean2TMHelpers.html#constructSymbolsPairByQuad"><span class="hs-identifier hs-var hs-var">constructSymbolsPairByQuad</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679339803"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679339803"><span class="hs-identifier hs-var">number</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679339802"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679339802"><span class="hs-identifier hs-var">leftN</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679339801"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679339801"><span class="hs-identifier hs-var">fstN</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679339800"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679339800"><span class="hs-identifier hs-var">sndN</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679339799"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679339799"><span class="hs-identifier hs-var">hasNeg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-197"></span><span>    </span><span class="annot"><span class="annottext">(Nonterminal, Int, Bool, Symbol, Symbol) -&gt; SymbolsPair
</span><a href="DebuggingTMTypes.html#SymbolsPair"><span class="hs-identifier hs-var">SymbolsPair</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; Nonterminal
</span><a href="GrammarType.html#Nonterminal"><span class="hs-identifier hs-var">Nonterminal</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679339802"><span class="hs-identifier hs-var">leftN</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Int
forall a. Read a =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">read</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679339803"><span class="hs-identifier hs-var">number</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679339799"><span class="hs-identifier hs-var">hasNeg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Nonterminal -&gt; Symbol
</span><a href="GrammarType.html#N"><span class="hs-identifier hs-var">N</span></a></span><span> </span><span class="annot"><span class="annottext">(Nonterminal -&gt; Symbol) -&gt; Nonterminal -&gt; Symbol
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Nonterminal
</span><a href="GrammarType.html#Nonterminal"><span class="hs-identifier hs-var">Nonterminal</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679339801"><span class="hs-identifier hs-var">fstN</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Nonterminal -&gt; Symbol
</span><a href="GrammarType.html#N"><span class="hs-identifier hs-var">N</span></a></span><span> </span><span class="annot"><span class="annottext">(Nonterminal -&gt; Symbol) -&gt; Nonterminal -&gt; Symbol
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Nonterminal
</span><a href="GrammarType.html#Nonterminal"><span class="hs-identifier hs-var">Nonterminal</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679339800"><span class="hs-identifier hs-var">sndN</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-198"></span><span>
</span><span id="line-199"></span><span class="annot"><a href="Boolean2TMHelpers.html#convertListToConjunctionPair"><span class="hs-identifier hs-type">convertListToConjunctionPair</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GrammarType.html#Nonterminal"><span class="hs-identifier hs-type">Nonterminal</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GrammarType.html#Conj"><span class="hs-identifier hs-type">Conj</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="DebuggingTMTypes.html#SymbolsPair"><span class="hs-identifier hs-type">SymbolsPair</span></a></span><span>
</span><span id="line-200"></span><span id="convertListToConjunctionPair"><span class="annot"><span class="annottext">convertListToConjunctionPair :: Nonterminal -&gt; Int -&gt; Conj -&gt; SymbolsPair
</span><a href="Boolean2TMHelpers.html#convertListToConjunctionPair"><span class="hs-identifier hs-var hs-var">convertListToConjunctionPair</span></a></span></span><span> </span><span id="local-6989586621679339798"><span class="annot"><span class="annottext">Nonterminal
</span><a href="#local-6989586621679339798"><span class="hs-identifier hs-var">nonterminal</span></a></span></span><span> </span><span id="local-6989586621679339797"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679339797"><span class="hs-identifier hs-var">relationNumber</span></a></span></span><span>
</span><span id="line-201"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="GrammarType.html#NegConj"><span class="hs-identifier hs-type">NegConj</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GrammarType.html#N"><span class="hs-identifier hs-type">N</span></a></span><span> </span><span id="local-6989586621679339796"><span class="annot"><span class="annottext">Nonterminal
</span><a href="#local-6989586621679339796"><span class="hs-identifier hs-var">conjNonterminal1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GrammarType.html#N"><span class="hs-identifier hs-type">N</span></a></span><span> </span><span id="local-6989586621679339795"><span class="annot"><span class="annottext">Nonterminal
</span><a href="#local-6989586621679339795"><span class="hs-identifier hs-var">conjNonterminal2</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-202"></span><span>    </span><span class="annot"><span class="annottext">(Nonterminal, Int, Bool, Symbol, Symbol) -&gt; SymbolsPair
</span><a href="DebuggingTMTypes.html#SymbolsPair"><span class="hs-identifier hs-var">SymbolsPair</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Nonterminal
</span><a href="#local-6989586621679339798"><span class="hs-identifier hs-var">nonterminal</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679339797"><span class="hs-identifier hs-var">relationNumber</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Nonterminal -&gt; Symbol
</span><a href="GrammarType.html#N"><span class="hs-identifier hs-var">N</span></a></span><span> </span><span class="annot"><span class="annottext">Nonterminal
</span><a href="#local-6989586621679339796"><span class="hs-identifier hs-var">conjNonterminal1</span></a></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Nonterminal -&gt; Symbol
</span><a href="GrammarType.html#N"><span class="hs-identifier hs-var">N</span></a></span><span> </span><span class="annot"><span class="annottext">Nonterminal
</span><a href="#local-6989586621679339795"><span class="hs-identifier hs-var">conjNonterminal2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-203"></span><span class="annot"><a href="Boolean2TMHelpers.html#convertListToConjunctionPair"><span class="hs-identifier hs-var">convertListToConjunctionPair</span></a></span><span> </span><span id="local-6989586621679339794"><span class="annot"><span class="annottext">Nonterminal
</span><a href="#local-6989586621679339794"><span class="hs-identifier hs-var">nonterminal</span></a></span></span><span> </span><span id="local-6989586621679339793"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679339793"><span class="hs-identifier hs-var">relationNumber</span></a></span></span><span>
</span><span id="line-204"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="GrammarType.html#PosConj"><span class="hs-identifier hs-type">PosConj</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GrammarType.html#N"><span class="hs-identifier hs-type">N</span></a></span><span> </span><span id="local-6989586621679339792"><span class="annot"><span class="annottext">Nonterminal
</span><a href="#local-6989586621679339792"><span class="hs-identifier hs-var">conjNonterminal1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GrammarType.html#N"><span class="hs-identifier hs-type">N</span></a></span><span> </span><span id="local-6989586621679339791"><span class="annot"><span class="annottext">Nonterminal
</span><a href="#local-6989586621679339791"><span class="hs-identifier hs-var">conjNonterminal2</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-205"></span><span>    </span><span class="annot"><span class="annottext">(Nonterminal, Int, Bool, Symbol, Symbol) -&gt; SymbolsPair
</span><a href="DebuggingTMTypes.html#SymbolsPair"><span class="hs-identifier hs-var">SymbolsPair</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Nonterminal
</span><a href="#local-6989586621679339794"><span class="hs-identifier hs-var">nonterminal</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679339793"><span class="hs-identifier hs-var">relationNumber</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Nonterminal -&gt; Symbol
</span><a href="GrammarType.html#N"><span class="hs-identifier hs-var">N</span></a></span><span> </span><span class="annot"><span class="annottext">Nonterminal
</span><a href="#local-6989586621679339792"><span class="hs-identifier hs-var">conjNonterminal1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Nonterminal -&gt; Symbol
</span><a href="GrammarType.html#N"><span class="hs-identifier hs-var">N</span></a></span><span> </span><span class="annot"><span class="annottext">Nonterminal
</span><a href="#local-6989586621679339791"><span class="hs-identifier hs-var">conjNonterminal2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-206"></span><span class="annot"><a href="Boolean2TMHelpers.html#convertListToConjunctionPair"><span class="hs-identifier hs-var">convertListToConjunctionPair</span></a></span><span> </span><span class="annot"><span class="annottext">Nonterminal
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Conj
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; SymbolsPair
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Conjunction must be pair of nonterminals. &quot;</span></span><span>
</span><span id="line-207"></span><span>
</span><span id="line-208"></span><span class="hs-comment">-- other</span><span>
</span><span id="line-209"></span><span>
</span><span id="line-210"></span><span class="annot"><a href="Boolean2TMHelpers.html#getShiftsDecrements"><span class="hs-identifier hs-type">getShiftsDecrements</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-211"></span><span id="getShiftsDecrements"><span class="annot"><span class="annottext">getShiftsDecrements :: Int -&gt; [Char] -&gt; [([Char], [Char])]
</span><a href="Boolean2TMHelpers.html#getShiftsDecrements"><span class="hs-identifier hs-var hs-var">getShiftsDecrements</span></a></span></span><span> </span><span id="local-6989586621679339789"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679339789"><span class="hs-identifier hs-var">shiftSize</span></a></span></span><span> </span><span id="local-6989586621679339788"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679339788"><span class="hs-identifier hs-var">symbol</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span>
</span><span id="line-212"></span><span>    </span><span id="local-6989586621679339787"><span class="annot"><span class="annottext">fstPair :: [([Char], [Char])]
</span><a href="#local-6989586621679339787"><span class="hs-identifier hs-var hs-var">fstPair</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679339788"><span class="hs-identifier hs-var">symbol</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679339789"><span class="hs-identifier hs-var">shiftSize</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-213"></span><span>    </span><span id="local-6989586621679339786"><span class="annot"><span class="annottext">indices :: [Int]
</span><a href="#local-6989586621679339786"><span class="hs-identifier hs-var hs-var">indices</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679339789"><span class="hs-identifier hs-var">shiftSize</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-214"></span><span>    </span><span id="local-6989586621679339785"><span class="annot"><span class="annottext">midPairs :: [([Char], [Char])]
</span><a href="#local-6989586621679339785"><span class="hs-identifier hs-var hs-var">midPairs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; ([Char], [Char])) -&gt; [Int] -&gt; [([Char], [Char])]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679339784"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679339784"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span>
</span><span id="line-215"></span><span>        </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679339784"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679339784"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679339788"><span class="hs-identifier hs-var">symbol</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-216"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679339784"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679339784"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-217"></span><span>        </span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679339786"><span class="hs-identifier hs-var">indices</span></a></span><span>
</span><span id="line-218"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[([Char], [Char])]
</span><a href="#local-6989586621679339787"><span class="hs-identifier hs-var">fstPair</span></a></span><span> </span><span class="annot"><span class="annottext">[([Char], [Char])] -&gt; [([Char], [Char])] -&gt; [([Char], [Char])]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[([Char], [Char])]
</span><a href="#local-6989586621679339785"><span class="hs-identifier hs-var">midPairs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-219"></span></pre></body></html>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- |This module represents functionality for converting the 'TMTypes.TuringMachine' to 'TmsType.Tms'.</span><span>
</span><span id="line-2"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">TuringMachine2Tms</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="TuringMachine2Tms.html#turingMachine2tms"><span class="hs-identifier">turingMachine2tms</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="TuringMachine2Tms.html#turingMachineSt2tmsSt"><span class="hs-identifier">turingMachineSt2tmsSt</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-3"></span><span>
</span><span id="line-4"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Functor</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(&lt;&amp;&gt;)</span></span><span class="hs-special">)</span><span>
</span><span id="line-5"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fromMaybe</span></span><span class="hs-special">)</span><span>
</span><span id="line-6"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">sort</span></span><span class="hs-special">)</span><span>
</span><span id="line-7"></span><span>
</span><span id="line-8"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="TmsType.html"><span class="hs-identifier">TmsType</span></a></span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="TuringMachine.html"><span class="hs-identifier">TuringMachine</span></a></span><span>
</span><span id="line-10"></span><span>
</span><span id="line-11"></span><span class="annot"><a href="TuringMachine2Tms.html#turingMachine2tms"><span class="hs-identifier hs-type">turingMachine2tms</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="TuringMachine.html#TuringMachine"><span class="hs-identifier hs-type">TuringMachine</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="TmsType.html#Tms"><span class="hs-identifier hs-type">Tms</span></a></span><span>
</span><span id="line-12"></span><span id="turingMachine2tms"><span class="annot"><span class="annottext">turingMachine2tms :: TuringMachine -&gt; Tms
</span><a href="TuringMachine2Tms.html#turingMachine2tms"><span class="hs-identifier hs-var hs-var">turingMachine2tms</span></a></span></span><span> </span><span id="local-6989586621679343219"><span class="annot"><span class="annottext">TuringMachine
</span><a href="#local-6989586621679343219"><span class="hs-identifier hs-var">tm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-13"></span><span>    </span><span class="annot"><span class="annottext">(String, TmsState, [TmsState], [TmsCommand], [String]) -&gt; Tms
</span><a href="TmsType.html#Tms"><span class="hs-identifier hs-var">Tms</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-14"></span><span>            </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;TMTypes_TuringMachine&quot;</span></span><span class="hs-special">,</span><span>
</span><span id="line-15"></span><span>            </span><span class="annot"><span class="annottext">State -&gt; TmsState
</span><a href="TuringMachine2Tms.html#turingMachineSt2tmsSt"><span class="hs-identifier hs-var">turingMachineSt2tmsSt</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="TuringMachine.State.html#startState"><span class="hs-identifier hs-var">startState</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-16"></span><span>            </span><span class="hs-special">[</span><span class="annot"><span class="annottext">State -&gt; TmsState
</span><a href="TuringMachine2Tms.html#turingMachineSt2tmsSt"><span class="hs-identifier hs-var">turingMachineSt2tmsSt</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="TuringMachine.State.html#finalState"><span class="hs-identifier hs-var">finalState</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-17"></span><span>            </span><span class="annot"><span class="annottext">[TmsCommand] -&gt; [TmsCommand]
forall a. Ord a =&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">sort</span></span><span> </span><span class="annot"><span class="annottext">([TmsCommand] -&gt; [TmsCommand]) -&gt; [TmsCommand] -&gt; [TmsCommand]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Quadruples -&gt; [Quadruple]
forall c v. Listable c v =&gt; c -&gt; [v]
</span><a href="Containers.html#toList"><span class="hs-identifier hs-var">toList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TuringMachine
</span><a href="#local-6989586621679343219"><span class="hs-identifier hs-var">tm</span></a></span><span class="annot"><span class="annottext">TuringMachine
-&gt; Getting Quadruples TuringMachine Quadruples -&gt; Quadruples
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Getting Quadruples TuringMachine Quadruples
Lens' TuringMachine Quadruples
</span><a href="TuringMachine.html#quadruples"><span class="hs-identifier hs-var">quadruples</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Quadruple]
-&gt; (Quadruple -&gt; OneTapeTMCommand) -&gt; [OneTapeTMCommand]
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; (a -&gt; b) -&gt; f b
</span><span class="hs-operator hs-var">&lt;&amp;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Alphabet -&gt; Quadruple -&gt; OneTapeTMCommand
</span><a href="TuringMachine2Tms.html#turingMCmd2tms"><span class="hs-identifier hs-var">turingMCmd2tms</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TuringMachine
</span><a href="#local-6989586621679343219"><span class="hs-identifier hs-var">tm</span></a></span><span class="annot"><span class="annottext">TuringMachine
-&gt; Getting Alphabet TuringMachine Alphabet -&gt; Alphabet
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Getting Alphabet TuringMachine Alphabet
Lens' TuringMachine Alphabet
</span><a href="TuringMachine.html#alphabet"><span class="hs-identifier hs-var">alphabet</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[OneTapeTMCommand]
-&gt; (OneTapeTMCommand -&gt; TmsCommand) -&gt; [TmsCommand]
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; (a -&gt; b) -&gt; f b
</span><span class="hs-operator hs-var">&lt;&amp;&gt;</span></span><span> </span><span class="annot"><span class="annottext">OneTapeTMCommand -&gt; TmsCommand
</span><a href="TmsType.html#toTmsCommand"><span class="hs-identifier hs-var">toTmsCommand</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-18"></span><span>            </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; Char
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Char)
-&gt; (ShowedSymbol -&gt; String) -&gt; ShowedSymbol -&gt; Char
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ShowedSymbol -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">(ShowedSymbol -&gt; Char) -&gt; [ShowedSymbol] -&gt; String
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ShowedSymbol
</span><a href="TuringMachine.ShowedSymbol.html#blank"><span class="hs-identifier hs-var">blank</span></a></span><span> </span><span class="annot"><span class="annottext">ShowedSymbol -&gt; [ShowedSymbol] -&gt; [ShowedSymbol]
forall c v. Deletable c v =&gt; v -&gt; c -&gt; c
</span><a href="Containers.html#%5C%3E"><span class="hs-operator hs-var">\&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Alphabet -&gt; [ShowedSymbol]
forall c v. Valuable c v =&gt; c -&gt; [v]
</span><a href="Containers.html#values"><span class="hs-identifier hs-var">values</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TuringMachine
</span><a href="#local-6989586621679343219"><span class="hs-identifier hs-var">tm</span></a></span><span class="annot"><span class="annottext">TuringMachine
-&gt; Getting Alphabet TuringMachine Alphabet -&gt; Alphabet
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Getting Alphabet TuringMachine Alphabet
Lens' TuringMachine Alphabet
</span><a href="TuringMachine.html#alphabet"><span class="hs-identifier hs-var">alphabet</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="TuringMachine.ShowedSymbol.html#ShowedSymbols"><span class="hs-identifier hs-type">ShowedSymbols</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-19"></span><span>        </span><span class="hs-special">)</span><span>
</span><span id="line-20"></span><span>
</span><span id="line-21"></span><span class="hs-comment">-- Section of helper functions.</span><span>
</span><span id="line-22"></span><span>
</span><span id="line-23"></span><span class="annot"><a href="TuringMachine2Tms.html#turingMachineSt2tmsSt"><span class="hs-identifier hs-type">turingMachineSt2tmsSt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="TuringMachine.State.html#State"><span class="hs-identifier hs-type">State</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="TmsType.html#TmsState"><span class="hs-identifier hs-type">TmsState</span></a></span><span>
</span><span id="line-24"></span><span id="turingMachineSt2tmsSt"><span class="annot"><span class="annottext">turingMachineSt2tmsSt :: State -&gt; TmsState
</span><a href="TuringMachine2Tms.html#turingMachineSt2tmsSt"><span class="hs-identifier hs-var hs-var">turingMachineSt2tmsSt</span></a></span></span><span> </span><span id="local-6989586621679343201"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679343201"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; TmsState
</span><a href="TmsType.html#TmsState"><span class="hs-identifier hs-var">TmsState</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; TmsState) -&gt; String -&gt; TmsState
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Q_&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">State -&gt; Int
</span><a href="TuringMachine.State.html#numState"><span class="hs-identifier hs-var hs-var">numState</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679343201"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span>
</span><span id="line-26"></span><span class="annot"><a href="TuringMachine2Tms.html#turingMCmd2tms"><span class="hs-identifier hs-type">turingMCmd2tms</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="TuringMachine.html#Alphabet"><span class="hs-identifier hs-type">Alphabet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="TuringMachine.Quadruple.html#Quadruple"><span class="hs-identifier hs-type">TuringMachine.Quadruple</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="TmsType.html#OneTapeTMCommand"><span class="hs-identifier hs-type">OneTapeTMCommand</span></a></span><span>
</span><span id="line-27"></span><span id="turingMCmd2tms"><span class="annot"><span class="annottext">turingMCmd2tms :: Alphabet -&gt; Quadruple -&gt; OneTapeTMCommand
</span><a href="TuringMachine2Tms.html#turingMCmd2tms"><span class="hs-identifier hs-var hs-var">turingMCmd2tms</span></a></span></span><span> </span><span id="local-6989586621679343198"><span class="annot"><span class="annottext">Alphabet
</span><a href="#local-6989586621679343198"><span class="hs-identifier hs-var">alph</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679343197"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679343197"><span class="hs-identifier hs-var">iniSt</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679343196"><span class="annot"><span class="annottext">Symbol
</span><a href="#local-6989586621679343196"><span class="hs-identifier hs-var">from</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679343195"><span class="annot"><span class="annottext">SymbolOrMove
</span><a href="#local-6989586621679343195"><span class="hs-identifier hs-var">act</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679343194"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679343194"><span class="hs-identifier hs-var">folSt</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-28"></span><span>        </span><span class="annot"><span class="annottext">State -&gt; TmsState
</span><a href="TuringMachine2Tms.html#turingMachineSt2tmsSt"><span class="hs-identifier hs-var">turingMachineSt2tmsSt</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679343197"><span class="hs-identifier hs-var">iniSt</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-29"></span><span>        </span><span class="annot"><span class="annottext">(TmsTapeSquare, TmsTapeHeadMovement) -&gt; TmsSingleTapeCommand
</span><a href="TmsType.html#TmsSingleTapeCommand"><span class="hs-identifier hs-var">TmsSingleTapeCommand</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TmsTapeSquare
</span><a href="#local-6989586621679343192"><span class="hs-identifier hs-var">action</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TmsTapeHeadMovement
</span><a href="#local-6989586621679343191"><span class="hs-identifier hs-var">move</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-30"></span><span>        </span><span class="annot"><span class="annottext">State -&gt; TmsState
</span><a href="TuringMachine2Tms.html#turingMachineSt2tmsSt"><span class="hs-identifier hs-var">turingMachineSt2tmsSt</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679343194"><span class="hs-identifier hs-var">folSt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-32"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679343191"><span class="annot"><span class="annottext">TmsTapeHeadMovement
</span><a href="#local-6989586621679343191"><span class="hs-identifier hs-var">move</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679343192"><span class="annot"><span class="annottext">TmsTapeSquare
</span><a href="#local-6989586621679343192"><span class="hs-identifier hs-var">action</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">SymbolOrMove
</span><a href="#local-6989586621679343195"><span class="hs-identifier hs-var">act</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-33"></span><span>            </span><span class="annot"><a href="TuringMachine.SymbolOrMove.html#S"><span class="hs-identifier hs-type">S</span></a></span><span> </span><span id="local-6989586621679343189"><span class="annot"><span class="annottext">Symbol
</span><a href="#local-6989586621679343189"><span class="hs-identifier hs-var">to</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TmsTapeHeadMovement
</span><a href="TmsType.html#Stay"><span class="hs-identifier hs-var">Stay</span></a></span><span class="hs-special">,</span><span>      </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; TmsTapeSquare
</span><a href="TmsType.html#ChangeFromTo"><span class="hs-identifier hs-var">ChangeFromTo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Symbol -&gt; Char
</span><a href="#local-6989586621679343186"><span class="hs-identifier hs-var">symb2char</span></a></span><span> </span><span class="annot"><span class="annottext">Symbol
</span><a href="#local-6989586621679343196"><span class="hs-identifier hs-var">from</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Symbol -&gt; Char
</span><a href="#local-6989586621679343186"><span class="hs-identifier hs-var">symb2char</span></a></span><span> </span><span class="annot"><span class="annottext">Symbol
</span><a href="#local-6989586621679343189"><span class="hs-identifier hs-var">to</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span>            </span><span class="annot"><a href="TuringMachine.SymbolOrMove.html#M"><span class="hs-identifier hs-type">M</span></a></span><span> </span><span id="local-6989586621679343184"><span class="annot"><span class="annottext">Move
</span><a href="#local-6989586621679343184"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Move
</span><a href="#local-6989586621679343184"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Move -&gt; Move -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Move
</span><a href="TuringMachine.Move.html#toLeft"><span class="hs-identifier hs-var">toLeft</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TmsTapeHeadMovement
</span><a href="TmsType.html#MoveLeft"><span class="hs-identifier hs-var">MoveLeft</span></a></span><span class="hs-special">,</span><span>  </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; TmsTapeSquare
</span><a href="TmsType.html#ChangeFromTo"><span class="hs-identifier hs-var">ChangeFromTo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Symbol -&gt; Char
</span><a href="#local-6989586621679343186"><span class="hs-identifier hs-var">symb2char</span></a></span><span> </span><span class="annot"><span class="annottext">Symbol
</span><a href="#local-6989586621679343196"><span class="hs-identifier hs-var">from</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Symbol -&gt; Char
</span><a href="#local-6989586621679343186"><span class="hs-identifier hs-var">symb2char</span></a></span><span> </span><span class="annot"><span class="annottext">Symbol
</span><a href="#local-6989586621679343196"><span class="hs-identifier hs-var">from</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TmsTapeHeadMovement
</span><a href="TmsType.html#MoveRight"><span class="hs-identifier hs-var">MoveRight</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; TmsTapeSquare
</span><a href="TmsType.html#ChangeFromTo"><span class="hs-identifier hs-var">ChangeFromTo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Symbol -&gt; Char
</span><a href="#local-6989586621679343186"><span class="hs-identifier hs-var">symb2char</span></a></span><span> </span><span class="annot"><span class="annottext">Symbol
</span><a href="#local-6989586621679343196"><span class="hs-identifier hs-var">from</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Symbol -&gt; Char
</span><a href="#local-6989586621679343186"><span class="hs-identifier hs-var">symb2char</span></a></span><span> </span><span class="annot"><span class="annottext">Symbol
</span><a href="#local-6989586621679343196"><span class="hs-identifier hs-var">from</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span>        </span><span class="annot"><a href="#local-6989586621679343186"><span class="hs-identifier hs-type">symb2char</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="TuringMachine.Symbol.html#Symbol"><span class="hs-identifier hs-type">Symbol</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span>
</span><span id="line-37"></span><span>        </span><span id="local-6989586621679343186"><span class="annot"><span class="annottext">symb2char :: Symbol -&gt; Char
</span><a href="#local-6989586621679343186"><span class="hs-identifier hs-var hs-var">symb2char</span></a></span></span><span> </span><span id="local-6989586621679343180"><span class="annot"><span class="annottext">Symbol
</span><a href="#local-6989586621679343180"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Maybe Char -&gt; Char
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'?'</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Char -&gt; Char) -&gt; Maybe Char -&gt; Char
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-38"></span><span>            </span><span id="local-6989586621679343179"><span class="annot"><span class="annottext">ShowedSymbol
</span><a href="#local-6989586621679343179"><span class="hs-identifier hs-var">s'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Alphabet
</span><a href="#local-6989586621679343198"><span class="hs-identifier hs-var">alph</span></a></span><span> </span><span class="annot"><span class="annottext">Alphabet -&gt; Symbol -&gt; Maybe ShowedSymbol
forall c k v (m :: * -&gt; *).
(Indexable c k v, MonadFail m) =&gt;
c -&gt; k -&gt; m v
</span><a href="Containers.html#%21%3F"><span class="hs-operator hs-var">!?</span></a></span><span> </span><span class="annot"><span class="annottext">Symbol
</span><a href="#local-6989586621679343180"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-39"></span><span>            </span><span class="annot"><span class="annottext">Char -&gt; Maybe Char
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Maybe Char) -&gt; Char -&gt; Maybe Char
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-40"></span><span>                </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">ShowedSymbol
</span><a href="#local-6989586621679343179"><span class="hs-identifier hs-var">s'</span></a></span><span> </span><span class="annot"><span class="annottext">ShowedSymbol -&gt; ShowedSymbol -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">ShowedSymbol
</span><a href="TuringMachine.ShowedSymbol.html#blank"><span class="hs-identifier hs-var">blank</span></a></span><span>
</span><span id="line-41"></span><span>                </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'_'</span></span><span>
</span><span id="line-42"></span><span>                </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">String -&gt; Char
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Char) -&gt; String -&gt; Char
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ShowedSymbol -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">ShowedSymbol
</span><a href="#local-6989586621679343179"><span class="hs-identifier hs-var">s'</span></a></span><span>
</span><span id="line-43"></span></pre></body></html>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">StringRewriting.Rewrite</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-2"></span><span>    </span><span class="annot"><a href="StringRewriting.Rewrite.html#rewrite"><span class="hs-identifier">rewrite</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-3"></span><span>    </span><span class="annot"><a href="StringRewriting.Rewrite.html#rewrite%27"><span class="hs-identifier">rewrite'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-4"></span><span>    </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="StringRewriting.html"><span class="hs-identifier">StringRewriting</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-5"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-6"></span><span>
</span><span id="line-7"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="StringRewriting.html"><span class="hs-identifier">StringRewriting</span></a></span><span>
</span><span id="line-8"></span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Math.Algebra.Group.StringRewriting</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">SR</span></span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">forM</span></span><span class="hs-special">)</span><span>
</span><span id="line-11"></span><span>
</span><span id="line-12"></span><span class="annot"><a href="StringRewriting.Rewrite.html#rewrite%27"><span class="hs-identifier hs-type">rewrite'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="StringRewriting.html#StringRewriting"><span class="hs-identifier hs-type">StringRewriting</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="StringRewriting.Generator.html#GWord"><span class="hs-identifier hs-type">GWord</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="StringRewriting.Generator.html#GWord"><span class="hs-identifier hs-type">GWord</span></a></span><span>
</span><span id="line-13"></span><span id="rewrite%27"><span class="annot"><span class="annottext">rewrite' :: StringRewriting -&gt; GWord -&gt; GWord
</span><a href="StringRewriting.Rewrite.html#rewrite%27"><span class="hs-identifier hs-var hs-var">rewrite'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(GWord, GWord)] -&gt; GWord -&gt; GWord
forall a. Eq a =&gt; [([a], [a])] -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">SR.rewrite</span></span><span> </span><span class="annot"><span class="annottext">([(GWord, GWord)] -&gt; GWord -&gt; GWord)
-&gt; (StringRewriting -&gt; [(GWord, GWord)])
-&gt; StringRewriting
-&gt; GWord
-&gt; GWord
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Rule -&gt; (GWord, GWord)) -&gt; [Rule] -&gt; [(GWord, GWord)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Rule -&gt; (GWord, GWord)
</span><a href="StringRewriting.Rule.html#toPair"><span class="hs-identifier hs-var">toPair</span></a></span><span> </span><span class="annot"><span class="annottext">([Rule] -&gt; [(GWord, GWord)])
-&gt; (StringRewriting -&gt; [Rule])
-&gt; StringRewriting
-&gt; [(GWord, GWord)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Rules -&gt; [Rule]
forall c v. Listable c v =&gt; c -&gt; [v]
</span><a href="Containers.html#toList"><span class="hs-identifier hs-var">toList</span></a></span><span> </span><span class="annot"><span class="annottext">(Rules -&gt; [Rule])
-&gt; (StringRewriting -&gt; Rules) -&gt; StringRewriting -&gt; [Rule]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Getting Rules StringRewriting Rules -&gt; StringRewriting -&gt; Rules
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">Getting Rules StringRewriting Rules
Lens' StringRewriting Rules
</span><a href="StringRewriting.html#rules"><span class="hs-identifier hs-var">rules</span></a></span><span>
</span><span id="line-14"></span><span>
</span><span id="line-15"></span><span id="local-6989586621679332086"><span class="annot"><a href="StringRewriting.Rewrite.html#rewrite"><span class="hs-identifier hs-type">rewrite</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadFail</span></span><span> </span><span class="annot"><a href="#local-6989586621679332086"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="StringRewriting.html#StringRewriting"><span class="hs-identifier hs-type">StringRewriting</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679332086"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span></span><span>
</span><span id="line-16"></span><span id="rewrite"><span class="annot"><span class="annottext">rewrite :: StringRewriting -&gt; String -&gt; m String
</span><a href="StringRewriting.Rewrite.html#rewrite"><span class="hs-identifier hs-var hs-var">rewrite</span></a></span></span><span> </span><span id="local-6989586621679332085"><span class="annot"><span class="annottext">StringRewriting
</span><a href="#local-6989586621679332085"><span class="hs-identifier hs-var">sr</span></a></span></span><span> </span><span id="local-6989586621679332084"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679332084"><span class="hs-identifier hs-var">strIni</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-17"></span><span>    </span><span id="local-6989586621679332083"><span class="annot"><span class="annottext">GWord
</span><a href="#local-6989586621679332083"><span class="hs-identifier hs-var">gwIni</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; (String -&gt; m Generator) -&gt; m GWord
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m (t b)
</span><span class="hs-identifier hs-var">forM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; [String]
</span><span class="hs-identifier hs-var">words</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679332084"><span class="hs-identifier hs-var">strIni</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((String -&gt; m Generator) -&gt; m GWord)
-&gt; (String -&gt; m Generator) -&gt; m GWord
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679332081"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679332081"><span class="hs-identifier hs-var">strGen</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">StringRewriting
</span><a href="#local-6989586621679332085"><span class="hs-identifier hs-var">sr</span></a></span><span class="annot"><span class="annottext">StringRewriting
-&gt; Getting (m Generator) StringRewriting (m Generator)
-&gt; m Generator
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">(GeneratorsDescr -&gt; Const (m Generator) GeneratorsDescr)
-&gt; StringRewriting -&gt; Const (m Generator) StringRewriting
Lens' StringRewriting GeneratorsDescr
</span><a href="StringRewriting.html#generatorsDescr"><span class="hs-identifier hs-var">generatorsDescr</span></a></span><span class="annot"><span class="annottext">((GeneratorsDescr -&gt; Const (m Generator) GeneratorsDescr)
 -&gt; StringRewriting -&gt; Const (m Generator) StringRewriting)
-&gt; String -&gt; Getting (m Generator) StringRewriting (m Generator)
forall c k v (m :: * -&gt; *) x y.
(Indexable c k v, MonadFail m) =&gt;
Getting x y c -&gt; k -&gt; Getting x y (m v)
</span><a href="Containers.html#.%40"><span class="hs-operator hs-var">.@</span></a></span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679332081"><span class="hs-identifier hs-var">strGen</span></a></span><span>
</span><span id="line-18"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679332077"><span class="annot"><span class="annottext">gwRes :: GWord
</span><a href="#local-6989586621679332077"><span class="hs-identifier hs-var hs-var">gwRes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StringRewriting -&gt; GWord -&gt; GWord
</span><a href="StringRewriting.Rewrite.html#rewrite%27"><span class="hs-identifier hs-var">rewrite'</span></a></span><span> </span><span class="annot"><span class="annottext">StringRewriting
</span><a href="#local-6989586621679332085"><span class="hs-identifier hs-var">sr</span></a></span><span> </span><span class="annot"><span class="annottext">GWord
</span><a href="#local-6989586621679332083"><span class="hs-identifier hs-var">gwIni</span></a></span><span>
</span><span id="line-19"></span><span>    </span><span id="local-6989586621679332076"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679332076"><span class="hs-identifier hs-var">strGens</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GWord -&gt; (Generator -&gt; m String) -&gt; m [String]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m (t b)
</span><span class="hs-identifier hs-var">forM</span></span><span> </span><span class="annot"><span class="annottext">GWord
</span><a href="#local-6989586621679332077"><span class="hs-identifier hs-var">gwRes</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator -&gt; m String) -&gt; m [String])
-&gt; (Generator -&gt; m String) -&gt; m [String]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679332075"><span class="annot"><span class="annottext">Generator
</span><a href="#local-6989586621679332075"><span class="hs-identifier hs-var">gen</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">StringRewriting
</span><a href="#local-6989586621679332085"><span class="hs-identifier hs-var">sr</span></a></span><span class="annot"><span class="annottext">StringRewriting
-&gt; Getting (m String) StringRewriting (m String) -&gt; m String
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">(GeneratorsDescr -&gt; Const (m String) GeneratorsDescr)
-&gt; StringRewriting -&gt; Const (m String) StringRewriting
Lens' StringRewriting GeneratorsDescr
</span><a href="StringRewriting.html#generatorsDescr"><span class="hs-identifier hs-var">generatorsDescr</span></a></span><span class="annot"><span class="annottext">((GeneratorsDescr -&gt; Const (m String) GeneratorsDescr)
 -&gt; StringRewriting -&gt; Const (m String) StringRewriting)
-&gt; Generator -&gt; Getting (m String) StringRewriting (m String)
forall c k v (m :: * -&gt; *) x y.
(Indexable c k v, MonadFail m) =&gt;
Getting x y c -&gt; k -&gt; Getting x y (m v)
</span><a href="Containers.html#.%40"><span class="hs-operator hs-var">.@</span></a></span><span class="annot"><span class="annottext">Generator
</span><a href="#local-6989586621679332075"><span class="hs-identifier hs-var">gen</span></a></span><span>
</span><span id="line-20"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; m String
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; m String) -&gt; String -&gt; m String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
</span><span class="hs-identifier hs-var">unwords</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679332076"><span class="hs-identifier hs-var">strGens</span></a></span><span>
</span><span id="line-21"></span></pre></body></html>